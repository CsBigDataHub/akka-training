<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.2">
<meta name="author" content="Daniel Hinojosa">
<title>Akka</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f0f0f0; }
.listingblock .pygments .tok-c { color: #60a0b0; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #007020; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-ch { color: #60a0b0; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #007020 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #60a0b0; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #007020 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #902000 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #40a070 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #4070a0 } /* Literal.String */
.listingblock .pygments .tok-na { color: #4070a0 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #007020 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #60add5 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #555555; font-weight: bold } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #d55537; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #007020 } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #06287e } /* Name.Function */
.listingblock .pygments .tok-nl { color: #002070; font-weight: bold } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #062873; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #bb60d5 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #007020; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #40a070 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #40a070 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #40a070 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #40a070 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #40a070 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #4070a0 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #4070a0 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #4070a0 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #4070a0 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #4070a0 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #4070a0 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #c65d09 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #235388 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #4070a0 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #517918 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #007020 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #06287e } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #bb60d5 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #bb60d5 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #bb60d5 } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #bb60d5 } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article">
<div id="header">
<h1>Akka</h1>
<div class="details">
<span id="author" class="author">Daniel Hinojosa</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_conventions_in_the_slides">Conventions in the slides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following typographical conventions are used in this material:<br>
<br>
<em>Italic</em><br>
Indicates new terms, URLs, email addresses, filenames, and file extensions.<br>
<br>
<code>Constant width</code><br>
Used for program listings, as well as within paragraphs to refer to program elements such as variable or function names, databases, data types, environment variables, statements, and keywords.<br>
<br>
<code><strong>Constant width bold</strong></code>
Shows commands or other text that should be typed literally by the user.<br>
<br>
<code><em>Constant width italic</em></code><br>
Shows text that should be replaced with user-supplied values or by values determined by context.<br></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shell_conventions">Shell Conventions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All shells (bash, zsh, Windows Shell) are represented as <code>%</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% calendar</code></pre>
</div>
</div>
<div class="paragraph">
<p>All Scala shells are represented as <code>scala&gt;</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="spark"><span></span>scala&gt; 4 * 10</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_introduction_to_akka">Introduction to Akka</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_about_akka">About Akka</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Set of libraries used to create concurrent, fault-tolerant and scalable applications.</p>
</li>
<li>
<p>It contains many API packages:</p>
<div class="ulist">
<ul>
<li>
<p>Actors</p>
</li>
<li>
<p>Logging</p>
</li>
<li>
<p>Futures</p>
</li>
<li>
<p>Finite State Machines</p>
</li>
<li>
<p>Persistence</p>
</li>
<li>
<p>Clustering</p>
</li>
</ul>
</div>
</li>
<li>
<p>We are going to only focus on some of the core items.</p>
</li>
<li>
<p>Akka&#8217;s managing processes can run on</p>
<div class="ulist">
<ul>
<li>
<p>In the Same VM</p>
</li>
<li>
<p>In a Remote VM</p>
</li>
</ul>
</div>
</li>
<li>
<p>Akka&#8217;s Actor&#8217;s are a replacement Scala&#8217;s Actors that came in earlier versions</p>
</li>
<li>
<p>Most components are open source, with some proprietary components</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_history_of_actors">History of Actors</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Developed by Carl Hewitt, Peter Bishop, and Richard Steiger in 1973 paper:
<em>“Universal Modular Actor Formalism for Artificial Intelligence.”</em></p>
</li>
<li>
<p>Based on the Actor Model from Erlang.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_model_tenets">Actor Model Tenets</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Encapsulates State and Behavior</p>
</li>
<li>
<p>Internally we focus as if <strong><em>everything is single threaded</em></strong></p>
</li>
<li>
<p>Communication between other <code>Actor</code> is done with message passing</p>
</li>
<li>
<p>Is the center architecture of Akka and it&#8217;s libraries</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/innerstate.png" alt="innerstate">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_to_implement_the_actor_model">To implement the Actor Model</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>All computation is performed within an actor</p>
</li>
<li>
<p>Actors can communicate only through messages</p>
</li>
<li>
<p>In response to a message, an actor can:</p>
<div class="ulist">
<ul>
<li>
<p>Change its state or behavior</p>
</li>
<li>
<p>Send messages to other actors</p>
</li>
<li>
<p>Create a finite number of child actors</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_model_in_action">Actor Model in Action</h2>
<div class="sectionbody">
<div class="videoblock">
<div class="content">
<video src="./images/akka_basic_video.mp4" autoplay controls loop>
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actors_in_erlang">Actors in Erlang</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/erlang.png" alt="erlang" width="40%" height="40%">
</div>
</div>
<div class="paragraph">
<p><a href="https://www.youtube.com/watch?v=xrIjfIjssLE">Erlang the Movie</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actors_in_erlang_sending_messages">Actors in Erlang Sending Messages</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/erlang_term_2.png" alt="erlang term 2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actors_in_erlang_fault_tolerance">Actors in Erlang Fault Tolerance</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/erlang_term_4.png" alt="erlang term 4">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_strategies">Actor Strategies</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An Actor can then respond to the message by:</p>
<div class="ulist">
<ul>
<li>
<p>Processing the message</p>
</li>
<li>
<p>Passing it on</p>
</li>
<li>
<p>Act as a proxy before sending to another</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All these are transparent to the sender
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_difference_between_actors_and_other_messaging_queues">Difference between Actors and other Messaging Queues</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Transactional Persistent Queues may or may not be implemented in standard MQ*</p>
</li>
<li>
<p>If you going to code in JVM, Akka is a great choice</p>
</li>
<li>
<p>If you going to require polyglot integration than an MQ</p>
</li>
<li>
<p>Akka will scale better than an MQ, since MQ will require more fixed threads*</p>
</li>
<li>
<p>Message Queues have better guarantees</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is <strong><em>not</em></strong> a sales pitch, and it is tough to compare every MQ with Akka
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Many large companies use both MQ and Akka
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_vs_message_queues">Akka vs. Message Queues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is a table comparing the two different models.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Akka</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Generic MQ</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple Consumers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Polyglot Solutions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low Latency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Better Message Reliability (Higher latency)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic Concurrency Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some may offer different takes on architecture (Kafka)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Better Interop with AkkaHTTP and Play</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Better Integration with a particular framework</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_setup">Setup</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_typical_setup_instructions">Typical Setup Instructions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we begin it is assumed that all of you have the following tools installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 1.8 (latest java is 1.8.0_162)</p>
</li>
<li>
<p>Scala (latest scala is 2.12.6)</p>
</li>
<li>
<p>SBT (latest sbt is 1.1.6)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To verify that all your tools work as expected</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% javac -version
javac <span class="tok-m">1</span>.8.0_162

% scala -version
Scala code runner version <span class="tok-m">2</span>.12.6 -- Copyright <span class="tok-m">2002</span>-2018, LAMP/EPFL

% java -version
java version <span class="tok-s2">&quot;1.8.0_162&quot;</span>
Java<span class="tok-o">(</span>TM<span class="tok-o">)</span> SE Runtime Environment <span class="tok-o">(</span>build <span class="tok-m">1</span>.8.0_1.8.0_162-b17<span class="tok-o">)</span>
Java HotSpot<span class="tok-o">(</span>TM<span class="tok-o">)</span> <span class="tok-m">64</span>-Bit Server VM <span class="tok-o">(</span>build <span class="tok-m">25</span>.65-b01, mixed mode<span class="tok-o">)</span>

% sbt sbtVersion
<span class="tok-o">[</span>info<span class="tok-o">]</span> Set current project to scala <span class="tok-o">(</span>in build file:/&lt;folder_location&gt;<span class="tok-o">)</span>
<span class="tok-o">[</span>info<span class="tok-o">]</span> <span class="tok-m">1</span>.1.6</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_java_scala_sbt_on_a_mac_automatically_with_brew">Installing Java, Scala, SBT on a Mac Automatically with Brew</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/brew-website.png" alt="brew website" width="50%">
</div>
</div>
<div class="paragraph">
<p>If you have a mac and brew installed, you can run the following <strong><em>and be done!</em></strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% brew update
% brew cask install java
% brew install scala
% brew install sbt</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This will require an install of Homebrew. Visit <a href="https://brew.sh/" class="bare">https://brew.sh/</a> for details of installation if you want to use brew.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Depending on your company&#8217;s software and security constraints, you may not be able to use brew
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_if_you_don_t_have_java_8_installed">If you don&#8217;t have Java 8 installed</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Visit: <a href="http://www.oracle.com/technetwork/java/javase/downloads/index-jsp-138363.html" class="bare">http://www.oracle.com/technetwork/java/javase/downloads/index-jsp-138363.html</a></p>
</li>
<li>
<p>Select: <em>Accept License Agreement</em></p>
</li>
<li>
<p>Download the appropriate Java version based on your architecture.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_if_you_do_not_have_scala_installed">If you do not have Scala installed</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/scala-website.png" alt="scala website" width="50%">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Visit <a href="http://scala-lang.org" class="bare">http://scala-lang.org</a></p>
</li>
<li>
<p>Click the <em>Download</em> Button</p>
</li>
<li>
<p>Download the appropriate binary for your system:</p>
<div class="ulist">
<ul>
<li>
<p>Mac and Linux will load a <em>.tgz</em> file</p>
</li>
<li>
<p>Windows will download an <em>.msi</em> executable</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Mac and Linux you can expand with <code>tar -xvfz scala-2.12.6.tgz</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_if_you_do_not_have_sbt_installed">If you do not have SBT installed</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/sbt-website.png" alt="sbt website" width="50%">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Visit <a href="http://scala-sbt.org" class="bare">http://scala-sbt.org</a></p>
</li>
<li>
<p>Click the <em>Download</em> Button</p>
</li>
<li>
<p>Download the appropriate binary for your system:</p>
<div class="ulist">
<ul>
<li>
<p>Mac and Linux will load a <em>.tgz</em>, or a <em>.zip</em> file</p>
</li>
<li>
<p>Windows will download an <em>.msi</em> executable</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Mac and Linux you can expand with <code>tar -xvfz scala-2.12.6.tgz</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_setting_up_the_windows_environment_variables_for_java">Windows Users Only: Setting up the Windows Environment Variables for Java</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Go to your <em>Environment Variables</em>, typically done by typing the Windows key(<span class="image"><img src="./images/windows_key.png" alt="Windows Key" width="16" height="16"></span>) and type <code>env</code></p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center;float: left">
<div class="content">
<img src="./images/EnvironmentVariablesWindows.PNG" alt="EnvironmentVariablesWindows">
</div>
</div>
<div class="imageblock" style="text-align: center;float: right">
<div class="content">
<img src="./images/UserOrSystemEnvironmentVariables.PNG" alt="UserOrSystemEnvironmentVariables">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_setting_up_code_java_home_code">Windows Users Only: Setting up <code>JAVA_HOME</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Edit <code>JAVA_HOME</code> in the System Environment Variable window with the location of your JDK</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/JAVA_HOME.PNG" alt="JAVA HOME">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Using <code>jdk1.8.0_131</code> in the image. Your version may vary.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_optional_setting_up_code_scala_home_code">Windows Users Only (Optional): Setting up <code>SCALA_HOME</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This setting is not necessary with Scala on Windows since the .msi file installs everything required</p>
</li>
<li>
<p>If you do have problems where a tool is unable to locate Scala, set up an environment variable <code>SCALA_HOME</code></p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/SCALA_HOME.PNG" alt="SCALA HOME">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_setting_up_code_sbt_home_code">Windows Users Only: Setting up <code>SBT_HOME</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This setting is not necessary since SBT on Windows since the .msi file installs everything required</p>
</li>
<li>
<p>If you do have problems where a tool is unable to locate SBT, set up an environment variable <code>SBT_HOME</code></p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/SBT_HOME.PNG" alt="SBT HOME">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_setting_up_code_path_code">Windows Users Only: Setting up <code>PATH</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Once you establish <code>JAVA_HOME</code>, possibly <code>SCALA_HOME</code>, <strong><em>append</em></strong> to the <code>PATH</code> setting the following:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>;%JAVA_HOME%\bin;%SCALA_HOME%\bin</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_windows_users_only_restart_all_command_prompts_and_try_again">Windows Users Only: Restart All Command Prompts And Try Again</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="batch"><span></span>C<span class="tok-p">:</span><span class="tok-nl">\</span><span class="tok-c1">&gt; javac -version</span>
javac 1.8.0_162

C<span class="tok-p">:</span><span class="tok-nl">\</span><span class="tok-c1">&gt; scala -version</span>
Scala code runner version 2.12.6 -- Copyright 2002-2018, LAMP/EPFL

C<span class="tok-p">:</span><span class="tok-nl">\</span><span class="tok-c1">&gt; java -version</span>
java version <span class="tok-s2">&quot;1.8.0_162&quot;</span>
Java(TM) SE Runtime Environment (build 1.8.0_1.8.0_162-b17)
Java HotSpot(TM) 64-Bit Server VM (build 25.65-b01, mixed mode)

C<span class="tok-p">:</span><span class="tok-nl">\</span><span class="tok-c1">&gt; sbt sbtVersion</span>
[info] Set current project to scala (in build file:/<span class="tok-p">&lt;</span>folder_location<span class="tok-p">&gt;</span>)
[info] 1.1.6</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Changes won&#8217;t take effect until you open a new command prompt!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mac_users_only_editing_your_em_bash_profile_em_or_em_zshrc_em">Mac Users Only: Editing your <em>.bash_profile</em> or <em>.zshrc</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>If you are using the Bash shell, edit the your <em>.bash_profile</em> in your home directory using your favorite editor</p>
</li>
<li>
<p>If you are using the Zsh shell, edit the your <em>.zshrc</em> in your home directory using your favorite editor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if using <code>nano</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% nano ~/.bash_profile</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Replace <em>nano</em> with your favorite editor <em>vim</em>, <em>emacs</em>, <em>atom</em>, etc.<br>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure the following contents are in your <em>.bash_profile</em></p>
</li>
<li>
<p>If you already have a <code>PATH</code>, append the new values to the end.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-nb">export</span> <span class="tok-nv">SCALA_HOME</span><span class="tok-o">=</span> &lt;location_of_scala&gt;
<span class="tok-nb">export</span> <span class="tok-nv">SBT_HOME</span><span class="tok-o">=</span> &lt;location_of_sbt&gt;
<span class="tok-nb">export</span> <span class="tok-nv">JAVA_HOME</span><span class="tok-o">=</span><span class="tok-k">$(</span>/usr/libexec/java_home<span class="tok-k">)</span>
<span class="tok-nb">export</span> <span class="tok-nv">PATH</span><span class="tok-o">=</span><span class="tok-nv">$PATH</span>:<span class="tok-nv">$JAVA_HOME</span>/bin:<span class="tok-nv">$SCALA_HOME</span>/bin:<span class="tok-nv">$SBT_HOME</span>/bin</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you used <code>brew</code>, many of these application will not require their <code>PATH</code> setup.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can locate where <code>scala</code> is by either doing</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% which scala
% whereis scala</code></pre>
</div>
</div>
<div class="paragraph">
<p>When done open a new terminal or if already on an open terminal type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For bash: <code><strong>source .bash_profile</strong></code></p>
</li>
<li>
<p>For zsh:  <code><strong>source .zshrc</strong></code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_linux_users_only_editing_your_em_bash_profile_em_or_em_zshrc_em">Linux Users Only: Editing your <em>.bash_profile</em> or <em>.zshrc</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>If you are using the Bash shell, edit the your <em>.bash_profile</em> in your home directory using your favorite editor</p>
</li>
<li>
<p>If you are using the Zsh shell, edit the your <em>.zshrc</em> in your home directory using your favorite editor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if using <code>nano</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% nano ~/.bash_profile</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Replace <em>nano</em> with your favorite editor <em>vim</em>, <em>emacs</em>, <em>atom</em>, etc.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure the following contents are in your <em>.bash_profile</em></p>
</li>
<li>
<p>If you already have a <code>PATH</code>, append the new values to the end.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-nb">export</span> <span class="tok-nv">SCALA_HOME</span><span class="tok-o">=</span> &lt;location_of_scala&gt;
<span class="tok-nb">export</span> <span class="tok-nv">SBT_HOME</span><span class="tok-o">=</span> &lt;location_of_sbt&gt;
<span class="tok-nb">export</span> <span class="tok-nv">JAVA_HOME</span><span class="tok-o">=</span> &lt;location_of_jdk&gt;
<span class="tok-nb">export</span> <span class="tok-nv">PATH</span><span class="tok-o">=</span><span class="tok-nv">$PATH</span>:<span class="tok-nv">$JAVA_HOME</span>/bin:<span class="tok-nv">$SCALA_HOME</span>/bin:<span class="tok-nv">$SBT_HOME</span>/bin</code></pre>
</div>
</div>
<div class="paragraph">
<p>When done open a new terminal or if already on an open terminal type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For bash: <code><strong>source .bash_profile</strong></code></p>
</li>
<li>
<p>For zsh:  <code><strong>source .zshrc</strong></code></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_basic_api">Basic API</h2>
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_akka_messages">Akka Messages</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_akka_messages_2">Akka Messages</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Everything in an actor model is message based</p>
</li>
<li>
<p>Messages are sent asynchronously to other actors</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_message_rules">Akka Message Rules</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To maintain thread encapsulation, messages to and from actors <strong><em>cannot</em></strong> be:</p>
<div class="ulist">
<ul>
<li>
<p>Mutable</p>
</li>
<li>
<p>Closure</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_closure_in_java">What is a closure in Java?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">import</span> <span class="tok-nn">java.util.function.Function</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Closures</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-n">Integer</span> <span class="tok-nf">foo</span><span class="tok-o">(</span><span class="tok-n">Function</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">w</span><span class="tok-o">)</span> <span class="tok-o">{</span>
     <span class="tok-k">return</span> <span class="tok-n">w</span><span class="tok-o">.</span><span class="tok-na">apply</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">Integer</span> <span class="tok-n">x</span> <span class="tok-o">=</span> <span class="tok-mi">3</span><span class="tok-o">;</span>
      <span class="tok-n">Function</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">,</span> <span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Integer</span> <span class="tok-n">z</span><span class="tok-o">)</span> <span class="tok-o">-&gt;</span>  <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">z</span><span class="tok-o">;</span>
      <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-o">));</span> <span class="tok-c1">//8</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_closure_in_scala">What is a closure in Scala?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">var</span> <span class="tok-n">x</span> <span class="tok-k">=</span> <span class="tok-mi">3</span>
<span class="tok-k">val</span> <span class="tok-n">y</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">z</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">z</span>
<span class="tok-k">def</span> <span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-n">w</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">w</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">)</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-o">));</span> <span class="tok-c1">//8</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_immutability_in_java">What is a immutability in Java?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Person</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
    <span class="tok-kd">private</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
    <span class="tok-kd">public</span> <span class="tok-nf">Person</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">firstName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">lastName</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">firstName</span> <span class="tok-o">=</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">lastName</span> <span class="tok-o">=</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getFirstName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getLastName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">toString</span><span class="tok-o">()</span> <span class="tok-o">{...}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-kt">boolean</span> <span class="tok-nf">equals</span><span class="tok-o">(</span><span class="tok-n">Object</span> <span class="tok-n">o</span><span class="tok-o">)</span> <span class="tok-o">{...}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-kt">int</span> <span class="tok-nf">hashCode</span><span class="tok-o">()</span> <span class="tok-o">{...}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_immutability_in_scala">What is immutability in Scala?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">case</span> <span class="tok-k">class</span> <span class="tok-nc">Person</span><span class="tok-o">(</span><span class="tok-n">firstName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-n">lastName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">Person</span><span class="tok-o">(</span><span class="tok-k">val</span> <span class="tok-n">firstName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-k">val</span> <span class="tok-n">lastName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">toString</span><span class="tok-o">()</span> <span class="tok-k">=</span> <span class="tok-o">{...}</span>
   <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">equals</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">AnyRef</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Boolean</span> <span class="tok-o">=</span> <span class="tok-o">{...}</span>
   <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">hashCode</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-o">{...}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_mailbox">The Mailbox</h2>
<div class="sectionbody">
<div class="imageblock" style="float: left">
<div class="content">
<img src="./images/TYOtoys_USPS_mailbox.jpeg" alt="TYOtoys USPS mailbox">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Every actor contains a mailbox</p>
</li>
<li>
<p>The mailbox exists with the actor</p>
</li>
<li>
<p>Once in the mailbox it is outside the control of the sender</p>
</li>
<li>
<p>The Actor Model provides an <em>At Most Once Guarantee</em></p>
</li>
<li>
<p>There are other Akka tools that provide <em>At Least Once Delivery</em></p>
</li>
<li>
<p><strong>IMPORTANT</strong> No actor can receive more than one message at a time!</p>
</li>
<li>
<p>This is called the <em>single threaded illusion</em></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_code_actorsystem_code">The <code>ActorSystem</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An actor system is a hierarchical group of actors which share common configuration</p>
<div class="ulist">
<ul>
<li>
<p>Dispatchers</p>
</li>
<li>
<p>Deployments</p>
</li>
<li>
<p>Remote capabilities</p>
</li>
<li>
<p>Addresses.</p>
</li>
</ul>
</div>
</li>
<li>
<p>It is also the entry point for <strong><em>creating or looking up actors</em></strong></p>
</li>
<li>
<p>Analogous to a server</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_actorsystem_code_examples"><code>ActorSystem</code> examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">system</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;MySystem&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Java:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">ActorSystem</span> <span class="tok-n">system</span> <span class="tok-o">=</span> <span class="tok-n">ActorSystem</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-s">&quot;MySystem&quot;</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_code_prop_code">A <code>Prop</code></h2>
<div class="sectionbody">
<div class="imageblock" style="float: left">
<div class="content">
<img src="./images/recipebox.jpg" alt="recipebox" width="80%" height="80%">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration class to specify how to create recipe</p>
</li>
<li>
<p>Analogous to a recipe</p>
</li>
<li>
<p>Immutable class</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_actorof_code"><code>actorOf()</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Creates an actor onto a <code>ActorSystem</code></p>
</li>
<li>
<p>Creates an actor given the a set of properties to describe the Actor</p>
</li>
<li>
<p>Creates an Actor with an identifiable name, if provided</p>
</li>
<li>
<p>Returns an <code>ActorRef</code></p>
</li>
<li>
<p>If <code>actorOf</code> is called <em>inside</em> of another actor, that new actor becomes a child of that actor</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_actorselection_code"><code>actorSelection()</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Was <code>ActorFor</code>, <code>ActorFor</code> now deprecated</p>
</li>
<li>
<p>Actor references can be looked up using <code>actorSystem.actorSelection(&#8230;&#8203;)</code> method.</p>
</li>
<li>
<p><code>actorSystem.actorSelection</code> returns a <code>ActorSelection</code> object that abstracts over local or remote reference.</p>
</li>
<li>
<p><code>ActorSelection</code> can be used as long as the actor is alive.</p>
</li>
<li>
<p>Only ever looks up an existing actor, i.e. does not create one.</p>
</li>
<li>
<p>The actor must exist or you will receive an EmptyLocalActorRef</p>
</li>
<li>
<p>For Remote Actor References, a search by path on the remote system will occur.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_code_actorref_code">About <code>ActorRef</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Any subtype of <code>ActorRef</code></p>
</li>
<li>
<p><code>ActorRef</code> is the only way to interact with an Actor</p>
</li>
<li>
<p>Intent is to send messages to <code>Actor</code> that it represents, proxy.</p>
</li>
<li>
<p>Each actor has reference to <code>self()</code> refers to it&#8217;s own reference.</p>
</li>
<li>
<p>Each actor also has reference to the <code>sender()</code>, the actor that sent the message.</p>
</li>
<li>
<p>Any reference can be sent to another actor so that actor can send messages to it.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_types_of_references">Other Types of References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Depending how you configure Akka, you might have a different kind of <code>ActorRef</code> implementations</p>
<div class="ulist">
<ul>
<li>
<p>Pure Local Actor References</p>
</li>
<li>
<p>Local Actor References</p>
</li>
<li>
<p>Local Actor References with Routing</p>
</li>
<li>
<p>Remote Actor References</p>
</li>
<li>
<p>Promise Actor References</p>
</li>
<li>
<p>Dead Letter Actor References</p>
</li>
<li>
<p>Cluster Actor References</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_untyped_actors">Untyped Actors</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_setting_up_your_first_actor_in_java">Setting up your first actor in Java</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SimpleActorJava</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractActor</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-n">LoggingAdapter</span> <span class="tok-n">log</span> <span class="tok-o">=</span>
       <span class="tok-n">Logging</span><span class="tok-o">.</span><span class="tok-na">getLogger</span><span class="tok-o">(</span><span class="tok-n">getContext</span><span class="tok-o">().</span><span class="tok-na">system</span><span class="tok-o">(),</span> <span class="tok-k">this</span><span class="tok-o">);</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Receive</span> <span class="tok-nf">createReceive</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">receiveBuilder</span><span class="tok-o">().</span><span class="tok-na">match</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">,</span> <span class="tok-n">message</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
            <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Received String message in Simple Actor Java {}&quot;</span><span class="tok-o">,</span>
                    <span class="tok-n">message</span><span class="tok-o">);</span>
        <span class="tok-o">}).</span><span class="tok-na">build</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Untyped Actors in Java extend from <code>AbstractActor</code></p>
</li>
<li>
<p>Actors are infused now with Java 8 Lambdas</p>
</li>
<li>
<p>This is a newer API than from the past</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_your_first_actor_in_java_continued">Setting up your first actor in Java Continued</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SimpleActorJava</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractActor</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-n">LoggingAdapter</span> <span class="tok-n">log</span> <span class="tok-o">=</span>
            <span class="tok-n">Logging</span><span class="tok-o">.</span><span class="tok-na">getLogger</span><span class="tok-o">(</span><span class="tok-n">getContext</span><span class="tok-o">().</span><span class="tok-na">system</span><span class="tok-o">(),</span>
                    <span class="tok-k">this</span><span class="tok-o">);</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Receive</span> <span class="tok-nf">createReceive</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">receiveBuilder</span><span class="tok-o">().</span><span class="tok-na">match</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">,</span> <span class="tok-n">message</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
            <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Received String message in Simple Actor Java {}&quot;</span><span class="tok-o">,</span>
                    <span class="tok-n">message</span><span class="tok-o">);</span>
        <span class="tok-o">}).</span><span class="tok-na">build</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Logging is provided by <code>akka.event.LoggingAdapter</code></p>
</li>
<li>
<p>Pattern matching in Java is provided now by <code>receiveBuilder()</code></p>
</li>
<li>
<p>A <code>match</code> will offer many different variants</p>
</li>
<li>
<p><code>getContext</code> is a reference call to get the <code>ActorSystem</code> in which the actor is housed</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_code_actorsystem_code_with_an_code_actor_code">Creating an <code>ActorSystem</code> with an <code>Actor</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">ActorSystem</span> <span class="tok-n">actorSystem</span> <span class="tok-o">=</span> <span class="tok-n">ActorSystem</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-s">&quot;My-Actor-System&quot;</span><span class="tok-o">);</span>
<span class="tok-n">Props</span> <span class="tok-n">props</span> <span class="tok-o">=</span> <span class="tok-n">Props</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-n">SimpleActorJava</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>
<span class="tok-n">ActorRef</span> <span class="tok-n">actorRef</span> <span class="tok-o">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-na">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">);</span>
<span class="tok-n">actorRef</span><span class="tok-o">.</span><span class="tok-na">tell</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello&quot;</span><span class="tok-o">,</span> <span class="tok-n">ActorRef</span><span class="tok-o">.</span><span class="tok-na">noSender</span><span class="tok-o">());</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>ActorSystem</code> is a container for multiple <code>Actor</code></p>
</li>
<li>
<p>A <code>Props</code></p>
<div class="ulist">
<ul>
<li>
<p>A recipe as to how to create an <code>Actor</code></p>
</li>
<li>
<p>Is a message and can be used to send to other actors</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>actorSystem.actorOf</code> creates the actor</p>
</li>
<li>
<p><code>actorRef.tell</code> sends the message to an actor in a fire and forget fashion</p>
</li>
<li>
<p>This will run locally on a single JVM</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_setting_up_a_project">Lab: Setting up a project</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Ensure that Java, Scala, and SBT is installed</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Clone akka-training, from the github repository: <a href="https://github.com/dhinojosa/akka-training" class="bare">https://github.com/dhinojosa/akka-training</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the "Clone or Download" Button</p>
</li>
<li>
<p>Select SSH or HTTPS</p>
</li>
<li>
<p>run <code>git clone &lt;url&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Download the project from the github repository: <a href="https://github.com/dhinojosa/akka-training" class="bare">https://github.com/dhinojosa/akka-training</a> by clicking on the "Clone or Download" button</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the "Clone or Download" Button</p>
</li>
<li>
<p>Click Download</p>
</li>
<li>
<p>Unzip the project</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/clonedownload.png" alt="clonedownload">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The pdf, and zip of the slides for this course are also available in the repo.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_setting_up_a_project_continued">Lab: Setting up a project continued</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 3:</strong> In the akka-training folder, run the following command to download dependencies</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>akka-training % sbt reload update</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This will take a while, and you can ignore initial warnings, particularly if running Java 9 or higher
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bringing_your_project_into_your_ide">Bringing your project into your IDE</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>IMPORTANT Be sure to download and configure the latest version of your IDE!</strong></p>
</li>
<li>
<p>Eclipse - Be sure to have Neon or Oxygen (Oxygen 3 Preferred)</p>
</li>
<li>
<p>IntelliJ IDEA (Professional or Community): 2018-1</p>
</li>
<li>
<p><strong>IMPORTANT Be sure to backup any IDE settings that you believe are critical</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_for_intellij_users_install_the_intellij_scala_plugin">Lab (For IntelliJ Users): Install the IntelliJ Scala Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IntelliJ from JetBrains offers support for Scala through one of its plugins</p>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong>  Go to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Windows and Linux: File | Settings | Plugins</p>
</li>
<li>
<p>For MacOSX: IntelliJ IDEA | Preferences | Plugins</p>
</li>
<li>
<p>Click on Browse Repositories</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/browse_repositories.png" alt="browse repositories">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_for_intellij_users_install_the_intellij_scala_plugin_continued">Lab (For IntelliJ Users): Install the IntelliJ Scala Plugin Continued</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 2:</strong> Search for Scala in the filter on the upper-left hand corner</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/intellij_plugin.png" alt="intellij plugin">
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Click <em>Install</em> on the right pane window</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Restart is necessary</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not install the SBT plugin, the IntelliJ Plugin already has SBT support
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_for_intellij_users_open_your_project_in_intellij_continued">Lab (For IntelliJ Users): Open your project in IntelliJ Continued</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Go to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File | Open</p>
</li>
<li>
<p>Locate your project, akka-training</p>
</li>
<li>
<p>Click the Open button</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_eclipse">Eclipse</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Be sure to have one of the latest Eclipse installation as plugins tend to not work with older plugins</p>
</li>
<li>
<p>If you do not have any Eclipse you can just go straight to <a href="http://scala-ide.org" class="bare">http://scala-ide.org</a> and download a complete bundle and skip the Eclipse setup and jump to <strong><em>Installing the SBT Eclipse Plugin</em></strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optional_lab_eclipse_users_only_installing_the_scala_ide_plugin">Optional Lab (Eclipse Users Only): Installing the Scala-IDE Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you wish to install the Scala-IDE plugin manually instead of downloading the complete Scala-IDE package&#8230;&#8203;</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_installnewsoftware.png" alt="eclipse installnewsoftware">
</div>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> Go to Help | Install New Software</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In the <em>Work With:</em> field enter the URL of the Scala IDE Plugin found in <a href="http://scala-ide.org/download/current.html" class="bare">http://scala-ide.org/download/current.html</a></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Hit Enter, and select all the Scala modules that appear</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Hit Next</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optional_lab_eclipse_users_only_install_details">Optional Lab (Eclipse Users Only): Install Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you wish to install the Scala-IDE plugin manually instead of downloading the complete Scala-IDE package&#8230;&#8203;</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_installdetails.png" alt="eclipse installdetails">
</div>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> Ensure the details for the plugin and hit <em>Next</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optional_lab_eclipse_users_only_license_details">Optional Lab (Eclipse Users Only): License Details</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_licensedetails.png" alt="eclipse licensedetails">
</div>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> Ensure the details for the licenses used and hit <em>Next</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optional_lab_eclipse_users_only_unsigned_content">Optional Lab (Eclipse Users Only): Unsigned Content</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_licensedetails.png" alt="eclipse licensedetails">
</div>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> Ensure the details for the licenses used and hit <em>Next</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_optional_lab_eclipse_users_only_last_details">Optional Lab (Eclipse Users Only): Last Details</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> An image may appear warning about unsigned content, choose <em>Install Anyway</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_unsignedcontent.png" alt="eclipse unsignedcontent">
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> When prompted to Restart Machine, select <em>Restart Now</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/eclipse_restart.png" alt="eclipse restart">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_eclipse_users_only_generating_eclipse_files">Lab (Eclipse Users Only): Generating Eclipse Files</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Enter the <code>sbt</code> shell and enter Eclipse.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; eclipse</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you invoke this command in SBT, this will create all the eclipse files needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_eclipse_users_only_importing_into_eclipse">Lab (Eclipse Users Only): Importing into Eclipse</h2>
<div class="sectionbody">
<div class="imageblock" style="float: right">
<div class="content">
<img src="./images/eclipse_import_existing_proj.png" alt="eclipse import existing proj">
</div>
</div>
<div class="paragraph">
<p>In Eclipse, in the menus, go to:</p>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> File | Import</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Select: General | Existing Project in Workspace</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Click Next</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_eclipse_users_only_selecting_the_project">Lab (Eclipse Users Only): Selecting the Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>Select Root Directory</em> locate your project</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Select <em>Finish</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_an_actor_in_java">Lab: Creating an Actor in Java</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1</strong>: In <em>src/main/java</em>, create a package called <code>com.akkatraining.java</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2</strong>: Create <code>SimpleActorJava</code> in <code>com.akkatraining.java</code> with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.akkatraining.java</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SimpleActorJava</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractActor</span> <span class="tok-o">{</span>
    <span class="tok-kd">private</span> <span class="tok-n">LoggingAdapter</span> <span class="tok-n">log</span> <span class="tok-o">=</span>
            <span class="tok-n">Logging</span><span class="tok-o">.</span><span class="tok-na">getLogger</span><span class="tok-o">(</span><span class="tok-n">getContext</span><span class="tok-o">().</span><span class="tok-na">system</span><span class="tok-o">(),</span>
                    <span class="tok-k">this</span><span class="tok-o">);</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Receive</span> <span class="tok-nf">createReceive</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">receiveBuilder</span><span class="tok-o">().</span><span class="tok-na">match</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">,</span> <span class="tok-n">message</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
            <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Received String message in Simple Actor Java {}&quot;</span><span class="tok-o">,</span>
                    <span class="tok-n">message</span><span class="tok-o">);</span>
        <span class="tok-o">}).</span><span class="tok-na">build</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_an_code_actorsystem_code_in_a_main_method">Lab: Creating an <code>ActorSystem</code> in a main method:</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <code>SimpleActorJava</code> that has just been created, create a <code>public static void main</code> method to create an <code>ActorSystem</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.akkatraining.java</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SimpleActorJava</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractActor</span> <span class="tok-o">{</span>

    <span class="tok-c1">//...Previous Content Elided</span>

    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-kd">extends</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
        <span class="tok-n">ActorSystem</span> <span class="tok-n">actorSystem</span> <span class="tok-o">=</span>
           <span class="tok-n">ActorSystem</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-s">&quot;My-Actor-System&quot;</span><span class="tok-o">);</span>
        <span class="tok-n">Props</span> <span class="tok-n">props</span> <span class="tok-o">=</span> <span class="tok-n">Props</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">(</span><span class="tok-n">SimpleActorJava</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>
        <span class="tok-n">ActorRef</span> <span class="tok-n">actorRef</span> <span class="tok-o">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-na">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">);</span>
        <span class="tok-n">actorRef</span><span class="tok-o">.</span><span class="tok-na">tell</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello&quot;</span><span class="tok-o">,</span> <span class="tok-n">ActorRef</span><span class="tok-o">.</span><span class="tok-na">noSender</span><span class="tok-o">());</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_running_through_sbt">Lab: Running through SBT</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Run the main method either in your IDE or in
SBT by running <code>run</code> in SBT, or in the command line,
and selecting the class that you want to run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt run</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt
&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Manually stop the server by stopping the VM in your IDE
, is you used your IDE, or Control+D in SBT</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Discuss the results</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> <code>actorOf</code> also takes a name as a parameter, add one, discuss the results</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shutting_down_gracefully">Shutting down gracefully</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Last lab we shut down harshly</p>
</li>
<li>
<p>We can programatically shut down gracefully if we call <code>terminate</code></p>
</li>
<li>
<p>Remember any non-daemonic thread in the JVM will prevent the JVM from shutting down</p>
</li>
<li>
<p>Typically since this is usually when an application is terminating as will we will block and wait for the termination to end</p>
</li>
<li>
<p><strong>IMPORTANT</strong> Blocking is frowned upon in the reactive architectures except in rare cases like this, shutting down</p>
</li>
<li>
<p><code>actorSystem.terminate</code> returns a <code>Future</code> that can be used to determine when shutting down.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">result</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">terminate</span><span class="tok-o">(),</span>
   <span class="tok-nc">Duration</span><span class="tok-o">.</span><span class="tok-n">create</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-nc">TimeUnit</span> <span class="tok-o">.</span><span class="tok-nc">SECONDS</span><span class="tok-o">));</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_terminate_an_code_actorsystem_code">Lab: Terminate an <code>ActorSystem</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <code>SimpleActorJava</code>, create a terminate the <code>ActorSystem</code> and await the shutdown</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Handle any <code>Exception</code> that might be thrown</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Verify by running the example in either your IDE or in the command line</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_java_futures">Java Futures</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_code_future_code_defined"><code>Future</code> Defined</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Future definition - <code>Future</code> represents the lifecycle of a task and provides methods to test whether the task has completed or has been canceled. <code>Future</code> can only move forwards and once complete it stays in that state forever.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Java Concurrency in Practice<br>
<cite>Brian Goetz</cite>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thread_pools">Thread Pools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before setting up a future, a thread pool is required to perform an asynchronous computation.
Each pool with return an <code>ExecutorService</code>.</p>
</div>
<div class="paragraph">
<p>There are a few thread pools to choose from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FixedThreadPool</code></p>
</li>
<li>
<p><code>CachedThreadPool</code></p>
</li>
<li>
<p><code>SingleThreadExecutor</code></p>
</li>
<li>
<p><code>ScheduledThreadPool</code></p>
</li>
<li>
<p><code>ForkJoinThreadPool</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fixed_thread_pool">Fixed Thread Pool</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>"Creates a thread pool that reuses a fixed number of threads operating off a shared unbounded queue."</p>
</li>
<li>
<p>Keeps threads constant and uses the queue to manage tasks waiting to be run</p>
</li>
<li>
<p>If a thread fails, a new one is created in its stead</p>
</li>
<li>
<p>If all threads are taken up, it will wait on an unbounded queue for the next available thread</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cached_thread_pool">Cached Thread Pool</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Flexible thread pool implementation that will reuse previously constructed threads if they are available</p>
</li>
<li>
<p>If no existing thread is available, a new thread is created and added to the pool</p>
</li>
<li>
<p>Threads that have not been used for sixty seconds are terminated and removed from the cache</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_single_thread_executor">Single Thread Executor</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Creates an Executor that uses a single worker thread operating off an unbounded queue</p>
</li>
<li>
<p>If a thread terminates due to a failure during execution prior to shutdown, a new one will take its place if needed to execute subsequent tasks.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scheduled_thread_pool">Scheduled Thread Pool</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Can run your tasks after a delay or periodically</p>
</li>
<li>
<p>This method does not return an <code>ExecutorService</code>, but a <code>ScheduledExecutorService</code></p>
</li>
<li>
<p>Runs periodically until <code>canceled()</code> is called.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fork_join_thread_pool">Fork Join Thread Pool</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An <code>ExecutorService</code>, that participates in <em>work-stealing</em></p>
</li>
<li>
<p>By default when a task creates other tasks (<code>ForkJoinTasks</code>) they are placed on the same on queue as the main task.</p>
</li>
<li>
<p><em>Work-stealing</em> is when a processor runs out of work, it looks at the queues of other processors and "steals" their work items.</p>
</li>
<li>
<p>Not a member of Executors. Created by instantiation</p>
</li>
<li>
<p>Brought up since this will be in many cases the "default" thread pool on the JVM</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_future_blocking_jdk_5">Basic Future Blocking (JDK 5)</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="groovy"><span></span><span class="tok-n">ExecutorService</span> <span class="tok-n">fixedThreadPool</span> <span class="tok-o">=</span>
   <span class="tok-n">Executors</span><span class="tok-o">.</span><span class="tok-na">newFixedThreadPool</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">);</span>

<span class="tok-n">Callable</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">callable</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Callable</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;()</span> <span class="tok-o">{</span>
    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Integer</span> <span class="tok-nf">call</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s2">&quot;Inside the future: &quot;</span> <span class="tok-o">+</span>
                <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
        <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">sleep</span><span class="tok-o">(</span><span class="tok-mi">5000</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-mi">5</span> <span class="tok-o">+</span> <span class="tok-mi">3</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
<span class="tok-o">};</span>

<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s2">&quot;In test:&quot;</span> <span class="tok-o">+</span> <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-n">Future</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">future</span> <span class="tok-o">=</span> <span class="tok-n">fixedThreadPool</span><span class="tok-o">.</span><span class="tok-na">submit</span><span class="tok-o">(</span><span class="tok-n">callable</span><span class="tok-o">);</span>

<span class="tok-c1">//This will block</span>
<span class="tok-n">Integer</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">();</span> <span class="tok-c1">//block</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s2">&quot;result = &quot;</span> <span class="tok-o">+</span> <span class="tok-n">result</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_future_asynchronous_jdk_5">Basic Future Asynchronous (JDK 5)</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">ExecutorService</span> <span class="tok-n">cachedThreadPool</span> <span class="tok-o">=</span> <span class="tok-n">Executors</span><span class="tok-o">.</span><span class="tok-na">newCachedThreadPool</span><span class="tok-o">();</span>

<span class="tok-n">Callable</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">callable</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Callable</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;()</span> <span class="tok-o">{</span>
    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Integer</span> <span class="tok-nf">call</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
        <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">sleep</span><span class="tok-o">(</span><span class="tok-mi">3000</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-mi">5</span> <span class="tok-o">+</span> <span class="tok-mi">3</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
<span class="tok-o">};</span>

<span class="tok-n">Future</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-n">future</span> <span class="tok-o">=</span> <span class="tok-n">cachedThreadPool</span><span class="tok-o">.</span><span class="tok-na">submit</span><span class="tok-o">(</span><span class="tok-n">callable</span><span class="tok-o">);</span>

<span class="tok-c1">//This is proper asynchrony, but rather ugly</span>
<span class="tok-k">while</span> <span class="tok-o">(!</span><span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-na">isDone</span><span class="tok-o">())</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span>
       <span class="tok-s">&quot;I am doing something else on thread: &quot;</span> <span class="tok-o">+</span>
       <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-o">}</span>

<span class="tok-n">Integer</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">();</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Applicable to Java 8
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_review_how_a_code_future_code_behaves">Lab: Review how a <code>Future</code> behaves</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In your favorite IDE, and in the <em>src/main/java</em> directory and
 in the <code>com.akkatraining.java.future</code> package review <code>BasicFuturesTest</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Now, review <code>AsychronousFuturesTest</code>, and note
  the difference with <code>BasicFuturesTest</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run both in SBT (or your IDE).  As a review, run either:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt run</code></pre>
</div>
</div>
<div class="paragraph">
<p>or enter the <code>sbt</code> shell and run from there:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt
&gt; run</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_java_s_code_completionstage_code">Java&#8217;s <code>CompletionStage</code></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_code_completionstage_code"><code>CompletionStage</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A stage of asynchronous computation</p>
</li>
<li>
<p>Performs an action or computes a value when the previous stage completes</p>
</li>
<li>
<p>An API that cleanly handles asynchronous processing of chained <code>Future</code></p>
</li>
<li>
<p>Every stage can be performed as a:</p>
<div class="ulist">
<ul>
<li>
<p><code>Function</code></p>
</li>
<li>
<p><code>Consumer</code></p>
</li>
<li>
<p><code>Runnable</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Uses an <code>ExecutorService</code> to drive each stage</p>
</li>
<li>
<p>Is also a basic component of Akka and Akka Streams API</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_completablestage_code_initialization_with_code_supplyasync_code"><code>CompletableStage</code> initialization with <code>supplyAsync</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>supplyAsync</code> provides the data contained in the <code>Supplier</code></p>
</li>
<li>
<p>Processing takes place on a different <code>Thread</code></p>
</li>
<li>
<p>Requires an <code>ExecutorService</code> for thread pools</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">ExecutorService</span> <span class="tok-n">executorService</span> <span class="tok-o">=</span> <span class="tok-n">Executors</span><span class="tok-o">.</span><span class="tok-na">newCachedThreadPool</span><span class="tok-o">();</span>

<span class="tok-n">integerFuture1</span> <span class="tok-o">=</span> <span class="tok-n">CompletableFuture</span>
  <span class="tok-o">.</span><span class="tok-na">supplyAsync</span><span class="tok-o">(()</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
      <span class="tok-k">try</span> <span class="tok-o">{</span>
          <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span>
              <span class="tok-s">&quot;intFuture1 is Sleeping in thread: &quot;</span>
              <span class="tok-o">+</span> <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
          <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">sleep</span><span class="tok-o">(</span><span class="tok-mi">3000</span><span class="tok-o">);</span>
      <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">InterruptedException</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
          <span class="tok-n">e</span><span class="tok-o">.</span><span class="tok-na">printStackTrace</span><span class="tok-o">();</span>
      <span class="tok-o">}</span>
      <span class="tok-k">return</span> <span class="tok-mi">5</span><span class="tok-o">;</span>
  <span class="tok-o">},</span> <span class="tok-n">executorService</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_simple_chain_using_code_completablestage_code">Simple Chain using <code>CompletableStage</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Each <code>CompletableStage</code> can be interlinked</p>
</li>
<li>
<p>This is the simplest flow of data, from source to sink</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-n">thenAccept</span><span class="tok-o">(</span><span class="tok-nc">System</span><span class="tok-o">.</span><span class="tok-n">out</span><span class="tok-o">::</span><span class="tok-n">println</span><span class="tok-o">);</span> <span class="tok-c1">//5</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functional_map_analogy_with_code_thenapply_code">Functional Map analogy with <code>thenApply</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>thenApply</code> is analogous to a functional <code>map</code></p>
</li>
<li>
<p><code>map</code> applies a function to every container providing a copy of the container with the modified contents</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">future</span> <span class="tok-o">=</span>
   <span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-na">thenApply</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
       <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;In Block:&quot;</span> <span class="tok-o">+</span>
               <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
       <span class="tok-k">return</span> <span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">19</span><span class="tok-o">);</span>
   <span class="tok-o">});</span>
<span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-na">thenAccept</span><span class="tok-o">(</span><span class="tok-n">s</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span>
       <span class="tok-s">&quot;In the accept: &quot;</span> <span class="tok-o">+</span>
       <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-o">);</span>
<span class="tok-o">});</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inlining_code_thenapply_code">Inlining <code>thenApply</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In the previous example, processing was done separate</p>
</li>
<li>
<p>All functions can be inlined to express a chain of processing</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">integerFuture1</span>
   <span class="tok-o">.</span><span class="tok-na">thenApply</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">-&gt;</span> <span class="tok-n">String</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">19</span><span class="tok-o">))</span>
   <span class="tok-o">.</span><span class="tok-na">thenAccept</span><span class="tok-o">(</span><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">::</span><span class="tok-n">println</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_thenapplyasync_code"><code>thenApplyAsync</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>thenApplyAsync</code> will run the next stage of the future onto another thread given an <code>Executor</code></p>
</li>
<li>
<p>This provides asynchronous boundaries to process information</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">thenApplyAsync</span> <span class="tok-o">=</span>
        <span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-na">thenApplyAsync</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
            <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;In Block:&quot;</span> <span class="tok-o">+</span>
                    <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
            <span class="tok-k">return</span> <span class="tok-s">&quot;&quot;</span> <span class="tok-o">+</span> <span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">19</span><span class="tok-o">);</span>
        <span class="tok-o">});</span>

<span class="tok-n">thenApplyAsync</span><span class="tok-o">.</span><span class="tok-na">thenAcceptAsync</span><span class="tok-o">((</span><span class="tok-n">x</span><span class="tok-o">)</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Accepting in:&quot;</span> <span class="tok-o">+</span> <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;x = &quot;</span> <span class="tok-o">+</span> <span class="tok-n">x</span><span class="tok-o">);</span>
<span class="tok-o">},</span> <span class="tok-n">executorService</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inlining_code_thenapplyasync_code">Inlining <code>thenApplyAsync</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-na">thenApplyAsync</span><span class="tok-o">(</span><span class="tok-n">x1</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;In Block:&quot;</span> <span class="tok-o">+</span>
            <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
    <span class="tok-k">return</span> <span class="tok-s">&quot;&quot;</span> <span class="tok-o">+</span> <span class="tok-o">(</span><span class="tok-n">x1</span> <span class="tok-o">+</span> <span class="tok-mi">19</span><span class="tok-o">);</span>
<span class="tok-o">}).</span><span class="tok-na">thenAcceptAsync</span><span class="tok-o">((</span><span class="tok-n">x</span><span class="tok-o">)</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Accepting in:&quot;</span> <span class="tok-o">+</span> <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;x = &quot;</span> <span class="tok-o">+</span> <span class="tok-n">x</span><span class="tok-o">);</span>
<span class="tok-o">},</span> <span class="tok-n">executorService</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_a_process_after_the_future_completion">Running a process after the Future Completion</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>thenRun</code></p>
<div class="ulist">
<ul>
<li>
<p>Will ignore the value of the <code>CompletableFuture</code></p>
</li>
<li>
<p>Proceed with a <code>Runnable</code> to finalize any processes</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-na">thenRun</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Runnable</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">run</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-n">String</span> <span class="tok-n">successMessage</span> <span class="tok-o">=</span>
                <span class="tok-s">&quot;I am doing something else once&quot;</span> <span class="tok-o">+</span>
                        <span class="tok-s">&quot; that future has been triggered!&quot;</span><span class="tok-o">;</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span>
                <span class="tok-o">(</span><span class="tok-n">successMessage</span><span class="tok-o">);</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Run inside of &quot;</span> <span class="tok-o">+</span>
                <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
    <span class="tok-o">}</span>
<span class="tok-o">});</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Inlining the above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">integerFuture1</span><span class="tok-o">.</span><span class="tok-na">thenRun</span><span class="tok-o">(()</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">successMessage</span> <span class="tok-o">=</span>
            <span class="tok-s">&quot;I am doing something else once&quot;</span> <span class="tok-o">+</span>
                    <span class="tok-s">&quot; that future has been triggered!&quot;</span><span class="tok-o">;</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span>
            <span class="tok-o">(</span><span class="tok-n">successMessage</span><span class="tok-o">);</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Run inside of &quot;</span> <span class="tok-o">+</span>
            <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">currentThread</span><span class="tok-o">().</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-o">});</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_exceptions_in_code_completablefuture_code">Handling Exceptions in <code>CompletableFuture</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There are two methods that can be used with a <code>CompletableFuture</code> to handle exceptions</p>
<div class="ulist">
<ul>
<li>
<p><code>exceptionally</code></p>
</li>
<li>
<p><code>handle</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_exceptionally_code"><code>exceptionally</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In the example below assume that <code>stringFuture</code> will return a <code>String</code></p>
</li>
<li>
<p><code>exceptionally</code> will trap any exception and proceed down the process</p>
</li>
<li>
<p>This will not interrupt the process and provide an alternative</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">stringFuture1</span>
   <span class="tok-o">.</span><span class="tok-na">thenApply</span><span class="tok-o">(</span><span class="tok-n">Integer</span><span class="tok-o">::</span><span class="tok-n">parseInt</span><span class="tok-o">)</span>
   <span class="tok-o">.</span><span class="tok-na">exceptionally</span><span class="tok-o">(</span><span class="tok-n">t</span> <span class="tok-o">-&gt;</span> <span class="tok-k">return</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">})</span>
   <span class="tok-o">.</span><span class="tok-na">thenAccept</span><span class="tok-o">(</span><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">::</span><span class="tok-n">println</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_handle_code"><code>handle</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In the example below assume that <code>stringFuture</code> will return a <code>String</code></p>
</li>
<li>
<p><code>handle</code> will trap any and any exception and proceed down the process</p>
</li>
<li>
<p>This will not interrupt the process and provide an alternative in case of <code>Exception</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-n">stringFuture1</span>
   <span class="tok-o">.</span><span class="tok-na">thenApply</span><span class="tok-o">(</span><span class="tok-n">Integer</span><span class="tok-o">::</span><span class="tok-n">parseInt</span><span class="tok-o">)</span>
   <span class="tok-o">.</span><span class="tok-na">exceptionally</span><span class="tok-o">(</span><span class="tok-n">t</span> <span class="tok-o">-&gt;</span> <span class="tok-k">return</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">})</span>
   <span class="tok-o">.</span><span class="tok-na">thenAccept</span><span class="tok-o">(</span><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">::</span><span class="tok-n">println</span><span class="tok-o">);</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_compose_code"><code>compose</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>compose</code> is analogous to <code>flatMap</code> with <code>CompletableFuture</code></p>
</li>
<li>
<p><code>flatMap</code></p>
<div class="ulist">
<ul>
<li>
<p><code>map</code> has the signature <code>coll.map(x &#8594; y)</code></p>
</li>
<li>
<p><code>flatMap</code> has the signature <code>coll.map(x &#8594; coll(y))</code></p>
</li>
<li>
<p>Where, <code>coll</code> is any collection or container like <code>CompletableFuture</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-n">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-n">Integer</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTemperatureInFahrenheit</span><span class="tok-o">(</span><span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">cityState</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">CompletableFuture</span><span class="tok-o">.</span><span class="tok-na">supplyAsync</span><span class="tok-o">(()</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
        <span class="tok-c1">//Contact Web Service and parse for temperature</span>
    <span class="tok-o">});</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">stringFuture1</span><span class="tok-o">.</span><span class="tok-n">thenCompose</span><span class="tok-o">(</span>
    <span class="tok-n">cityState</span> <span class="tok-o">-&gt;</span> <span class="tok-n">getTemperatureInFahrenheit</span><span class="tok-o">(</span><span class="tok-n">cityState</span><span class="tok-o">));</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_running_code_completablefuture_code_example">Lab: Running <code>CompletableFuture</code> example</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1</strong>: In the akka-training project, and in the <em>src/main/java</em>
and in the <code>com.akkatraining.java.futures</code> package create a class called <code>CompletableFutureJava</code>
with the following content in the class declaration</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.akkatraining.java</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CompletableFutureJava</span> <span class="tok-o">{</span>
  <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">sleepFor</span><span class="tok-o">(</span><span class="tok-kt">long</span> <span class="tok-n">millis</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">try</span> <span class="tok-o">{</span>
          <span class="tok-n">Thread</span><span class="tok-o">.</span><span class="tok-na">sleep</span><span class="tok-o">(</span><span class="tok-n">millis</span><span class="tok-o">);</span>
      <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">InterruptedException</span> <span class="tok-n">ignored</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-o">}</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-kd">class</span> <span class="tok-nc">WebService</span> <span class="tok-o">{</span>
      <span class="tok-n">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">getHighestRankedStock</span>
          <span class="tok-o">(</span><span class="tok-n">LocalDate</span> <span class="tok-n">localDate</span><span class="tok-o">)</span> <span class="tok-o">{</span>
          <span class="tok-n">sleepFor</span><span class="tok-o">(</span><span class="tok-mi">1000</span><span class="tok-o">);</span>
          <span class="tok-k">return</span> <span class="tok-n">CompletableFuture</span><span class="tok-o">.</span><span class="tok-na">supplyAsync</span><span class="tok-o">(()</span> <span class="tok-o">-&gt;</span> <span class="tok-s">&quot;MSFT&quot;</span><span class="tok-o">);</span>
      <span class="tok-o">}</span>

      <span class="tok-n">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-n">Float</span><span class="tok-o">&gt;</span> <span class="tok-nf">getStockPrice</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">symbol</span><span class="tok-o">)</span> <span class="tok-o">{</span>
          <span class="tok-n">sleepFor</span><span class="tok-o">(</span><span class="tok-mi">2000</span><span class="tok-o">);</span>
          <span class="tok-n">Random</span> <span class="tok-n">random</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Random</span><span class="tok-o">();</span>
          <span class="tok-c1">//Mimicking going to a webservice</span>
          <span class="tok-k">return</span> <span class="tok-n">CompletableFuture</span><span class="tok-o">.</span><span class="tok-na">supplyAsync</span><span class="tok-o">(</span><span class="tok-n">random</span><span class="tok-o">::</span><span class="tok-n">nextFloat</span><span class="tok-o">);</span>
      <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Create a <code>main</code> method in <code>CompletableFutureJava</code> that will do the following</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Instantiate <code>WebService</code></p>
</li>
<li>
<p>Call the webService <code>getHighestRankedStock</code> and given the stock, use <code>CompletableFuture</code> to process the price</p>
</li>
<li>
<p>Make all necessary imports</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the example, discuss other options</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_reintroduction_to_scala">Reintroduction to Scala</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_code_val_code"><code>val</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>val</code> is called a <em>value</em></p>
</li>
<li>
<p>It is immutable, therefore unchangeable</p>
</li>
<li>
<p>No reassignment</p>
</li>
<li>
<p>Since Scala is functional, it is <em>preferred</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">10</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reassignment_of_code_val_code">Reassignment of <code>val</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A reassignment is out of the question with a <code>val</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">10</span>
<span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">19</span> <span class="tok-c1">//error: reassignment to val</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_var_code"><code>var</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Called a <em>variable</em></p>
</li>
<li>
<p>It is mutable, therefore changeable</p>
</li>
<li>
<p>Reassignable</p>
</li>
<li>
<p>Used sparingly</p>
</li>
<li>
<p>Usually kept from being changed from the outside</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">var</span> <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">10</span>
<span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">19</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-mi">19</span><span class="tok-o">)</span> <span class="tok-c1">//That&#39;s how you println</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_code_class_code">Scala <code>class</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Classes are the templates or blueprints of a construct that encapsulates state and manages behavior.</p>
</li>
<li>
<p>Classes have been around for a long time and in every object oriented language.</p>
</li>
<li>
<p>Since Scala is a half object oriented language, half functional language, there are naturally classes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_scala_code_class_code">A Scala <code>class</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-n">firstName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-n">lastName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>class</code> is public by default, so no need for a <code>public</code> modifier</p>
</li>
<li>
<p>The <code>(firstName:String, lastName:String)</code> is the primary constructor!</p>
</li>
<li>
<p>In Scala the primary constructor is "top-heavy" with a constructor that contains all the information</p>
</li>
<li>
<p>Other constructors are smaller constructors that feed the top constructor</p>
</li>
<li>
<p>The reason for the top heavy constructor is immutability</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_can_t_access_or_modify_class">Can&#8217;t access or modify class?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>As it stands in our <code>class</code>, we can neither access or modify our <code>class</code></p>
</li>
<li>
<p>Most of the time we don&#8217;t want to modify our <code>class</code> for immutability purposes</p>
</li>
<li>
<p>To be able to access the members, we will predicate each of the values with <code>val</code></p>
</li>
<li>
<p>To be able to mutate the member variables, we predicate each of the values with <code>var</code> (Not recommended)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">package</span> <span class="tok-nn">com.xyzcorp</span>

<span class="tok-k">class</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-k">val</span> <span class="tok-n">firstName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-k">var</span> <span class="tok-n">lastName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">emp</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Dennis&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Ritchie&quot;</span><span class="tok-o">)</span>
<span class="tok-n">emp</span><span class="tok-o">.</span><span class="tok-n">firstName</span> <span class="tok-n">should</span> <span class="tok-n">be</span> <span class="tok-o">(</span><span class="tok-s">&quot;Dennis&quot;</span><span class="tok-o">)</span> <span class="tok-c1">//Works because of val</span>
<span class="tok-n">emp</span><span class="tok-o">.</span><span class="tok-n">lastName</span> <span class="tok-n">should</span> <span class="tok-n">be</span> <span class="tok-o">(</span><span class="tok-s">&quot;Ritchie&quot;</span><span class="tok-o">)</span> <span class="tok-c1">//Works because of var</span>
<span class="tok-n">emp</span><span class="tok-o">.</span><span class="tok-n">lastName</span> <span class="tok-k">=</span> <span class="tok-s">&quot;Hopper&quot;</span>            <span class="tok-c1">//Works because of var</span>
<span class="tok-n">emp</span><span class="tok-o">.</span><span class="tok-n">lastName</span> <span class="tok-n">should</span> <span class="tok-n">be</span> <span class="tok-o">(</span><span class="tok-s">&quot;Hopper&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_methods">Scala Methods</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is a differentiation between <em>methods</em> and <em>functions</em></p>
</li>
<li>
<p>Methods in Scala belong to context like a <code>class</code>, <code>object</code>, <code>trait</code>, a script, or another method.</p>
</li>
<li>
<p>In Scala, a method starts with <code>def</code></p>
</li>
<li>
<p>Parameters are in reverse of what is expected in Java, value or variable before the type, e.g <code>age:Int</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_basic_non_concise_method">A Basic Non-Concise Method</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The <code>:Int</code> is the return type</p>
</li>
<li>
<p>If you expect something in return you need, an equal sign (<code>=</code>)</p>
</li>
<li>
<p>If you do not then leave it out</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
      <span class="tok-k">return</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cleaning_up_our_method">Cleaning up our Method</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A method can make use of <em>type inference</em></p>
</li>
<li>
<p>The braces are optional</p>
</li>
<li>
<p><code>return</code> is optional, in fact, it is rarely used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Therefore&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Discuss: Why there no longer is <code>:Int</code> at the end by referencing the API at <a href="http://www.scala-lang.org/api/current/" class="bare">http://www.scala-lang.org/api/current/</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_when_type_inference_is_not_good_enough">When type inference is not good enough</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There are times when you need the type:</p>
<div class="ulist">
<ul>
<li>
<p>To make things clear</p>
</li>
<li>
<p>Because the type inferencer could be wrong</p>
</li>
<li>
<p>Your method might be overloaded and it would be needed disambiguate from other methods</p>
</li>
<li>
<p>You&#8217;re doing recursion</p>
</li>
<li>
<p>You&#8217;re doing method overloading</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_figuring_out_the_type">Figuring out the type</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given the following what is the type?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">numberStatus</span><span class="tok-o">(</span><span class="tok-n">a</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span>
   <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">a</span> <span class="tok-o">&lt;</span> <span class="tok-mi">10</span><span class="tok-o">)</span> <span class="tok-s">&quot;Less than 10&quot;</span>
   <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">a</span> <span class="tok-o">&gt;</span> <span class="tok-mi">10</span><span class="tok-o">)</span> <span class="tok-s">&quot;Greater than 10&quot;</span>
   <span class="tok-k">else</span> <span class="tok-s">&quot;It is 10!&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">result</span> <span class="tok-k">=</span> <span class="tok-n">numberStatus</span><span class="tok-o">(</span><span class="tok-mi">3</span><span class="tok-o">)</span>
<span class="tok-n">result</span> <span class="tok-n">should</span> <span class="tok-n">be</span> <span class="tok-o">(</span><span class="tok-s">&quot;Greater than 10&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_type_hierarchy">Scala Type Hierarchy</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A type is a <code>class</code>, <code>trait</code>, a <strong>primitive</strong>, or an <code>object</code> in Scala.</p>
</li>
<li>
<p>A <code>class</code> for those who don&#8217;t know is a code template, or blueprint, that describes what the objects created from the blueprint will look like.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/vmarchitect.png" alt="vmarchitect">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Int</code> is a type</p>
</li>
<li>
<p><code>String</code> is a type</p>
</li>
<li>
<p>If we created a <code>Car</code> class, <code>Car</code> would be a type</p>
</li>
<li>
<p>If we created <code>InvoiceJSONSerializer</code>, <code>InvoiceJSONSerializer</code> would be a type</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_matching_types">Matching Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given these two methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span><span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-k">def</span> <span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-n">x</span> <span class="tok-o">-</span> <span class="tok-n">y</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use them together, you would just need to match the types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">,</span> <span class="tok-mi">3</span><span class="tok-o">),</span> <span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-mi">100</span><span class="tok-o">,</span> <span class="tok-mi">22</span><span class="tok-o">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we changed <code>subtract</code> to use <code>Double</code> instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span><span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-k">def</span> <span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Double</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Double</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Double</span> <span class="tok-o">=</span> <span class="tok-n">x</span> <span class="tok-o">-</span> <span class="tok-n">y</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We would just need to make sure that that type matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-mf">10.0</span><span class="tok-o">,</span> <span class="tok-mf">3.0</span><span class="tok-o">).</span><span class="tok-n">round</span><span class="tok-o">.</span><span class="tok-n">toInt</span><span class="tok-o">,</span> <span class="tok-n">subtract</span><span class="tok-o">(</span><span class="tok-mf">100.0</span><span class="tok-o">,</span> <span class="tok-mf">22.0</span><span class="tok-o">).</span><span class="tok-n">round</span><span class="tok-o">.</span><span class="tok-n">toInt</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_primitives_are_objects">Primitives Are Objects</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In Scala we treat everything like an object</p>
</li>
<li>
<p>Therefore, you can treat all numbers, boolean, and characters as types</p>
</li>
<li>
<p>Every primitive is a member of <code>AnyVal</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_java_lang_object_code_has_been_demoted"><code>java.lang.Object</code> has been demoted</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>java.lang.Object</code> is called <code>AnyRef</code> in Scala</p>
</li>
<li>
<p><code>AnyRef</code> will be the super type of all object references</p>
</li>
<li>
<p>This includes:</p>
<div class="ulist">
<ul>
<li>
<p>Scala API Classes</p>
</li>
<li>
<p>Java API Classes</p>
</li>
<li>
<p>Your custom classes</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_any_code_is_the_new_leader"><code>Any</code> is the new leader</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Any</code></p>
<div class="ulist">
<ul>
<li>
<p>Super type of:</p>
<div class="ulist">
<ul>
<li>
<p><code>AnyVal</code> (Primitive Wrappers)</p>
</li>
<li>
<p><code>AnyRef</code> (Object References)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_family_tree">Scala Family Tree</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Scala&#8217;s Family Tree:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/scalahierarchy.png" alt="scalahierarchy" width="60%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_polymorphism">Lab: Polymorphism</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Open a REPL either by typing <code>scala</code> or by running SBT&#8217;s <code>console</code>.<br></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Try various combinations of references and see how everything is match together.
          Try some of these combinations that may or may not work to be sure:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">a</span><span class="tok-k">:</span><span class="tok-kt">AnyVal</span> <span class="tok-o">=</span> <span class="tok-mi">40</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">b</span><span class="tok-k">:</span><span class="tok-kt">Any</span> <span class="tok-o">=</span> <span class="tok-n">a</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">c</span><span class="tok-k">:</span><span class="tok-kt">AnyRef</span> <span class="tok-o">=</span> <span class="tok-s">&quot;A String&quot;</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">d</span><span class="tok-k">:</span><span class="tok-kt">Any</span> <span class="tok-o">=</span> <span class="tok-n">c</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">e</span><span class="tok-k">:</span><span class="tok-kt">AnyRef</span> <span class="tok-o">=</span> <span class="tok-mi">40</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">f</span><span class="tok-k">:</span><span class="tok-kt">AnyVal</span> <span class="tok-o">=</span> <span class="tok-s">&quot;A String&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Discuss and ask any questions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_complete_hierarchy">The Complete Hierarchy</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/scalaclasshierarchy.png" alt="scalaclasshierarchy">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_nothing_code"><code>Nothing</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Nothing</code> is the sub type of everything</p>
</li>
<li>
<p>It is used for collections and other containers with no defined parameterized type</p>
</li>
<li>
<p>Used to represent a "bottom", a type that covers among other things, methods, that only throw <code>Throwable</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_where_is_code_nothing_code">Lab: Where is <code>Nothing</code>?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In a REPL try the following, create an empty <code>List</code> with no type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">list</span> <span class="tok-k">=</span> <span class="tok-nc">List</span><span class="tok-o">()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Create a <code>List</code> with a type, and note the difference</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">list2</span> <span class="tok-k">=</span> <span class="tok-nc">List</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]()</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Create a method called <code>ohoh</code> that returns only an <code>Exception</code>.
Throwing an <code>Exception</code> in particular is always of type <code>Nothing</code> since nothing
really ever gets returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-k">def</span> <span class="tok-n">ohoh</span><span class="tok-o">(</span><span class="tok-n">i</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Nothing</span> <span class="tok-o">=</span> <span class="tok-o">{</span> <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-nc">Exception</span><span class="tok-o">()</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It shouldn&#8217;t matter if it is an <code>Exception</code> or a <code>RuntimeException</code><br>
<br>
Link: <a href="http://www.scala-lang.org/api/current/scala/Nothing.html" class="bare">http://www.scala-lang.org/api/current/scala/Nothing.html</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_null_code"><code>Null</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Null</code> is a type in Scala that represents a <code>null</code></p>
</li>
<li>
<p><code>Null</code> is the sub type of all object references</p>
</li>
<li>
<p><code>null</code> is not used in pure Scala applications, but only for those that interop with Java</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_code_null_code_type">Lab: <code>Null</code> type</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In a REPL, type the following, and noticed the type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f</span> <span class="tok-k">=</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In the REPL, next try the following, and analyze the type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">String</span> <span class="tok-o">=</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> In the REPL, next try the following, and analyze the results,
can you guess why there is a strange message?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">=</span> <span class="tok-kc">null</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Types are templates that make up an object.</p>
</li>
<li>
<p>Primitives are also types, <code>Int</code>, <code>Short</code>, <code>Byte</code>, <code>Char</code>, <code>Boolean</code>, etc.</p>
</li>
<li>
<p>Types need to matched up like a puzzle.  If it isn&#8217;t the type system at compile time will tell you there is a type mismatch</p>
</li>
<li>
<p>Every type is in a relationship.</p>
</li>
<li>
<p><code>Any</code> is the parent for all types</p>
</li>
<li>
<p><code>AnyVal</code> is the parent for all primitives</p>
</li>
<li>
<p><code>AnyRef</code> is the parent for all Scala, Java, and custom classes that you create</p>
</li>
<li>
<p><code>Nothing</code> is the subtype for everything</p>
</li>
<li>
<p><code>Null</code> is the subtype of all references</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_code_unit_code">Scala <code>Unit</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is a <code>Unit</code> and it can be invoked using <code>()</code></p>
</li>
<li>
<p>A <code>Unit</code> is analogous to <code>void</code> in Java, C, C++</p>
</li>
<li>
<p>Used as an interpretation of not returning a something</p>
</li>
<li>
<p>Another way to interpret <code>Unit</code> is means there is nothing to give</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">g</span> <span class="tok-k">=</span> <span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_where_have_we_used_code_unit_code">Where have we used <code>Unit</code>?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is a popular form of <code>Unit</code></p>
</li>
<li>
<p>It is called <code>println</code>,</p>
</li>
<li>
<p><code>println</code> doesn&#8217;t return anything, therefore it is return <code>Unit</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://www.scala-lang.org/api/current/scala/Unit.html" class="bare">https://www.scala-lang.org/api/current/scala/Unit.html</a></p>
</div>
<div class="paragraph">
<p><a href="https://www.scala-lang.org/api/current/scala/Predef$.html" class="bare">https://www.scala-lang.org/api/current/scala/Predef$.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_determining_the_type_of_code_println_code">Determining the type of <code>println</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">h</span> <span class="tok-k">=</span> <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello, Scala&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_where_is_code_unit_code_in_the_scala_hierarchy">Where is <code>Unit</code> in the Scala hierarchy?</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/anyanyvalanyrefunit.png" alt="anyanyvalanyrefunit" width="60%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_the_return_type_of_this">What is the return type of this?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Without running, what do you think the return type is for the following?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
  <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-o">&gt;</span> <span class="tok-mi">10</span><span class="tok-o">)</span> <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">)</span>
  <span class="tok-k">else</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_unit_code_can_be_used_anywhere"><code>Unit</code> can be used anywhere</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Unit is just an object that represents a void</p>
</li>
<li>
<p>The following is a purely nonsensical method to prove that it can be treated like an object</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">nonsense</span><span class="tok-o">(</span><span class="tok-n">g</span><span class="tok-k">:</span><span class="tok-kt">Unit</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-mi">50</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unplanned_code_unit_code">Unplanned <code>Unit</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In methods, if you do not use the <code>=</code> that will implicitly mean that you are returning <code>Unit</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given the following which is correct, this will add <code>x</code> and <code>y</code>:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
   <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we didn&#8217;t use <code>=</code> this will implicitly return <code>Unit</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">badAdd</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span>

<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">badAdd</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span> <span class="tok-mi">5</span><span class="tok-o">))</span> <span class="tok-c1">//Returns a ()!</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explicitly_putting_code_unit_code">Explicitly putting <code>Unit</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If we can to write out the <code>Unit</code> explicitly we can do so, by stipulating <code>Unit</code> as the return type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">addUnit</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span><span class="tok-k">:</span><span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
   <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">addUnit</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span><span class="tok-mi">5</span><span class="tok-o">))</span> <span class="tok-c1">//Returns a ()!</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It&#8217;s called <code>addUnit</code> because we didn&#8217;t create it on purpose.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_side_effects_and_code_unit_code">Side Effects and <code>Unit</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>When seeing <code>Unit</code> in functional programming when being returned from a method, it means it likely is creating a side effect</p>
</li>
<li>
<p>A side effect is when some is changed to the outside world either</p>
<div class="ulist">
<ul>
<li>
<p>Printing to a screen</p>
</li>
<li>
<p>Printing to a printer</p>
</li>
<li>
<p>Saving to Storage</p>
</li>
<li>
<p>Changing State</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is changing state. Notice that this is returning <code>Unit</code>!<br>
Also, notice that there is <code>var</code>!<br>
A <code>Unit</code> return will typically mean that there is a side-effect</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">var</span> <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-mi">0</span>
<span class="tok-k">def</span> <span class="tok-n">sideEffect</span><span class="tok-o">()</span> <span class="tok-o">{</span>
   <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-n">a</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You don&#8217;t have to be too stringent in avoiding state, although some FP purist will disagree
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_tuples">Scala Tuples</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Tuples are dumb containers</p>
</li>
<li>
<p>Perfect for grouping items</p>
</li>
<li>
<p>Perfect for return two items or three or four particularly if they are different types</p>
</li>
<li>
<p>Perfect for Akka messages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_code_tuple_code">Creating a <code>Tuple</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">ta</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-s">&quot;cool&quot;</span><span class="tok-o">,</span> <span class="tok-mf">402.00</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">tb</span><span class="tok-k">:</span><span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-nc">Double</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-s">&quot;cool&quot;</span><span class="tok-o">,</span> <span class="tok-mf">402.00</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">tc</span><span class="tok-k">:</span><span class="tok-kt">Tuple3</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">String</span>, <span class="tok-kt">Double</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-s">&quot;cool&quot;</span><span class="tok-o">,</span> <span class="tok-mf">402.00</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is a <code>Tuple1</code>, <code>Tuple2</code>, <code>Tuple3</code>,&#8230;&#8203;<code>Tuple22</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_the_values_from_a_code_tuple_code">Getting the values from a <code>Tuple</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">ta</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-s">&quot;cool&quot;</span><span class="tok-o">,</span> <span class="tok-mf">402.00</span><span class="tok-o">)</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">ta</span><span class="tok-o">.</span><span class="tok-n">_1</span><span class="tok-o">)</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">ta</span><span class="tok-o">.</span><span class="tok-n">_2</span><span class="tok-o">)</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">ta</span><span class="tok-o">.</span><span class="tok-n">_3</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>_1</code>, <code>_2</code> comes from Haskell&#8217;s <code>first</code> and <code>second</code> functions
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_swapping_code_tuple_code">Swapping <code>Tuple</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Only a <code>Tuple2</code> can be swapped</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">t2</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-s">&quot;Foo&quot;</span><span class="tok-o">,</span> <span class="tok-mf">40.00</span><span class="tok-o">)</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">t2</span><span class="tok-o">.</span><span class="tok-n">swap</span><span class="tok-o">)</span> <span class="tok-c1">//(40.00, &quot;Foo&quot;)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntactic_sugar_for_tuples">Syntactic Sugar for Tuples</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Tuple2</code> can also be created with <code>&#8594;</code></p>
</li>
<li>
<p>The <code>&#8594;</code> is a method that is on every object that accepts another object</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">t2</span> <span class="tok-k">=</span> <span class="tok-s">&quot;Foo&quot;</span> <span class="tok-o">-&gt;</span> <span class="tok-mf">40.00</span> <span class="tok-c1">// (40.00, &quot;Foo&quot;)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can use the <code>-</code> and <code>&gt;</code> or you can use the unicode rightwards arrow: <code>→</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_magical_code_apply_code_method">The Magical <code>apply</code> method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Considering the following code once again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">Foo</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">bar</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run it, it would like this and return 50</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">foo</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Foo</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>
<span class="tok-n">foo</span><span class="tok-o">.</span><span class="tok-n">bar</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_replacing_code_bar_code_with_code_apply_code">Replacing <code>bar</code> with <code>apply</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s take the previous code and use <code>apply</code> instead of <code>bar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">Foo</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run it, it would like this and return 50</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">foo</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Foo</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>
<span class="tok-n">foo</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where thing are different, is that <strong>apply is not required method call and you can leave the word out!</strong><br></p>
</div>
<div class="paragraph">
<p>Therefore&#8230;&#8203;since we used apply it looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">foo</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Foo</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>
<span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_functions">Scala Functions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Think of functions as something that take input or multiple input and returns <strong><em>only one</em></strong> output</p>
</li>
<li>
<p>Functions are based on traits, <code>Function1</code>, <code>Function2</code>, &#8230;&#8203;,  <code>Function22</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_functions_the_hard_way">Functions the hard way</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given: An anonymous instantiation</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span><span class="tok-k">:</span><span class="tok-kt">Function1</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function1</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span>

<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">f1</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">))</span> <span class="tok-c1">//5</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>But since, the name of the method is <code>apply</code>&#8230;&#8203;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">f1</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">))</span> <span class="tok-c1">//5</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: In 2.12, it may not be like this, since they will integrate with Java 8&#8217;s backed <code>java.util.function</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_different_signatures_of_function_the_long_way">Different Signatures of Function (The long way)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Here are some functions declared the long way</p>
</li>
<li>
<p>We explicitly declare the types on the left hand side <code>Function1</code>, <code>Function0</code></p>
</li>
<li>
<p>We are instantiating the <code>traits</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span><span class="tok-k">:</span><span class="tok-kt">Function1</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function1</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span><span class="tok-k">:</span><span class="tok-kt">Function0</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function0</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">()</span> <span class="tok-k">=</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span><span class="tok-k">:</span><span class="tok-kt">Function2</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">String</span>, <span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function2</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">String</span>, <span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signatures_of_function_the_medium_way">Signatures of Function (The medium way)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Here are some functions declared the medium way</p>
</li>
<li>
<p>We explicitly declare the types on the left hand side as:</p>
<div class="ulist">
<ul>
<li>
<p><code>Int &#8658; Int</code> to represent <code>Function1[Int, Int]</code></p>
</li>
<li>
<p><code>() &#8658; Int</code> to represent <code>Function0[Int]</code></p>
</li>
<li>
<p><code>(Int, String) &#8658; String</code> to represent <code>Function2[Int, String, String]</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Of course these functions are still anonymous instantiating of <code>traits</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span><span class="tok-k">:</span><span class="tok-o">(</span><span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function1</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span><span class="tok-k">:</span><span class="tok-o">()</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function0</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">()</span> <span class="tok-k">=</span> <span class="tok-mi">1</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span><span class="tok-k">:</span><span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">String</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">Function2</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">String</span>, <span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-o">{</span>
     <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trimming_down_the_functions">Trimming down the functions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Give the functions from the previous page, we can clean up the functions</p>
</li>
<li>
<p>The left hand side uses a short hand notation to declare the types as before</p>
</li>
<li>
<p>The right hand side uses a short hand notation to create the function!</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span><span class="tok-k">:</span><span class="tok-o">()</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-o">()</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span><span class="tok-k">:</span><span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">String</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_making_it_concise_using_type_inference_with_functions">Making it concise: Using type inference with functions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Since there is heavy type inference in Scala, we can trim everything down</p>
</li>
<li>
<p>The left hand side can be left with little or no type annotation since the right hand side is declaring most of the information</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span> <span class="tok-k">=</span> <span class="tok-o">()</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_choosing_the_type_inference_left_hand_side_or_right_hand_side">Choosing the type inference, left hand side or right hand side</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using right hand side verbosity, and left hand side type inference</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span> <span class="tok-k">=</span> <span class="tok-o">()</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using right hand side inferred, and left hand side verbosely declared</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f1</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f0</span><span class="tok-k">:</span><span class="tok-o">()</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-o">()</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">1</span>

<span class="tok-k">val</span> <span class="tok-n">f2</span><span class="tok-k">:</span><span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">String</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">,</span><span class="tok-n">y</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">y</span> <span class="tok-o">+</span> <span class="tok-n">x</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_returning_more_than_one_result">Returning more than one result</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Every function has one return value so how do we return multiple items?</p>
</li>
<li>
<p>Use a <code>Tuple</code>!</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f3</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">x</span><span class="tok-o">.</span><span class="tok-n">size</span><span class="tok-o">)</span>  <span class="tok-c1">// Right hand side declaration</span>
<span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">f3</span><span class="tok-o">(</span><span class="tok-s">&quot;Laser&quot;</span><span class="tok-o">))</span>                <span class="tok-c1">// (&quot;Laser&quot;, 5)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trimming_the_result_with_code_code">Trimming the result with <code>_</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Given the function where the left hand side is declared with the type</p>
</li>
<li>
<p>We can provide a shortcut using the <code>_</code> that represents one of the arguments</p>
</li>
<li>
<p>Seasoned Scala developers will recognize this shortcut</p>
</li>
<li>
<p>Be aware that this may be confusing for novices</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Can be converted to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-mi">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Works the same when invoking the function</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">f5</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>  <span class="tok-c1">//41</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_feature_postfix_operators">Advanced Feature: Postfix Operators</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>If the argument on the right most position is a <code>_</code>, it can be omitted</p>
</li>
<li>
<p>This may require that an <code>import</code> feature may need to be turned on</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Can be converted to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-mi">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since addition is commutative, it can be rearranged jj</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-mi">1</span> <span class="tok-o">+</span> <span class="tok-k">_</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since, the <code>_</code> is at the right most position it can be dropped</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-mi">1</span><span class="tok-o">+</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Works the same when invoking the function</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">f5</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>  <span class="tok-c1">//41</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_feature_postfix_operators_clearing_warnings">Advanced Feature: Postfix Operators, Clearing Warnings</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>If you attempted to clear out the most <code>_</code> on the right hand side you may have received this warning:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>warning: postfix operator + should be enabled
by making the implicit value scala.language.postfixOps visible.
This can be achieved by adding the import clause 'import scala.language.postfixOps'
or by setting the compiler option -language:postfixOps.
See the Scaladoc for value scala.language.postfixOps for a discussion
why the feature should be explicitly enabled.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>This means that to avoid the warning you can turn that feature on by an <code>import</code> statement</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">scala.language.postfixOps</span>
<span class="tok-k">val</span> <span class="tok-n">f5</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-mi">1</span><span class="tok-o">+</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Works the same when invoking the function, and you get no warnings</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">f5</span><span class="tok-o">(</span><span class="tok-mi">40</span><span class="tok-o">)</span>  <span class="tok-c1">//41</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trimming_the_result_with_multiple_code_code">Trimming the result with multiple <code>_</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>If a function has two arguments, that too can use the <code>_</code> shortcut</p>
</li>
<li>
<p>The only thing is that <code>_</code> can only be applied to <strong>one</strong> argument</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is the before:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">sum</span><span class="tok-k">:</span> <span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the after:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">sum</span><span class="tok-k">:</span> <span class="tok-o">(</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">Int</span> <span class="tok-k">=</span> <span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-k">_</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note in the above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first <code>_</code> represents the first argument, or <code>x</code> in the above example</p>
</li>
<li>
<p>The second <code>_</code> represents the second argument, or <code>y</code> in the above example</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_partial_functions">Scala Partial Functions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A Scala partial function is must ask permission first.</p>
</li>
<li>
<p>A Partial Function uses <code>isDefinedAt</code> to determine if applicable</p>
</li>
<li>
<p>If applicable it will run using <code>apply</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">doubleEvens</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">PartialFunction</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">isDefinedAt</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">*</span> <span class="tok-mi">2</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">tripleOdds</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">PartialFunction</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">isDefinedAt</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">!=</span> <span class="tok-mi">0</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">*</span> <span class="tok-mi">3</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_combining_partial_functions">Combining Partial Functions</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">combinedPartialFunction</span> <span class="tok-k">=</span> <span class="tok-n">doubleEvens</span><span class="tok-o">.</span><span class="tok-n">orElse</span><span class="tok-o">(</span><span class="tok-n">tripleOdds</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Applying the above yields</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">combinedPartialFunction</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span> <span class="tok-c1">//20</span>
<span class="tok-n">combinedPartialFunction</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">15</span><span class="tok-o">)</span> <span class="tok-c1">//45</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_making_partial_functions_concise">Making Partial Functions Concise</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">doubleEvens</span> <span class="tok-k">=</span> <span class="tok-o">{</span><span class="tok-k">case</span> <span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span> <span class="tok-kt">if</span> <span class="tok-kt">x</span> <span class="tok-kt">%</span> <span class="tok-err">2</span> <span class="tok-o">=</span><span class="tok-k">=</span> <span class="tok-mi">0</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o"><strong></span> <span class="tok-mi">2</span><span class="tok-o">}</span>


<span class="tok-k">new</span> <span class="tok-nc">PartialFunction</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">isDefinedAt</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o"></strong></span> <span class="tok-mi">2</span>
<span class="tok-o">}</span>

<span class="tok-k">val</span> <span class="tok-n">tripleOdds</span> <span class="tok-k">=</span> <span class="tok-k">new</span> <span class="tok-nc">PartialFunction</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-o">{</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">isDefinedAt</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">!=</span> <span class="tok-mi">0</span>
  <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">*</span> <span class="tok-mi">3</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_combining_partial_functions_2">Combining Partial Functions</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">doubleEven</span><span class="tok-o">.</span><span class="tok-n">orElse</span><span class="tok-o">(</span><span class="tok-n">tripleOdds</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_code_object_code">Scala <code>object</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>We know that objects are instantiated from classes</p>
</li>
<li>
<p>We can also create an object, a single object, without a class</p>
</li>
<li>
<p>This is called an <code>object</code></p>
</li>
<li>
<p><strong>IMPORTANT:</strong> An <code>object</code> is a <strong>singleton</strong>. There is only one</p>
</li>
<li>
<p>It is how we avoid <code>static</code> methods</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_the_code_object_code">Lab: Trying out the <code>object</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Go to a Scala REPL or sbt console and type the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">object</span> <span class="tok-nc">MyObject</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Verify that it is truly a singleton</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">a</span> <span class="tok-k">=</span> <span class="tok-nc">MyObject</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-k">val</span> <span class="tok-n">b</span> <span class="tok-k">=</span> <span class="tok-nc">MyObject</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-n">a</span> <span class="tok-o">==</span> <span class="tok-n">b</span>
<span class="tok-n">scala</span><span class="tok-o">&gt;</span> <span class="tok-n">a</span> <span class="tok-n">eq</span> <span class="tok-n">b</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_we_avoid_code_static_code">How we avoid <code>static</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>We can add values, or variables, and methods to an <code>object</code></p>
</li>
<li>
<p>When we invoke those values, variable, and methods it looks and feels like invoking something <code>static</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_methods_to_code_myobject_code">Adding methods to <code>MyObject</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">MyObject</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span><span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To invoke this <code>object</code> we call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">MyObject</span><span class="tok-o">.</span><span class="tok-n">foo</span><span class="tok-o">(</span><span class="tok-mi">4</span><span class="tok-o">,</span> <span class="tok-mi">2</span><span class="tok-o">)</span> <span class="tok-n">should</span> <span class="tok-n">be</span> <span class="tok-o">(</span><span class="tok-mi">6</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_when_do_you_need_objects_when_do_you_need_singletons">When do you need objects? When do you need singletons?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For Classes</p>
<div class="ulist">
<ul>
<li>
<p>Need to define a template to create multiple instances</p>
</li>
<li>
<p>Every instance has a state</p>
</li>
</ul>
</div>
</li>
<li>
<p>For Objects</p>
<div class="ulist">
<ul>
<li>
<p>You need a singleton</p>
</li>
<li>
<p>You need a factory pattern, which defined as: Creating families of related or dependent objects without specifying or hiding their concrete classes.</p>
</li>
<li>
<p>You need to implement pattern matching logic</p>
</li>
<li>
<p>You need create a utility that doesn&#8217;t require and instance or a state.</p>
</li>
<li>
<p>You have some default values or constants</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_code_main_code_method">The <code>main</code> method</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The <code>main</code> method in Java requires all of this so that we can execute it as an application</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>
   <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello, Scala&quot;</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The same elements apply in Scala although the components are different</p>
<div class="ulist">
<ul>
<li>
<p><code>object</code> instead of <code>static</code></p>
</li>
<li>
<p><code>Unit</code> instead of <code>void</code></p>
</li>
<li>
<p>Everything is <code>public</code> by default</p>
</li>
<li>
<p><code>Array[String]</code> instead of <code>String[]</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Therefore the <code>main</code> method in Scala looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">Runner</span> <span class="tok-o">{</span> <span class="tok-c1">//Call it whatever you want</span>
  <span class="tok-k">def</span> <span class="tok-n">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-k">:</span><span class="tok-kt">Array</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">])</span><span class="tok-k">:</span><span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello, Scala&quot;</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_alternative_code_main_code_method">Alternative <code>main</code> method</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can also create a <code>main</code> method doing the following:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">Runner</span> <span class="tok-k">extends</span> <span class="tok-nc">App</span> <span class="tok-o">{</span>
   <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello, Scala&quot;</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_untyped_actors_in_scala">Untyped Actors in Scala</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_setting_up_your_first_actor_in_scala">Setting up your first actor in Scala</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Actors in Scala extend from <code>Actor</code></p>
</li>
<li>
<p>By extending <code>Actor</code> you must override <code>receive</code></p>
</li>
<li>
<p><code>receive</code> must return a <code>Receive</code> object</p>
</li>
<li>
<p>The <code>Receive</code> object is a <code>PartialFunction[Any, Unit]</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">SimpleActorScala</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span><span class="tok-o">{</span>
    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">receive</span><span class="tok-k">:</span> <span class="tok-kt">Receive</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-nc">Receive</span> <span class="tok-o">{</span>
        <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">isDefinedAt</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Any</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Boolean</span> <span class="tok-o">=</span> <span class="tok-o">???</span>

        <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">v1</span><span class="tok-k">:</span> <span class="tok-kt">Any</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">???</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_refined_a_code_receive_code_with_actual_code_partialfunction_code">Using a refined a <code>receive</code> with actual <code>PartialFunction</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">SimpleActorScala</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span><span class="tok-o">{</span>
   <span class="tok-k">val</span> <span class="tok-n">log</span> <span class="tok-k">=</span> <span class="tok-nc">Logging</span><span class="tok-o">(</span><span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">system</span><span class="tok-o">,</span> <span class="tok-k">this</span><span class="tok-o">)</span>

   <span class="tok-k">def</span> <span class="tok-n">receive</span><span class="tok-k">:</span><span class="tok-kt">Receive</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
     <span class="tok-k">case</span> <span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">String</span> <span class="tok-o">=&gt;</span>
       <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Received message in Simple Actor Scala {}&quot;</span><span class="tok-o">,</span> <span class="tok-n">x</span><span class="tok-o">)</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_refined_a_code_receive_code_with_actual_code_partialfunction_code_2">Using a refined a <code>receive</code> with actual <code>PartialFunction</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>We can use the <code>trait</code>, <code>ActorLogging</code> to mix in logging</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">SimpleActorScala</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span> <span class="tok-k">with</span> <span class="tok-nc">ActorLogging</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">receive</span><span class="tok-k">:</span><span class="tok-kt">Receive</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
     <span class="tok-k">case</span> <span class="tok-n">x</span><span class="tok-k">:</span><span class="tok-kt">String</span> <span class="tok-o">=&gt;</span>
       <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Received message in Simple Actor Scala {}&quot;</span><span class="tok-o">,</span> <span class="tok-n">x</span><span class="tok-o">)</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_code_actorsystem_code_with_an_code_actor_code_in_scala">Creating an <code>ActorSystem</code> with an <code>Actor</code> in Scala</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">package</span> <span class="tok-nn">com.akkatraining.scala</span>

<span class="tok-k">object</span> <span class="tok-nc">SimpleActorScalaRunner</span> <span class="tok-o">{</span>
   <span class="tok-k">def</span> <span class="tok-n">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-k">:</span><span class="tok-kt">Array</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">])</span><span class="tok-k">:</span><span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
      <span class="tok-k">val</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;My-Actor-System&quot;</span><span class="tok-o">)</span>
      <span class="tok-k">val</span> <span class="tok-n">props</span> <span class="tok-k">=</span> <span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">SimpleActorScala</span><span class="tok-o">]</span>
      <span class="tok-k">val</span> <span class="tok-n">actorRef</span> <span class="tok-k">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">,</span> <span class="tok-s">&quot;simpleActorScala&quot;</span><span class="tok-o">)</span>
      <span class="tok-n">actorRef</span> <span class="tok-o">!</span> <span class="tok-s">&quot;Hello&quot;</span>

      <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Press Enter to Terminate System&quot;</span><span class="tok-o">)</span>
      <span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-n">io</span><span class="tok-o">.</span><span class="tok-nc">StdIn</span><span class="tok-o">.</span><span class="tok-n">readLine</span><span class="tok-o">()</span>

      <span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">result</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">terminate</span><span class="tok-o">(),</span>
         <span class="tok-nc">Duration</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">,</span> <span class="tok-nc">TimeUnit</span><span class="tok-o">.</span><span class="tok-nc">SECONDS</span><span class="tok-o">))</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Props</code></p>
<div class="ulist">
<ul>
<li>
<p>A recipe as to how to create an <code>Actor</code></p>
</li>
<li>
<p>Is a message and can be used to send to other actors</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>actorSystem.actorOf</code> creates the actor</p>
</li>
<li>
<p><code>actorRef !</code> sends the message to an actor in a fire and forget fashion</p>
</li>
<li>
<p>This will run locally on a single JVM</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_an_actor_in_scala">Lab: Creating an Actor in Scala</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1</strong>: In <em>src/main/scala</em>, create a package called <code>com.akkatraining.scala</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2</strong>: Create <code>SimpleActorScala</code> in <code>com.akkatraining.scala</code> with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.akkatraining.scala</span>

<span class="tok-kd">class</span> <span class="tok-nc">SimpleActorScala</span> <span class="tok-kd">extends</span> <span class="tok-n">Actor</span> <span class="tok-o">{</span>
    <span class="tok-n">val</span> <span class="tok-n">log</span> <span class="tok-o">=</span> <span class="tok-n">Logging</span><span class="tok-o">(</span><span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-na">system</span><span class="tok-o">,</span> <span class="tok-k">this</span><span class="tok-o">)</span>

    <span class="tok-n">override</span> <span class="tok-n">def</span> <span class="tok-n">receive</span><span class="tok-o">:</span><span class="tok-n">Receive</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
        <span class="tok-k">case</span> <span class="tok-n">message</span><span class="tok-o">:</span><span class="tok-n">String</span> <span class="tok-o">=&gt;</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">info</span><span class="tok-o">(</span><span class="tok-s">&quot;&quot;&quot;Received String message</span>
<span class="tok-s">                        in Simple Actor Scala {}&quot;&quot;&quot;</span><span class="tok-o">,</span> <span class="tok-n">message</span><span class="tok-o">)</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Ensure that all imports are done (not shown)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_an_code_actorsystem_code_in_a_main_method_2">Lab: Creating an <code>ActorSystem</code> in a main method:</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the folder <em>src/main/scala</em> create an <code>object</code> called <code>SimpleActorScalaRunner</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.akkatraining.scala</span>

<span class="tok-n">object</span> <span class="tok-n">SimpleActorScalaRunner</span> <span class="tok-o">{</span>
    <span class="tok-n">def</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-o">:</span><span class="tok-n">Array</span><span class="tok-o">[</span><span class="tok-n">String</span><span class="tok-o">]):</span><span class="tok-n">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
        <span class="tok-n">val</span> <span class="tok-n">actorSystem</span> <span class="tok-o">=</span> <span class="tok-n">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;My-Actor-System&quot;</span><span class="tok-o">)</span>
        <span class="tok-n">val</span> <span class="tok-n">props</span> <span class="tok-o">=</span> <span class="tok-n">Props</span><span class="tok-o">[</span><span class="tok-n">SimpleActorScala</span><span class="tok-o">]</span>
        <span class="tok-n">val</span> <span class="tok-n">actorRef</span> <span class="tok-o">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-na">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">)</span>
        <span class="tok-n">actorRef</span> <span class="tok-o">!</span> <span class="tok-s">&quot;Hello&quot;</span>

        <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Press Enter to Terminate System&quot;</span><span class="tok-o">)</span>
        <span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-na">io</span><span class="tok-o">.</span><span class="tok-na">StdIn</span><span class="tok-o">.</span><span class="tok-na">readLine</span><span class="tok-o">()</span>

        <span class="tok-n">Await</span><span class="tok-o">.</span><span class="tok-na">result</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-na">terminate</span><span class="tok-o">(),</span>
           <span class="tok-n">Duration</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">,</span> <span class="tok-n">TimeUnit</span><span class="tok-o">.</span><span class="tok-na">SECONDS</span><span class="tok-o">))</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Repair any imports</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the main method either in your IDE or in SBT by running <code>run</code> in SBT, or in the command line, and selecting the class that you want to run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt run</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>% sbt
&gt; run</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_an_code_actorsystem_code_in_a_main_method_continued">Lab: Creating an <code>ActorSystem</code> in a main method (Continued):</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 4:</strong> Discuss the results</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Give <code>actorOf</code> a name of for your actor, run again, discuss the results</p>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> Discuss where <code>apply</code> was used</p>
</div>
<div class="paragraph">
<p><strong>Step 7:</strong> Discuss termination</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_actor_lifecycle_methods">Actor Lifecycle Methods</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_code_prestart_code"><code>preStart</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Lifecycle hook that is notified before an <code>Actor</code> is started</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">preStart</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_poststop_code"><code>postStop</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Lifecycle hook that is notified after an <code>Actor</code> is stopped</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">postStop</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_prerestart_code"><code>preRestart</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Lifecycle hook that is notified before a restart</p>
</li>
<li>
<p><code>reason</code> is a <code>Throwable</code> containing the reason for the <code>restart</code></p>
</li>
<li>
<p><code>message</code> will contain any message from the <code>restart</code></p>
</li>
<li>
<p>Used to clean up any resources or "unwatch" children</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">preRestart</span><span class="tok-o">(</span><span class="tok-n">reason</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span><span class="tok-o">,</span> <span class="tok-n">message</span><span class="tok-k">:</span> <span class="tok-kt">Option</span><span class="tok-o">[</span><span class="tok-kt">Any</span><span class="tok-o">])</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_postrestart_code"><code>postRestart</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Lifecycle hook that is notified after restart</p>
</li>
<li>
<p>Typically calling <code>preStart</code> since the actor has since restarted</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">postRestart</span><span class="tok-o">(</span><span class="tok-n">reason</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
  <span class="tok-n">preStart</span><span class="tok-o">()</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_newer_lifecyle_methods">Newer lifecyle methods</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There are some newer lifecycle methods that are wrappers around events</p>
</li>
<li>
<p>These have not been documented on the Akka website</p>
</li>
<li>
<p>They are:</p>
<div class="ulist">
<ul>
<li>
<p><code>aroundReceive</code></p>
</li>
<li>
<p><code>aroundPreStart</code></p>
</li>
<li>
<p><code>aroundPreRestart</code></p>
</li>
<li>
<p><code>aroundPostRestart</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">aroundPostStop</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
  <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;The actor is about to stop&quot;</span><span class="tok-o">)</span>
  <span class="tok-k">super</span><span class="tok-o">.</span><span class="tok-n">aroundPostStop</span><span class="tok-o">()</span>
  <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;The actor has stopped&quot;</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_lifecycle_map">Actor lifecycle map</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/actor_lifecycle.png" alt="actor lifecycle">
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_references">References</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_how_are_actors_referenced_from_an_code_actorsystem_code">How are actors referenced from an <code>ActorSystem</code>?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Given an actor deployed by the name of <code>simpleActorScala</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/anatomy_of_the_actor_system.png" alt="anatomy of the actor system">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_are_actors_mapped_as_a_uri">How are actors mapped as a URI?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given an <code>ActorSystem</code> called <code>actorSystem</code>&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="title">A local reference URL</div>
<div class="content">
<pre class="pygments highlight"><code>akka://my-sys/user/service-a/worker1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">A remote reference URI</div>
<div class="content">
<pre class="pygments highlight"><code>akka.tcp://my-sys@host.example.com:5678/user/service-b</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references_within_an_actor">References within an Actor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Within an actor, we can use the following references:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>sender</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ActorRef</code> that sent the message</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>self</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ActorRef</code> of the actor that it is running on</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>context</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The environment that the actor is in, <code>context.system</code> will return the <code>ActorSystem</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_how_the_references_are_resolved">How the references are resolved</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/ActorPath.png" alt="ActorPath">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_location_transparency">Location Transparency</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There is nearly no API for the remoting layer of Akka</p>
</li>
<li>
<p>It is purely driven by configuration.</p>
</li>
<li>
<p>Just write your application according to the principles</p>
</li>
<li>
<p>Then specify remote deployment of actor sub-trees in the configuration file.</p>
</li>
<li>
<p>This way, your application can be scaled out without having to touch the code</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_peer_to_peer_philosophy">Peer to Peer Philosophy</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Communication between involved systems is symmetric: <em>if a system A can connect to a system B then system B must also be able to connect to system A independently</em></p>
</li>
<li>
<p>The role of the communicating systems are symmetric in regards to connection patterns: <em>there is no system that only accepts connections, and there is no system that only initiates connections.</em></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_conversing_multiple_actors">Lab: Conversing multiple actors</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.conversation</code> called <code>ActorA</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>ActorA</code>, override the lifecycle methods <code>preStart</code>, and <code>aroundPostStop</code>
 and <code>log.info</code> when these events take place.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Inside of <code>ActorA</code> respond to these messages</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the <code>String</code> <code>"hello"</code> is received tell the <code>sender</code>, <code>"Hello to You"</code></p>
</li>
<li>
<p>When the <code>String</code> <code>"How are you doing?"</code> tell the <code>sender</code>, "Fine"</p>
</li>
<li>
<p>When anything else is sent, <code>log.info</code> with <code>log.info("Got something else {}", msg)</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_conversing_multiple_actors_continued">Lab: Conversing multiple actors (continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.conversation</code> called <code>ActorB</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>ActorB</code>, override the lifecycle methods <code>preStart</code>,
and <code>aroundPostStop</code> and <code>log.info</code> when these events take place.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Inside of <code>ActorB</code> respond to these messages</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When any <code>ActorRef</code> is received tell that <code>ActorRef</code>, <code>"Hello"</code></p>
</li>
<li>
<p>When the <code>String</code> <code>"Hello to you"</code> tell the <code>sender</code>, "How are you doing?"</p>
</li>
<li>
<p>When anything else is sent, <code>log.info</code> with <code>log.info("Got something else {}", msg)</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_conversing_multiple_actors_continued_2">Lab: Conversing multiple actors (continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, Create a runnable <code>object</code> inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.conversation</code> called <code>ActorConversationRunner</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In the <code>ActorConversationRunner</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code></p>
</li>
<li>
<p>Create <code>ActorA</code> in the <code>actorSystem</code> and obtain its <code>ActorRef</code></p>
</li>
<li>
<p>Create <code>ActorB</code> in the <code>actorSystem</code> and obtain its <code>ActorRef</code></p>
</li>
<li>
<p>Send <code>!</code> the reference of <code>actorA</code> to <code>actorB</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If there are issued it may be due to spelling, messages are case sensitive.
<strong>Step 3:</strong> Add a key listener to shut down the <code>actorSystem</code> when the <strong><em>ENTER</em></strong> key is pressed
</td>
</tr>
</table>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_code_implicit_code"><code>implicit</code></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_code_implicit_code_2"><code>implicit</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>implicit</code> is like an invisible <code>Map[Class[A], A]</code> where <code>A</code> is any object and it is tied into the scope</p>
</li>
<li>
<p>Whatever type is required the object that it corresponds to that type will be injected automatically.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/implicit_cloud.png" alt="implicit cloud" width="60%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_implicit_code_3"><code>implicit</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>implicit</code> in this case bounds an <code>Int</code> of <code>100</code></p>
</li>
<li>
<p>Once established we can call upon the <code>implicit</code> binding to a binding parameter group</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/implicit_cloud_int.png" alt="implicit cloud int" width="60%">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">hourlyRate</span> <span class="tok-k">=</span> <span class="tok-mi">100</span>

<span class="tok-k">def</span> <span class="tok-n">calcPayment</span><span class="tok-o">(</span><span class="tok-n">hours</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)(</span><span class="tok-k">implicit</span> <span class="tok-n">rate</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">hours</span> <span class="tok-o">*</span> <span class="tok-n">rate</span>

<span class="tok-n">calcPayment</span><span class="tok-o">(</span><span class="tok-mi">50</span><span class="tok-o">)</span> <span class="tok-n">should</span> <span class="tok-n">be</span><span class="tok-o">(</span><span class="tok-mi">5000</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overriding_an_code_implicit_code_manually">Overriding an <code>implicit</code> manually</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can always override the any <code>implicit</code> manually</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/implicit_cloud_int.png" alt="implicit cloud int" width="60%">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">hourlyRate</span> <span class="tok-k">=</span> <span class="tok-mi">100</span>

<span class="tok-k">def</span> <span class="tok-n">calcPayment</span><span class="tok-o">(</span><span class="tok-n">hours</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)(</span><span class="tok-k">implicit</span> <span class="tok-n">rate</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">)</span> <span class="tok-k">=</span> <span class="tok-n">hours</span> <span class="tok-o">*</span> <span class="tok-n">rate</span>

<span class="tok-n">calcPayment</span><span class="tok-o">(</span><span class="tok-mi">50</span><span class="tok-o">)(</span><span class="tok-mi">200</span><span class="tok-o">)</span> <span class="tok-n">should</span> <span class="tok-n">be</span><span class="tok-o">(</span><span class="tok-mi">10000</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_an_code_implicit_code_for_code_ordering_t_code">Setting up an <code>implicit</code> for <code>Ordering[T]</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can establish an <code>implicit</code> for ordering inside of a collection or any construct with <code>Ordering[T]</code></p>
</li>
<li>
<p>This is also known as a <em>Type Class</em></p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/implicit_cloud_ordering.png" alt="implicit cloud ordering" width="60%">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">case</span> <span class="tok-k">class</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-n">firstName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-n">lastName</span><span class="tok-k">:</span><span class="tok-kt">String</span><span class="tok-o">)</span>

<span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">employeeOrderingByLastName</span><span class="tok-k">:</span> <span class="tok-kt">Ordering</span><span class="tok-o">[</span><span class="tok-kt">Employee</span><span class="tok-o">]</span> <span class="tok-k">=</span>
  <span class="tok-k">new</span> <span class="tok-nc">Ordering</span><span class="tok-o">[</span><span class="tok-kt">Employee</span><span class="tok-o">]</span> <span class="tok-o">{</span>
    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">compare</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Employee</span><span class="tok-o">,</span> <span class="tok-n">y</span><span class="tok-k">:</span> <span class="tok-kt">Employee</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
      <span class="tok-n">x</span><span class="tok-o">.</span><span class="tok-n">lastName</span><span class="tok-o">.</span><span class="tok-n">compareToIgnoreCase</span><span class="tok-o">(</span><span class="tok-n">y</span><span class="tok-o">.</span><span class="tok-n">lastName</span><span class="tok-o">)</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_applying_the_code_implicit_code_for_code_ordering_t_code">Applying the <code>implicit</code> for <code>Ordering[T]</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once this <code>implicit</code> is established there is an <code>implicit</code> bound on how to order an <code>Employee</code></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="./images/implicit_cloud_ordering.png" alt="implicit cloud ordering" width="60%">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">List</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Eric&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Clapton&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Jeff&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Beck&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Ringo&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Starr&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Paul&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;McCartney&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;John&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Lennon&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;George&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Harrison&quot;</span><span class="tok-o">)).</span><span class="tok-n">sorted</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which yields the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">List</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Jeff&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Beck&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Eric&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Clapton&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;George&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Harrison&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;John&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Lennon&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Paul&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;McCartney&quot;</span><span class="tok-o">),</span>
        <span class="tok-k">new</span> <span class="tok-nc">Employee</span><span class="tok-o">(</span><span class="tok-s">&quot;Ringo&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Starr&quot;</span><span class="tok-o">))</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order to avoid any conflicts, it is up to you, the programmer, to decide in what scope <code>implicit</code> are applied
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_did_code_implicit_ordering_employee_code_work">Why did <code>implicit Ordering[Employee]</code> work?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Here is the Scala API signature for <code>sorted</code></p>
</li>
<li>
<p>Notice the <code>implicit</code> definition in the method signature</p>
</li>
<li>
<p>It requires that an implicit bound be available in order to process</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/list_sorting.png" alt="list sorting">
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_scala_futures">Scala Futures</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_semantic_differences_with_java_code_future_code">Semantic Differences with Java <code>Future</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A Scala <code>Future</code> is either <em>completed</em> or <em>not completed</em></p>
</li>
<li>
<p>When a <code>Future</code> is completed with a <em>value</em> it is <em>successfully completed</em></p>
</li>
<li>
<p>When a <code>Future</code> throws a <code>java.lang.Throwable</code> then it has <em>failed</em></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_code_future_code">Creating a <code>Future</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>scala.concurrent.Future[T]</code> is created with an <code>apply</code> in its <code>object</code></p>
</li>
<li>
<p>Optionally, you can call <code>Future.successful</code> or <code>Future.failed</code> as a quick alternative</p>
</li>
<li>
<p>Requires an <code>ExecutionContext</code> to be available either explicitly or implicitly</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.ExecutionContext.Implicits.global</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">executionContext</span> <span class="tok-k">=</span> <span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-n">concurrent</span><span class="tok-o">.</span><span class="tok-nc">ExecutionContext</span><span class="tok-o">.</span><span class="tok-n">global</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">executionContext</span> <span class="tok-k">=</span> <span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-n">concurrent</span><span class="tok-o">.</span><span class="tok-nc">ExecutionContext</span><span class="tok-o">.</span><span class="tok-n">fromExecutor</span><span class="tok-o">(...)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_foreach_code_to_receive_code_future_code_results">Using <code>foreach</code> to receive <code>Future</code> results</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To receive a the contents of a <code>Future</code> you can use <code>foreach</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">future</span><span class="tok-k">:</span><span class="tok-kt">Future</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-c1">//Create a future</span>
<span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">))</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_code_future_code_in_scala">Lab: Creating a <code>Future</code> in Scala</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <em>src/test/scala</em> directory and in the <code>com.akkatraining.scala.futures</code> package, open <em>FuturesSpec.scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 1: Create a basic Future in Scala"</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Follow along with instructor in creating a future</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Run the test in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.futures.FutureSpec -- -z &quot;Case 1:&quot;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It would be easier the first time to run <code>test:compile</code> first and use tab completion for the above line
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_await_ready_code">Using <code>Await.ready</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>scala.concurrent.Await.ready</code> will block and await the answer of the <code>Future</code></p>
</li>
<li>
<p>When the future is resolved either successfully or in failure it will return the same <code>Future</code></p>
</li>
<li>
<p>Think of it as a "waiting gate"</p>
</li>
<li>
<p>You can then use any <code>Future</code> methods to perform any operation needed.</p>
</li>
<li>
<p>Uses a <code>scala.concurrent.duration.Duration</code> as a timeout</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.duration._</span>

<span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">ready</span><span class="tok-o">(</span><span class="tok-n">future</span><span class="tok-o">,</span> <span class="tok-nc">Duration</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">2</span><span class="tok-o">,</span> <span class="tok-nc">TimeUnit</span><span class="tok-o">.</span><span class="tok-nc">SECONDS</span><span class="tok-o">))</span>
      <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">(</span><span class="tok-n">println</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_await_result_code">Using <code>Await.result</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>scala.concurrent.Await.result</code> will block and await the answer of the <code>Future</code></p>
</li>
<li>
<p>When the future is resolved successfully it will return the result from the <code>Future</code></p>
</li>
<li>
<p>Also, think of it as a "waiting gate", but this time it just returns what is "inside" of the <code>Future</code></p>
</li>
<li>
<p>Uses a <code>scala.concurrent.duration.Duration</code> as a timeout</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.duration._</span>

<span class="tok-k">val</span> <span class="tok-n">result</span><span class="tok-k">:</span> <span class="tok-kt">Int</span> <span class="tok-o">=</span> <span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">result</span><span class="tok-o">(</span><span class="tok-n">future</span><span class="tok-o">,</span> <span class="tok-nc">Duration</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-mi">2</span><span class="tok-o">,</span> <span class="tok-nc">TimeUnit</span><span class="tok-o">.</span><span class="tok-nc">SECONDS</span><span class="tok-o">))</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above future is a <code>Future[Int]</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_seeing_code_ready_code_and_code_result_code_in_action">Lab: Seeing <code>ready</code> and <code>result</code> in action</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <em>src/test/scala</em> directory and in the <code>com.akkatraining.scala.futures</code> package, open <em>FuturesSpec.scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 3:" and "Case 4:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 3:" and "Case 4:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.futures.FutureSpec -- -z &quot;Case 3:&quot;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It would be easier the first time to run <code>test:compile</code> first and use tab completion for the above line
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_future_successful_code"><code>Future.successful</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can just get straight to the point with a <code>Future</code> and call <code>successful</code> to return a value.</p>
</li>
<li>
<p>This is used if the Future being created has no potential of failure, like performing I/O.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">successful</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_future_failed_code"><code>Future.failed</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can just get straight to the point with a <code>Future</code> and call <code>failed</code> to return a failure.</p>
</li>
<li>
<p>This is used if the Future being created has no potential of failure, like performing I/O.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">failed</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">](</span><span class="tok-k">new</span> <span class="tok-nc">Throwable</span><span class="tok-o">(</span><span class="tok-s">&quot;Unable to complete&quot;</span><span class="tok-o">))</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_recover_code"><code>recover</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Creates a new future that will handle any matching <code>Throwable</code> that this future might contain.</p>
</li>
<li>
<p>If there is no match, or if this future contains a valid result then the new future will contain the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following will return <code>10</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">successful</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">).</span><span class="tok-n">recover</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-o">-</span><span class="tok-mi">1</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following will return <code>-1</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">failed</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">Throwable</span><span class="tok-o">(</span><span class="tok-s">&quot;Unable to complete&quot;</span><span class="tok-o">))</span>
      <span class="tok-o">.</span><span class="tok-n">recover</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-o">-</span><span class="tok-mi">1</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_recoverwith_code"><code>recoverWith</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Creates a new <code>Future</code> that will handle any matching <code>Throwable</code> that this future might contain.</p>
</li>
<li>
<p>Assigns it a value of another future.</p>
</li>
<li>
<p>If there is no match, or if this future contains a valid result then the new future will contain the same result.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following will return <code>10</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">successful</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">recoverWith</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">successful</span><span class="tok-o">(-</span><span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following will return <code>-1</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">failed</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-nc">Throwable</span><span class="tok-o">(</span><span class="tok-s">&quot;Unable to complete&quot;</span><span class="tok-o">))</span>
      <span class="tok-o">.</span><span class="tok-n">recoverWith</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">Future</span><span class="tok-o">.</span><span class="tok-n">successful</span><span class="tok-o">(-</span><span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_seeing_code_successful_code_code_failed_code_code_recover_code_and_code_recoverwith_code_in_action">Lab: Seeing <code>successful</code>, <code>failed</code>, <code>recover</code> and <code>recoverWith</code> in Action</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <em>src/test/scala</em> directory and in the <code>com.akkatraining.scala.futures</code> package, open <em>FuturesSpec.scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 5:" through "Case 8:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 5:" through "Case 8:" one at a time in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.futures.FutureSpec -- -z &quot;Case 5:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_try_code"><code>Try</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>abstract class</code> that has two <code>sealed</code> children</p>
<div class="ulist">
<ul>
<li>
<p><code>Success[T]</code> - Represents a success, contains the answer of type <code>T</code></p>
</li>
<li>
<p><code>Failure[T]</code> - Represents a failure, contains the <code>Throwable</code> that caused the failure</p>
</li>
</ul>
</div>
</li>
<li>
<p>Used to model an attempt of an action.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>sealed</code> means an abstraction like <code>abstract</code> and <code>trait</code> where all the children are declared and no one else can subclass the <code>sealed</code> abstraction
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_try_code_by_example"><code>Try</code> by Example</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Any that has the potential of an exception can be trapped within a <code>Try</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">def</span> <span class="tok-n">parseNumber</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Try</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Try</span> <span class="tok-o">{</span>
  <span class="tok-nc">Integer</span><span class="tok-o">.</span><span class="tok-n">parseInt</span><span class="tok-o">(</span><span class="tok-n">s</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We can then do typical functional programming</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">parseNumber</span><span class="tok-o">(</span><span class="tok-s">&quot;x&quot;</span><span class="tok-o">).</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">30</span><span class="tok-o">)</span>
<span class="tok-n">parseNumber</span><span class="tok-o">(</span><span class="tok-s">&quot;50&quot;</span><span class="tok-o">).</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">30</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We can do typical methods found in an <code>Option</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">triedInt1</span><span class="tok-o">.</span><span class="tok-n">getOrElse</span><span class="tok-o">(-</span><span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-n">should</span> <span class="tok-n">be</span><span class="tok-o">(-</span><span class="tok-mi">1</span><span class="tok-o">)</span>
<span class="tok-n">triedInt2</span><span class="tok-o">.</span><span class="tok-n">getOrElse</span><span class="tok-o">(-</span><span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-n">should</span> <span class="tok-n">be</span><span class="tok-o">(</span><span class="tok-mi">80</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_seeing_code_try_code_up_close">Lab: Seeing <code>Try</code> up close</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <em>src/test/scala</em> directory and in the <code>com.akkatraining.scala.futures</code> package, open <em>FuturesSpec.scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 9:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 9:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.futures.FutureSpec -- -z &quot;Case 9:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_oncomplete_code_to_receive_code_future_code_results">Using <code>onComplete</code> to receive <code>Future</code> results</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>onComplete</code></p>
<div class="ulist">
<ul>
<li>
<p>Will accept a <code>Function</code> that is given a <code>Try</code> input</p>
</li>
<li>
<p>The signature is the following:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">onComplete</span><span class="tok-o">[</span><span class="tok-kt">U</span><span class="tok-o">](</span><span class="tok-n">f</span><span class="tok-k">:</span> <span class="tok-o">(</span><span class="tok-kt">Try</span><span class="tok-o">[</span><span class="tok-kt">T</span><span class="tok-o">])</span> <span class="tok-k">=&gt;</span> <span class="tok-n">U</span><span class="tok-o">)(</span><span class="tok-k">implicit</span> <span class="tok-n">executor</span><span class="tok-k">:</span> <span class="tok-kt">ExecutionContext</span><span class="tok-o">)</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_processing_a_code_future_code_with_code_oncomplete_code">Lab: Processing a <code>Future</code> with <code>onComplete</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> Continuing inside <code>com.xyzcorp.futures.FuturesSpec</code>, we will have an</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 10:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Given the following <code>Future</code> called <code>eventualString</code> handle the response
 using <code>onComplete</code> given the signature you see in the previous page. Use <code>Await.ready</code>
 or <code>Await.result</code>, however you see fit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">eventualString</span><span class="tok-k">:</span> <span class="tok-kt">Future</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Future</span> <span class="tok-o">{</span>
  <span class="tok-k">val</span> <span class="tok-n">num</span> <span class="tok-k">=</span> <span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-n">util</span><span class="tok-o">.</span><span class="tok-nc">Random</span><span class="tok-o">.</span><span class="tok-n">nextInt</span><span class="tok-o">(</span><span class="tok-mi">2</span><span class="tok-o">)</span>
  <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">num</span> <span class="tok-o">==</span> <span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-s">&quot;Awesome!&quot;</span>
  <span class="tok-k">else</span> <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-nc">RuntimeException</span><span class="tok-o">(</span><span class="tok-s">s&quot;Invalid number </span><span class="tok-si">$num</span><span class="tok-s">&quot;</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Be sure to take out the <code>pending</code> at the beginning of the test</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> We will then run the test in your IDE or on in SBT using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>&gt; testOnly com.xyzcorp.futures.FuturesSpec -- -z "Case 10:"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_an_code_actorsystem_code_dispatcher_for_an_code_implicit_code_thread_pool">Using an <code>ActorSystem</code> dispatcher for an <code>implicit</code> thread pool</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can use an <code>ActorSystem</code> dispatcher as a thread pool for any <code>Future</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;TestSystem&quot;</span><span class="tok-o">)</span>
<span class="tok-k">import</span> <span class="tok-nn">actorSystem.dispatcher</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_importing_an_code_actorsystem_dispatcher_code_up_close">Lab: Importing an <code>ActorSystem.dispatcher</code> up close</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the <em>src/test/scala</em> directory and in the <code>com.akkatraining.scala.futures</code> package, open <em>FuturesSpec.scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 11:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 11:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.futures.FutureSpec -- -z &quot;Case 11:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_reactive">Reactive</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_reactive_architecture">Reactive Architecture</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_responsive">Responsive</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>System responds in a timely manner if at all possible.</p>
</li>
<li>
<p>Problems may be detected quickly and dealt with effectively.</p>
</li>
<li>
<p>Responsive systems focus on providing rapid and consistent response times,</p>
</li>
<li>
<p>Establishing reliable upper bounds so they deliver a consistent quality of service.</p>
</li>
<li>
<p>Consistent behavior simplifies</p>
<div class="ulist">
<ul>
<li>
<p>Error handling</p>
</li>
<li>
<p>Builds end user confidence</p>
</li>
<li>
<p>Encourages further interaction.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resilient">Resilient</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The system stays responsive in the face of failure.</p>
</li>
<li>
<p>Any system that is not resilient will be unresponsive after a failure.</p>
</li>
<li>
<p>Achieved by replication, containment, isolation and delegation.</p>
</li>
<li>
<p>Failures are contained within each component</p>
</li>
<li>
<p>Isolating components from each other and thereby ensuring that parts of the system can fail and recover without compromising the system as a whole.</p>
</li>
<li>
<p>Recovery of each component is delegated to another (external) component and high-availability is ensured by replication where necessary.</p>
</li>
<li>
<p>The client of a component is not burdened with handling its failures.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_elastic">Elastic</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The system stays responsive under varying workload.</p>
</li>
<li>
<p>React to changes in the input rate by increasing or decreasing the resources allocated to service these inputs.</p>
</li>
<li>
<p>Implies designs that have no contention points or central bottlenecks, resulting in the ability to shard or replicate components and distribute inputs among them.</p>
</li>
<li>
<p>Reactive Systems support predictive, as well as reactive, scaling algorithms by providing relevant live performance measures.</p>
</li>
<li>
<p>They achieve elasticity in a cost-effective way on commodity hardware and software platforms.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message_driven">Message-Driven</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Rely on asynchronous message-passing to establish a boundary between components that ensures:</p>
<div class="ulist">
<ul>
<li>
<p>Loose coupling</p>
</li>
<li>
<p>Isolation</p>
</li>
<li>
<p>Location Transparency.</p>
</li>
</ul>
</div>
</li>
<li>
<p>This boundary also provides the means to delegate failures as messages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message_driven_continued">Message-Driven Continued</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Employing explicit message-passing enables:</p>
<div class="ulist">
<ul>
<li>
<p>Load management</p>
</li>
<li>
<p>Elasticity</p>
</li>
<li>
<p>Flow control</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message_driven_flow_control">Message-Driven Flow Control</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/reactive-traits.svg" alt="reactive traits">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Flow control can be used to:</p>
<div class="ulist">
<ul>
<li>
<p>Shape and monitor message queues</p>
</li>
<li>
<p>Apply back-pressure when necessary.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Location transparent messaging as a means of communication makes it possible for the management of failure to work with the same constructs and semantics across a cluster or within a single host.</p>
</li>
<li>
<p>Non-blocking communication allows recipients to only consume resources while active, leading to less system overhead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reactive Manifesto (<a href="http://reactive-manifesto.org" class="bare">http://reactive-manifesto.org</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_non_blocking_communication">Non Blocking Communication</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Reactive is also about:</p>
<div class="ulist">
<ul>
<li>
<p>Non-blocking processes (<code>Future</code>) that do work</p>
</li>
<li>
<p>Knowing where to perform blocking and where not to</p>
</li>
<li>
<p>Prefer non-blocking in most cases</p>
</li>
<li>
<p>Tell the computer what to do, leave instructions when the future return, and leave</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive_programming">Reactive Programming</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/flow_advanced_shape.png" alt="flow advanced shape">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Not be confused with Reactive Architecture</p>
</li>
<li>
<p>Be able to process information as forks</p>
</li>
<li>
<p>Each fork is able may or may not converge</p>
</li>
<li>
<p>Use of functional programming to perform task(s)</p>
</li>
<li>
<p>Ability to add asynchronous boundaries</p>
</li>
<li>
<p>We will see more with Akka Streams</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_lightbend_config">Lightbend Config</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/lightbend/config" class="bare">https://github.com/lightbend/config</a></p>
</li>
<li>
<p>Implemented in plain Java with no dependencies</p>
</li>
<li>
<p>Supports files in three formats: Java properties, JSON, HOCON</p>
</li>
<li>
<p>Merges multiple files across all formats</p>
</li>
<li>
<p>Can load from files, URLs, or classpath</p>
</li>
<li>
<p>Support for "nesting" (treat any subtree of the config the same as the whole config)</p>
</li>
<li>
<p>Override the config with Java system properties, <code>java -Dmyapp.foo.bar=10</code></p>
</li>
<li>
<p>Configuring an app, with its framework and libraries, all from a single file such as <em>application.conf</em></p>
</li>
<li>
<p>Parses duration and size settings, <code>512k</code> or <code>10 seconds</code></p>
</li>
<li>
<p>Converts types</p>
<div class="ulist">
<ul>
<li>
<p>If you ask for a <code>boolean</code> and the value is the string "yes"</p>
</li>
<li>
<p>If you ask for a <code>float</code> and the value is an <code>int</code>, it will figure it out.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_quick_intro_to_hocon">A quick intro to HOCON</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>"Human-Optimized Config Object Notation"</p>
</li>
<li>
<p>JSON-Like Features</p>
</li>
<li>
<p>Typical configuration file: <em>application.conf</em></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sample_hocon_configuration">Sample HOCON Configuration</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:play"
db.default.user=sa
db.default.password=""</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sample_hocon_configuration_alternate_1">Sample HOCON Configuration (Alternate 1)</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>db {
  default.driver=org.h2.Driver
  default.url="jdbc:h2:mem:play"
  default.user=sa
  default.password=""
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sample_hocon_configuration_alternate_2">Sample HOCON Configuration (Alternate 2)</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>db {
  default {
    driver=org.h2.Driver
    url="jdbc:h2:mem:play"
    user=sa
    password=""
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hocon_features">HOCON features:</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Comments (Using <code>#</code>)</p>
</li>
<li>
<p>Includes</p>
</li>
<li>
<p>Substitutions (<code>"foo" : ${bar}</code>, <code>"foo" : Hello ${who}</code>)</p>
</li>
<li>
<p>Properties-like notation (<code>a.b=c</code>)</p>
</li>
<li>
<p>Less noisy, more lenient syntax</p>
</li>
<li>
<p>Substitute environment variables (<code>logdir=${HOME}/logs</code>)</p>
</li>
<li>
<p>API based on immutable <code>Config</code> instances, for thread safety and easy reasoning about config transformations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_em_application_conf_em"><em>application.conf</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Default configuration file name</p>
</li>
<li>
<p>All HOCON</p>
</li>
<li>
<p>One <strong><em>application.conf</em></strong> per application</p>
</li>
<li>
<p>Typically stored <strong><em>src/main/resources</em></strong></p>
</li>
<li>
<p>But you can also use:</p>
<div class="ulist">
<ul>
<li>
<p><em>application.json</em></p>
</li>
<li>
<p><em>application.properties</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_em_reference_conf_em"><em>reference.conf</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Default HOCON settings</p>
</li>
<li>
<p>Overridable by <em>application.conf</em></p>
</li>
<li>
<p>Typically packages by library with default settings</p>
<div class="ulist">
<ul>
<li>
<p>e.g. Akka contains <em>reference.conf</em></p>
</li>
<li>
<p><a href="https://github.com/akka/akka/blob/master/akka-actor/src/main/resources/reference.conf">Akka&#8217;s <code>reference.conf</code></a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_all_code_akka_code_information_is_stored_naturally_within_code_akka_code_tag">All <code>akka</code> information is stored naturally within <code>akka</code> tag</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is a sample configuation of a sample <em>application.conf</em> with <code>akka</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>akka {
  loggers = [&quot;akka.event.slf4j.Slf4jLogger&quot;]

  loglevel = &quot;DEBUG&quot;

  stdout-loglevel = &quot;DEBUG&quot;

  logging-filter = &quot;akka.event.slf4j.Slf4jLoggingFilter&quot;

  actor {
    provider = &quot;cluster&quot;

    default-dispatcher {
      throughput = 10
    }
  }

  remote {
    netty.tcp.port = 4711
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_a_configuration_from_a_code_string_code">Reading a configuration from a <code>String</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Though not quite as useful, we can put our configuration into a <code>String</code> and parse it</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">str</span> <span class="tok-k">=</span> <span class="tok-s">&quot;&quot;&quot;a{b = 4}&quot;&quot;&quot;</span>
<span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">parseString</span><span class="tok-o">(</span><span class="tok-n">str</span><span class="tok-o">)</span>
<span class="tok-n">config</span><span class="tok-o">.</span><span class="tok-n">getInt</span><span class="tok-o">(</span><span class="tok-s">&quot;a.b&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">str</span> <span class="tok-k">=</span> <span class="tok-s">&quot;&quot;&quot;a.b = 50&quot;&quot;&quot;</span>
<span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">parseString</span><span class="tok-o">(</span><span class="tok-n">str</span><span class="tok-o">)</span>
<span class="tok-n">config</span><span class="tok-o">.</span><span class="tok-n">getInt</span><span class="tok-o">(</span><span class="tok-s">&quot;a.b&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_viewing_the_parsing_of_a_code_string_code">Lab: Viewing the parsing of a <code>String</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 1:" through "Case 2:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 1:" through "Case 2:" one at a time in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_a_configuration_from_an_file">Reading a configuration from an file</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>We can read from the actor when ever we need using our configuration by calling</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>We can also read from a specific file by using the file name and leaving out the extension</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;myconfig&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_from_em_application_conf_em">Reading from <em>application.conf</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can read from <em>application.conf</em> which is the configuration standard
using the <em>resources prefix</em> in this case that is: <code>application</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;application&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">loggingFilter</span> <span class="tok-k">=</span> <span class="tok-n">config</span><span class="tok-o">.</span><span class="tok-n">getString</span><span class="tok-o">(</span><span class="tok-s">&quot;akka.logging-filter&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can also read from the <em>application.conf</em> by calling just <code>load()</code> since
reading from the <em>application.conf</em> is the default</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">()</span>
<span class="tok-k">val</span> <span class="tok-n">loggingFilter</span> <span class="tok-k">=</span> <span class="tok-n">config</span><span class="tok-o">.</span><span class="tok-n">getString</span><span class="tok-o">(</span><span class="tok-s">&quot;akka.logging-filter&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_parsing_of_the_em_application_conf_em">Lab: Parsing of the <em>application.conf</em></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 3:" through "Case 4:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 3:" through "Case 4:" one at a time in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 3:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overriding_properties_using_system_properties">Overriding properties using system properties</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can override properties from either the command line or via
<code>System.setProperty</code> and that setting will take hold.</p>
</li>
<li>
<p>This is a great way to change settings, like servers for deployment</p>
</li>
<li>
<p>To set a system property from the command, use the form:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>-Dfoo.bar.baz<span class="tok-o">=</span><span class="tok-s2">&quot;true&quot;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To do so programmatically, use <code>System.setProperty(&#8230;&#8203;)</code></p>
</li>
<li>
<p>To clear all settings programatically before <code>ConfigFactory.load</code> use <code>invalidateCaches</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_overriding_properties_using_system_properties">Lab: Overriding properties using system properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 5:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 5:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 5:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_a_different_configuration_within_a_configuration_file">Reading a different configuration within a configuration file</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A configuration file can be subdivided into logical sections that can inherit one another</p>
</li>
<li>
<p>These are called a <code>config</code></p>
</li>
<li>
<p>In the configuration, <code>context-a</code> can be read as a configuration with it&#8217;s own <code>a.b.c</code> value</p>
</li>
<li>
<p>You can also use the root as a fallback in case a value is unavailable in a config, like <code>a.b.c.d</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>a {
   b {
      c = 19
      d = true
   }
}

context-a {
   a {
      b {
         c = 30
      }
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_programmatically_reading_in_configurations">Programmatically reading in configurations</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Given the previous configuration, assuming the file prefix is called <em>sample3</em> and
reading in <code>a.b.c</code> will render <code>30</code> (See previous slide)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span>
               <span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;sample3&quot;</span><span class="tok-o">)</span>
               <span class="tok-o">.</span><span class="tok-n">getConfig</span><span class="tok-o">(</span><span class="tok-s">&quot;context-a&quot;</span><span class="tok-o">)</span>
<span class="tok-n">config</span><span class="tok-o">.</span><span class="tok-n">getDouble</span><span class="tok-o">(</span><span class="tok-s">&quot;a.b.c&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Since <code>a.b.c.d</code> is not available in <code>context-a</code>, we can still read <code>d</code> if the fallback is the root</p>
</li>
<li>
<p>This will require that you assign the original configuration to a value in order to do so</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">originalConfig</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;sample3&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-n">originalConfig</span>
               <span class="tok-o">.</span><span class="tok-n">getConfig</span><span class="tok-o">(</span><span class="tok-s">&quot;context-a&quot;</span><span class="tok-o">)</span>
               <span class="tok-o">.</span><span class="tok-n">withFallback</span><span class="tok-o">(</span><span class="tok-n">originalConfig</span><span class="tok-o">)</span>
<span class="tok-n">originalConfig</span><span class="tok-o">.</span><span class="tok-n">getBoolean</span><span class="tok-o">(</span><span class="tok-s">&quot;a.b.d&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_reading_a_different_configuration_within_a_configuration_file">Lab: Reading a different configuration within a configuration file</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 6:" through "Case 7:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 6:" through "Case 7:" one at a time in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 6:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_in_json">Reading in JSON</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A configuration file can also be read as JSON.</p>
</li>
<li>
<p>JSON is more verbose that HOCON, so favor HOCON whenever possible</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Sample JSON File</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;d&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;d1&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Hello&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;d2&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;World&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;e&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;e1&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Bon Jour&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;e2&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Monde&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Reading from code doesn&#8217;t look any different</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Reading from Scala file</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">originalConfig</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;sample5&quot;</span><span class="tok-o">)</span>
<span class="tok-n">originalConfig</span><span class="tok-o">.</span><span class="tok-n">getString</span><span class="tok-o">(</span><span class="tok-s">&quot;d.d2&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_reading_in_json">Lab: Reading in JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specifications "Case 8:" and review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 8:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 8:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_including_configuration_files">Including configuration files</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can include from other configuration files using the <code>include</code> directive.</p>
</li>
<li>
<p>It will essentially graft the entries from one file into the exact location where <code>include</code> is located.</p>
</li>
<li>
<p>Can be used with both HOCON, and JSON</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">JSON file</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;d&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;d1&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Hello&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;d2&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;World&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-nt">&quot;e&quot;</span><span class="tok-p">:</span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;e1&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Bon Jour&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;e2&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;Monde&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">HOCON File with an include</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>a {
   b {
      c = 19
      d = true
      include &quot;/sample5.json&quot;
   }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Therefore there will be <code>a.b.c.d.d1</code> coordinate in the file</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_including_configuration_files">Lab: Including configuration files</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 9:" review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 9:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 9:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_substitutions_with_hocon">Substitutions with HOCON</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Substitutions can be made from previously set values within
the configuration file</p>
</li>
<li>
<p>Substitutions are made using <code>${&#8230;&#8203;}</code> and using the coordinates within</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>a {
   b {
      c = 19
      d = true
      e = ${a.b.d}
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_substitutions_with_hocon">Lab: Substitutions with HOCON</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 10:" review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 10:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 10:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_in_lists">Reading in Lists</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Lists can also be read in from the Configuration API.</p>
</li>
<li>
<p>Unfortunately, determining the type is up to you,
and will return an <code>AnyRef</code> in Scala, or <code>Object</code> in Java</p>
</li>
<li>
<p>To get the underlying list, you will need to called <code>unwrapped</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">The HOCON with a list at <code>a.b.d</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>a {
   b {
      c = 30
      d = [&quot;Red&quot;, &quot;Orange&quot;, &quot;Green&quot;, &quot;Blue&quot;]
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">originalConfig</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">(</span><span class="tok-s">&quot;sample1&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">configList</span><span class="tok-k">:</span> <span class="tok-kt">ConfigList</span> <span class="tok-o">=</span> <span class="tok-n">originalConfig</span><span class="tok-o">.</span><span class="tok-n">getList</span><span class="tok-o">(</span><span class="tok-s">&quot;a.b.d&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">list</span><span class="tok-k">:</span><span class="tok-kt">List</span><span class="tok-o">[</span><span class="tok-kt">AnyRef</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-n">configList</span><span class="tok-o">.</span><span class="tok-n">unwrapped</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_reading_in_lists">Lab: Reading in Lists</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Case 11:" review.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run "Case 11:" in either your IDE, or within the SBT shell by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.config.ConfigSpec -- -z &quot;Case 11:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Change code and ask questions</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_reading_an_entry_from_em_application_conf_em">Lab: Reading an entry from <em>application.conf</em></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.config</code> located the <code>ConfigSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Locate the test "Lab 1: Using the Config API find the netty hostname
  in the remote-akka configuration"</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Using the Config API locate the Netty hostname in the <code>remote-akka</code> configuration</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Run the test to ensure success</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_ask_actors_in_scala">Ask Actors in Scala</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_using_the_code_code_or_code_code">Using the <code>!</code> or <code>?</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>!</code> means “fire-and-forget”</p>
<div class="ulist">
<ul>
<li>
<p>e.g. send a message asynchronously and return immediately</p>
</li>
<li>
<p>Also known as "tell"</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>?</code> sends a message asynchronously and returns a <code>Future</code></p>
<div class="ulist">
<ul>
<li>
<p>Represents a possible reply.</p>
</li>
<li>
<p>Also known as <code>ask</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This should look very familiar in the movie we saw, Erlang the Movie
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_code_sender_code_reference">Using the <code>sender()</code> reference</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>sender</code> reference</p>
<div class="ulist">
<ul>
<li>
<p>Can reply to an <code>Actor</code> or <code>Future</code> that made a request</p>
</li>
<li>
<p>Is of type <code>ActorRef</code></p>
</li>
<li>
<p>Can be reused and sent to other actors as a message</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Sending a response back in Scala</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">sender</span><span class="tok-o">()</span> <span class="tok-o">!</span> <span class="tok-n">replyMsg</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_code_ask_code_pattern">Using the <code>Ask</code> pattern</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To bring in functionality to use a <code>?</code>, then import <code>akka.pattern._</code>.</p>
</li>
<li>
<p>This will implicitly provide a <code>?</code> method to an <code>ActorRef</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Importing <code>ask</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.pattern._</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>To use, make the call with <code>?</code> this returns a <code>Future[Any]</code></p>
</li>
<li>
<p>To convert it to something meaningful you can use <code>mapTo[&#8230;&#8203;]</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Using <code>mapTo</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">future</span> <span class="tok-k">=</span> <span class="tok-n">actorRef</span> <span class="tok-o">?</span> <span class="tok-nc">LookupZipCode</span><span class="tok-o">(</span><span class="tok-s">&quot;123 Main St&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;San Diego&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;CA&quot;</span><span class="tok-o">)</span>
<span class="tok-n">future</span><span class="tok-o">.</span><span class="tok-n">mapTo</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_pipe_code_and_code_ask_code_combined_with_code_future_code_manipulation">Using <code>pipe</code> and <code>ask</code> combined with <code>Future</code> manipulation</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.pattern.</span><span class="tok-o">{</span> <span class="tok-n">ask</span><span class="tok-o">,</span> <span class="tok-n">pipe</span> <span class="tok-o">}</span>
<span class="tok-k">import</span> <span class="tok-nn">system.dispatcher</span> <span class="tok-c1">// The ExecutionContext that will be used</span>

<span class="tok-k">final</span> <span class="tok-k">case</span> <span class="tok-k">class</span> <span class="tok-nc">Result</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span><span class="tok-o">,</span> <span class="tok-n">s</span><span class="tok-k">:</span> <span class="tok-kt">String</span><span class="tok-o">,</span> <span class="tok-n">d</span><span class="tok-k">:</span> <span class="tok-kt">Double</span><span class="tok-o">)</span>
<span class="tok-k">case</span> <span class="tok-k">object</span> <span class="tok-nc">Request</span>

<span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">timeout</span> <span class="tok-k">=</span> <span class="tok-nc">Timeout</span><span class="tok-o">(</span><span class="tok-mi">5</span> <span class="tok-n">seconds</span><span class="tok-o">)</span> <span class="tok-c1">// needed for &lt;code&gt;?&lt;/code&gt; below</span>

<span class="tok-k">val</span> <span class="tok-n">f</span><span class="tok-k">:</span> <span class="tok-kt">Future</span><span class="tok-o">[</span><span class="tok-kt">Result</span><span class="tok-o">]</span> <span class="tok-k">=</span>
  <span class="tok-k">for</span> <span class="tok-o">{</span>
    <span class="tok-n">x</span> <span class="tok-k">←</span> <span class="tok-n">ask</span><span class="tok-o">(</span><span class="tok-n">actorA</span><span class="tok-o">,</span> <span class="tok-nc">Request</span><span class="tok-o">).</span><span class="tok-n">mapTo</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span> <span class="tok-c1">// call pattern directly</span>
    <span class="tok-n">s</span> <span class="tok-k">←</span> <span class="tok-o">(</span><span class="tok-n">actorB</span> <span class="tok-n">ask</span> <span class="tok-nc">Request</span><span class="tok-o">).</span><span class="tok-n">mapTo</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">]</span> <span class="tok-c1">// call by implicit conversion</span>
    <span class="tok-n">d</span> <span class="tok-k">←</span> <span class="tok-o">(</span><span class="tok-n">actorC</span> <span class="tok-o">?</span> <span class="tok-nc">Request</span><span class="tok-o">).</span><span class="tok-n">mapTo</span><span class="tok-o">[</span><span class="tok-kt">Double</span><span class="tok-o">]</span> <span class="tok-c1">// call by symbolic name</span>
  <span class="tok-o">}</span> <span class="tok-k">yield</span> <span class="tok-nc">Result</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">s</span><span class="tok-o">,</span> <span class="tok-n">d</span><span class="tok-o">)</span>

<span class="tok-n">f</span> <span class="tok-n">pipeTo</span> <span class="tok-n">actorD</span> <span class="tok-c1">// .. or ..</span>
<span class="tok-n">pipe</span><span class="tok-o">(</span><span class="tok-n">f</span><span class="tok-o">)</span> <span class="tok-n">to</span> <span class="tok-n">actorD</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/2.5/actors.html" class="bare">https://doc.akka.io/docs/akka/2.5/actors.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_code_ask_code_actor_as_a_calculation">Lab: <code>ask</code> Actor as a calculation</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.ask</code> locate the <code>AskActorSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Go to the specification "Lab 1:", here you will create an
 <code>ActorSystem</code> called <code>actorSystem</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> In the test, add the following as a way to manually shut down the server. This assumes
you called your <code>ActorSystem</code>, as <code>actorSystem</code> (See Step 2)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Press Enter to terminate&quot;</span><span class="tok-o">)</span>
<span class="tok-n">scala</span><span class="tok-o">.</span><span class="tok-n">io</span><span class="tok-o">.</span><span class="tok-nc">StdIn</span><span class="tok-o">.</span><span class="tok-n">readLine</span><span class="tok-o">()</span>
<span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">ready</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">terminate</span><span class="tok-o">(),</span> <span class="tok-mi">10</span> <span class="tok-n">seconds</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Make any necessary `import`s</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> In <em>src/main/scala</em> create an actor in the
 <code>com.akka.training.scala.ask</code> package called <code>AskActor</code> that will
  take in a message that are <code>case class</code> called <code>Add</code> and <code>Subtract</code>
  that take two <code>Int</code> parameters. Use the ask pattern and <code>sender()</code> to return
  the result of the computation.</p>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> In the <code>AskActorSpec</code> in <em>src/main/scala</em> and in the
  <code>com.akka.training.scala.ask</code> package, create an instance of <code>AskActor</code>
  and ask a <code>Add</code> or <code>Subtract</code> instance to
  obtain the future reference using <code>?</code> and process the
  result by making an ScalaTest assertion.</p>
</div>
<div class="paragraph">
<p><strong>Step 7:</strong> Run your lab using the following at the command line, or an IDE.
Be aware that your IDE may or may not be aware of the "Press Enter to continue"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.ask.AskActorSpec -- -z &quot;Lab 1:&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_using_two_code_ask_code_actors_and_composing_the_result">Lab: Using two <code>ask</code> Actors and composing the result</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.ask</code> locate the <code>AskActorSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In the <code>AskActorSpec</code>, and in "Lab 2:" create an instance of <code>AskActor</code>
  and ask a <code>Add</code> or <code>Subtract</code> actor to
  obtain the future reference using <code>?</code> and set it to a <code>val</code> with a
  name of your choosing</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Ask with another message to <code>Add</code> or <code>Subtract</code> and
 obtain that reference using <code>?</code> and set that to <code>val</code> with a name of
 your choosing</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Compose the two <code>Future</code> by multiplying both results using
some of the <code>Future</code> techniques we discussed.</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Implement a "Press Enter to Terminate" callback like we did in the previous lab</p>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> Run your lab using the following at the command line, or an IDE.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.ask.AskActorSpec -- -z &quot;Lab 2:&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_using_two_code_ask_code_actors_and_composing_the_result_with_a_for_comprehesion">Lab: Using two <code>ask</code> Actors and composing the result with a for comprehesion</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In the project, akka-training, locate <em>src/test/scala</em> and
in the package <code>com.akkatraining.scala.ask</code> locate the <code>AskActorSpec</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In the <code>AskActorSpec</code> in Lab 3, do the same thing as "Lab 2"
and use for comprehensions to process both <code>Future</code> and multiply both results</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run your lab using the following at the command line, or an IDE.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.ask.AskActorSpec -- -z &quot;Lab 3:&quot;</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_ask_actors_in_java">Ask Actors in Java</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_using_ask_actors_with_java">Using Ask Actors with Java</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For the <code>ask</code> pattern in Java, use <code>PatternCS</code></p>
</li>
<li>
<p><code>pipe</code> can be used to send messages over to an actor</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">static</span> <span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">pattern</span><span class="tok-o">.</span><span class="tok-nc">PatternsCS</span><span class="tok-o">.</span><span class="tok-n">ask</span><span class="tok-o">;</span>
<span class="tok-k">import</span> <span class="tok-nn">static</span> <span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">pattern</span><span class="tok-o">.</span><span class="tok-nc">PatternsCS</span><span class="tok-o">.</span><span class="tok-n">pipe</span><span class="tok-o">;</span>

<span class="tok-k">import</span> <span class="tok-nn">java.util.concurrent.CompletableFuture</span><span class="tok-o">;</span>
<span class="tok-nc">Timeout</span> <span class="tok-n">t</span> <span class="tok-k">=</span> <span class="tok-nc">Timeout</span><span class="tok-o">.</span><span class="tok-n">create</span><span class="tok-o">(</span><span class="tok-nc">Duration</span><span class="tok-o">.</span><span class="tok-n">ofSeconds</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">));</span>

<span class="tok-c1">// using 1000ms timeout</span>
<span class="tok-nc">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-nc">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">future1</span> <span class="tok-k">=</span>
  <span class="tok-n">ask</span><span class="tok-o">(</span><span class="tok-n">actorA</span><span class="tok-o">,</span> <span class="tok-s">&quot;request&quot;</span><span class="tok-o">,</span> <span class="tok-mi">1000</span><span class="tok-o">).</span><span class="tok-n">toCompletableFuture</span><span class="tok-o">();</span>

<span class="tok-c1">// using timeout from above</span>
<span class="tok-nc">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-nc">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">future2</span> <span class="tok-k">=</span>
  <span class="tok-n">ask</span><span class="tok-o">(</span><span class="tok-n">actorB</span><span class="tok-o">,</span> <span class="tok-s">&quot;another request&quot;</span><span class="tok-o">,</span> <span class="tok-n">t</span><span class="tok-o">).</span><span class="tok-n">toCompletableFuture</span><span class="tok-o">();</span>

<span class="tok-nc">CompletableFuture</span><span class="tok-o">&lt;</span><span class="tok-nc">Result</span><span class="tok-o">&gt;</span> <span class="tok-n">transformed</span> <span class="tok-k">=</span>
  <span class="tok-nc">CompletableFuture</span><span class="tok-o">.</span><span class="tok-n">allOf</span><span class="tok-o">(</span><span class="tok-n">future1</span><span class="tok-o">,</span> <span class="tok-n">future2</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-n">thenApply</span><span class="tok-o">(</span><span class="tok-n">v</span> <span class="tok-o">-&gt;</span> <span class="tok-o">{</span>
    <span class="tok-nc">String</span> <span class="tok-n">x</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-nc">String</span><span class="tok-o">)</span> <span class="tok-n">future1</span><span class="tok-o">.</span><span class="tok-n">join</span><span class="tok-o">();</span>
    <span class="tok-nc">String</span> <span class="tok-n">s</span> <span class="tok-k">=</span> <span class="tok-o">(</span><span class="tok-nc">String</span><span class="tok-o">)</span> <span class="tok-n">future2</span><span class="tok-o">.</span><span class="tok-n">join</span><span class="tok-o">();</span>
    <span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-nc">Result</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">,</span> <span class="tok-n">s</span><span class="tok-o">);</span>
  <span class="tok-o">});</span>

<span class="tok-n">pipe</span><span class="tok-o">(</span><span class="tok-n">transformed</span><span class="tok-o">,</span> <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">dispatcher</span><span class="tok-o">()).</span><span class="tok-n">to</span><span class="tok-o">(</span><span class="tok-n">actorC</span><span class="tok-o">);</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_stopping_actors">Stopping Actors</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_how_to_stop_an_actor">How to stop an actor?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An actor can be stopped any of these ways:</p>
<div class="ulist">
<ul>
<li>
<p>Manual Stop</p>
</li>
<li>
<p><code>PoisonPill</code></p>
</li>
<li>
<p>Killing the <code>Actor</code></p>
</li>
<li>
<p><code>GracefulStop</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_code_stop_code">Actor <code>stop</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This is a manual <code>stop</code> of the <code>Actor</code></p>
</li>
<li>
<p>To perform a <code>stop</code> use the <code>ActorSystem</code> and <code>stop</code></p>
</li>
<li>
<p><code>stop</code> is an asynchronous computation</p>
</li>
<li>
<p>Does not immediately terminate the <code>Actor</code> and will continue processing the message</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_code_stop_code_in_scala">Actor <code>stop</code> in Scala</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-o">...</span>
<span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">stop</span><span class="tok-o">(</span><span class="tok-n">myActorRef</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_code_stop_code_in_java">Actor <code>stop</code> in Java</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-nc">ActorSystem</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-o">...</span>
<span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">stop</span><span class="tok-o">(</span><span class="tok-n">myActorRef</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_code_poisonpill_code">Actor <code>PoisonPill</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>PoisonPill</code> poisons the queue with a message</p>
</li>
<li>
<p>Will be handled after messages that were already queued in the mailbox.</p>
</li>
<li>
<p>Once the <code>Actor</code> consumes the <code>PoisonPill</code> it is killed off</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">myActor</span> <span class="tok-o">!</span> <span class="tok-nc">PoisonPill</span><span class="tok-o">.</span><span class="tok-n">getInstance</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_actor_code_kill_code">Actor <code>Kill</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>akka.actor.Kill</code> will kill the actor</p>
</li>
<li>
<p>Killing will cause <code>ActorKilledException</code> to be thrown from the <code>Actor</code></p>
</li>
<li>
<p>The <code>ActorKilledException</code></p>
<div class="ulist">
<ul>
<li>
<p>Will trigger supervision if programmed</p>
</li>
<li>
<p>Causes parent how to handle the exception (or it&#8217;s parent)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">myActor</span> <span class="tok-o">!</span> <span class="tok-nc">Kill</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_deathwatch_code"><code>DeathWatch</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>DeathWatch</code></p>
</li>
<li>
<p>An <code>Actor</code> can receive a message when ever another actor is <code>terminated</code></p>
</li>
<li>
<p>Call <code>context</code> and watch to watch when an actor is <code>terminated</code></p>
</li>
<li>
<p>Given that we have a parent actor, we can <code>watch</code> like the following:</p>
</li>
<li>
<p>If the parent in turn does not handle the <code>Terminated</code> message
it will itself fail with an <code>DeathPactException</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">simpleActor</span> <span class="tok-k">=</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">SimpleActor</span><span class="tok-o">],</span> <span class="tok-s">&quot;SimpleActor&quot;</span><span class="tok-o">)</span>
<span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">watch</span><span class="tok-o">(</span><span class="tok-n">simpleActor</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can then setup message listeners when needed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">receive</span><span class="tok-k">:</span> <span class="tok-kt">PartialFunction</span><span class="tok-o">[</span><span class="tok-kt">Any</span>, <span class="tok-kt">Unit</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-o">...</span>
    <span class="tok-k">case</span> <span class="tok-nc">Terminated</span><span class="tok-o">(</span><span class="tok-n">actorRef</span><span class="tok-o">)</span> <span class="tok-k">=&gt;</span>
       <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span><span class="tok-s">&quot;&quot;&quot;Simple Actor has been terminated,</span>
<span class="tok-s">                  we know this because this actor</span>
<span class="tok-s">                  is a death watcher&quot;&quot;&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_gracefulstop_code"><code>GracefulStop</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Useful if you need to wait for termination or compose ordered
termination of one or several actors</p>
</li>
<li>
<p>When returned successfully, the actor’s <code>postStop()</code> hook will have been executed</p>
</li>
<li>
<p>There exists a happens-before edge between the end of <code>postStop()</code> and the return of <code>gracefulStop</code>()</p>
</li>
<li>
<p>This would be a perfect time to use <code>Future.sequence</code> or <code>Future.traverse</code> to gracefully stop a series of <code>Actors</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.pattern.gracefulStop</span>
<span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.Await</span>

<span class="tok-k">try</span> <span class="tok-o">{</span>
  <span class="tok-k">val</span> <span class="tok-n">stopped</span><span class="tok-k">:</span> <span class="tok-kt">Future</span><span class="tok-o">[</span><span class="tok-kt">Boolean</span><span class="tok-o">]</span> <span class="tok-k">=</span>
      <span class="tok-n">gracefulStop</span><span class="tok-o">(</span><span class="tok-n">actorRef</span><span class="tok-o">,</span> <span class="tok-mi">5</span> <span class="tok-n">seconds</span><span class="tok-o">,</span>
                   <span class="tok-nc">Manager</span><span class="tok-o">.</span><span class="tok-nc">Shutdown</span><span class="tok-o">)</span>
  <span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">result</span><span class="tok-o">(</span><span class="tok-n">stopped</span><span class="tok-o">,</span> <span class="tok-mi">6</span> <span class="tok-n">seconds</span><span class="tok-o">)</span>
  <span class="tok-c1">// the actor has been stopped</span>
<span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">{</span>
  <span class="tok-c1">// the actor wasn&#39;t stopped within 5 seconds</span>
  <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span> <span class="tok-kt">akka.pattern.AskTimeoutException</span> <span class="tok-o">⇒</span> <span class="tok-o">...</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stopping_actor_differences">Stopping Actor Differences</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>stop</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Method can be applied to the <code>self</code> reference from inside an Actor then that Actor</p>
</li>
<li>
<p>Will not terminate immediately</p>
</li>
<li>
<p>Requires a <code>context</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>Kill</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Throw an <code>ActorKilledException</code></p>
</li>
<li>
<p>Will trigger supervision.</p>
</li>
<li>
<p>Similar to <code>PoisonPill</code>, processed as message</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>PoisonPill</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Will terminate the <code>Actor</code> permanently.</p>
</li>
<li>
<p>Added to mailbox.</p>
</li>
<li>
<p>Allows messages to finish processing</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>GracefulStop</code></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Uses terminal operation <code>Kill</code>, or `Poison Pill, or custom message</p>
</li>
<li>
<p>Returns a Future given a message when done</p>
</li>
<li>
<p>Use custom message type to interact with other actors before termination</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_lab_stopping_an_actor_using_code_deathwatch_code_and_code_stop_code">Lab: Stopping an Actor using <code>DeathWatch</code> and <code>stop</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.stopping</code> called <code>DeathListenerActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>DeathListenerActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Listen to a message of <code>ActorRef</code>, and <code>watch</code> it</p>
</li>
<li>
<p>Listen to a message of <code>Terminated</code> and <code>log.info</code> which <code>Actor</code> terminated</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Create an actor inside of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.stopping</code> called <code>VictimActor</code>, and
just make this actor accept any <code>String</code> and print it to <code>log.info</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_stopping_an_actor_using_code_deathwatch_code_and_code_stop_code_continued">Lab: Stopping an Actor using <code>DeathWatch</code> and <code>stop</code> (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 4:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.stopping</code>
locate the <code>StoppingSpec</code> ang go to the specification in "Case 1:"</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Inside of "Case 1":</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>DeathListenerActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>VictimActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Register <code>VictimActor</code> with <code>DeathListenerActor</code></p>
</li>
<li>
<p>Send five <code>String</code> messages to <code>VictimActor</code> and then <code>stop</code> the <code>Victim Actor</code></p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.stopping.StoppingSpec -- -z &quot;Case 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 7:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_poison_pill_an_actor_using_code_deathwatch_code">Lab: Poison Pill an Actor using <code>DeathWatch</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.stopping</code>
locate the <code>StoppingSpec</code> and go to the specification in "Case 2:"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Case 2":</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>DeathListenerActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>VictimActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Register <code>VictimActor</code> with <code>DeathListenerActor</code></p>
</li>
<li>
<p>Send five <code>String</code> messages to <code>VictimActor</code> and then send a <code>PoisonPill</code> instance</p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.stopping.StoppingSpec -- -z &quot;Case 2:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_poison_pill_an_actor_with_a_code_gracefulstop_code_using_code_deathwatch_code">Lab: Poison Pill an Actor with a <code>GracefulStop</code> using <code>DeathWatch</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.stopping</code>
locate the <code>StoppingSpec</code> and go to the specification in "Case 3:"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Case 3":</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>DeathListenerActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>VictimActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Register <code>VictimActor</code> with <code>DeathListenerActor</code></p>
</li>
<li>
<p>Send five <code>String</code> messages to <code>VictimActor</code></p>
</li>
<li>
<p>Perform a <code>GracefulStop</code> with <code>PoisonPill</code> with a timeout of <code>3 seconds</code></p>
</li>
<li>
<p>Capture the <code>Future</code> of a graceful stop and either print the value of the <code>Future</code> or make an assertion on its value</p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.stopping.StoppingSpec -- -z &quot;Case 3:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_fault_tolerance">Fault Tolerance</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_child_code_actor_code">Child <code>Actor</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The ability for an <code>Actor</code> to create a child gives it <em>fault tolerance</em>.</p>
</li>
<li>
<p>Errors have a path on which to propagate</p>
</li>
<li>
<p>Akka passes any <code>Exception</code> or <code>Error</code> to the parent, or <em>supervisor</em></p>
</li>
<li>
<p>Any child <code>Actor</code> that is killed, will throw an <code>ActorKilledException</code></p>
</li>
<li>
<p>The Supervisor <code>Actor</code> then dictates what to do next</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_types_of_strategies">Types of Strategies</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>One-for-one strategy</strong> - Each child is treated separately</p>
</li>
<li>
<p><strong>All-for-one strategy</strong> - Any decision is applied to all children of the supervisor, not only the failing one</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_options_with_problematic_children">Options with problematic children</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Some options on how to handle a child <code>Actor</code> that caused an exception</p>
<div class="ulist">
<ul>
<li>
<p>Stop the <code>Actor</code></p>
</li>
<li>
<p>Ignore the Failure</p>
</li>
<li>
<p>Continue as if nothing happened</p>
</li>
<li>
<p>Restart the <code>Actor</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is where Akka&#8217;s popular term "Let it crash" comes from
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_of_a_supervisor_code_actor_code">Example of a Supervisor <code>Actor</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Actor</span>

<span class="tok-k">class</span> <span class="tok-nc">Supervisor</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span> <span class="tok-o">{</span>
  <span class="tok-k">import</span> <span class="tok-nn">akka.actor.OneForOneStrategy</span>
  <span class="tok-k">import</span> <span class="tok-nn">akka.actor.SupervisorStrategy._</span>
  <span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.duration._</span>

  <span class="tok-k">override</span> <span class="tok-k">val</span> <span class="tok-n">supervisorStrategy</span> <span class="tok-k">=</span>
    <span class="tok-nc">OneForOneStrategy</span><span class="tok-o">(</span><span class="tok-n">maxNrOfRetries</span> <span class="tok-k">=</span> <span class="tok-mi">10</span><span class="tok-o">,</span> <span class="tok-n">withinTimeRange</span> <span class="tok-k">=</span> <span class="tok-mi">1</span> <span class="tok-n">minute</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">case</span> <span class="tok-k">_:</span> <span class="tok-kt">ArithmeticException</span>      <span class="tok-o">⇒</span> <span class="tok-nc">Resume</span>
      <span class="tok-k">case</span> <span class="tok-k">_:</span> <span class="tok-kt">NullPointerException</span>     <span class="tok-o">⇒</span> <span class="tok-nc">Restart</span>
      <span class="tok-k">case</span> <span class="tok-k">_:</span> <span class="tok-kt">IllegalArgumentException</span> <span class="tok-o">⇒</span> <span class="tok-nc">Stop</span>
      <span class="tok-k">case</span> <span class="tok-k">_:</span> <span class="tok-kt">Exception</span>                <span class="tok-o">⇒</span> <span class="tok-nc">Escalate</span>
    <span class="tok-o">}</span>

  <span class="tok-k">def</span> <span class="tok-n">receive</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-k">case</span> <span class="tok-n">p</span><span class="tok-k">:</span> <span class="tok-kt">Props</span> <span class="tok-o">⇒</span> <span class="tok-n">sender</span><span class="tok-o">()</span> <span class="tok-o">!</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-n">p</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>maxNrOfRetries</code> the number of times a child actor is allowed to be restarted,
negative value means no limit, if the limit is exceeded
the child actor is stopped</p>
</li>
<li>
<p><code>withinTimeRange</code> duration of the time window for
<code>maxNrOfRetries</code>, <code>Duration.Inf</code> means no window</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_directives">Directives</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The match statement which forms the bulk of the body is of type <code>Decider</code> which is a <code>PartialFunction[Throwable, Directive]</code></p>
</li>
<li>
<p>The <code>Directives</code> that can be used are the following:</p>
<div class="ulist">
<ul>
<li>
<p><code>Resume</code> - Resumes message processing for the failed Actor</p>
</li>
<li>
<p><code>Restart</code> - Discards the old Actor instance and replaces it with a new then resumes message processing.</p>
</li>
<li>
<p><code>Stop</code> - Stops the Actor</p>
</li>
<li>
<p><code>Escalate</code> - Escalates the failure to the supervisor of the supervisor,
by rethrowing the cause of the failure, i.e. the supervisor fails with
the same exception as the child.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_of_a_child_code_actor_code">Example of a Child <code>Actor</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Actor</span>

<span class="tok-k">class</span> <span class="tok-nc">Child</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span> <span class="tok-o">{</span>
  <span class="tok-k">var</span> <span class="tok-n">state</span> <span class="tok-k">=</span> <span class="tok-mi">0</span>
  <span class="tok-k">def</span> <span class="tok-n">receive</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-k">case</span> <span class="tok-n">ex</span><span class="tok-k">:</span> <span class="tok-kt">Exception</span> <span class="tok-o">⇒</span> <span class="tok-k">throw</span> <span class="tok-n">ex</span>
    <span class="tok-k">case</span> <span class="tok-n">x</span><span class="tok-k">:</span> <span class="tok-kt">Int</span>        <span class="tok-o">⇒</span> <span class="tok-n">state</span> <span class="tok-k">=</span> <span class="tok-n">x</span>
    <span class="tok-k">case</span> <span class="tok-s">&quot;get&quot;</span>         <span class="tok-k">⇒</span> <span class="tok-n">sender</span><span class="tok-o">()</span> <span class="tok-o">!</span> <span class="tok-n">state</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_supervisor_strategy">Default Supervisor Strategy</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Escalate</code> is used if the defined strategy doesn’t cover the exception that was thrown.</p>
</li>
<li>
<p>When the supervisor strategy is not defined for an actor the following exceptions are handled by default:</p>
<div class="ulist">
<ul>
<li>
<p><code>ActorInitializationException</code> will stop the failing child actor</p>
</li>
<li>
<p><code>ActorKilledException</code> will stop the failing child actor</p>
</li>
<li>
<p><code>DeathPactException</code> will stop the failing child actor</p>
</li>
<li>
<p><code>Exception</code> will restart the failing child actor</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the exception escalate all the way up to the root guardian it will handle
it in the same way as the default strategy defined above.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka">Lab: Creating Fault Tolerance in Akka</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.faulttolerance</code> called <code>AllForOneParentActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>AllForOneParentActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Listen to a message of <code>Props</code>, using the given <code>Props</code> create 10 children within the parent</p>
</li>
<li>
<p>Send randomly one of children back to the <code>sender</code> using <code>scala.util.Random.nextInt</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Define a <code>supervisorStrategy</code>,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make it a <code>AllForOneStrategy</code> with 3 retries, and a <code>Duration</code> of <code>1 second</code>.</p>
</li>
<li>
<p>Program it so that an <code>IllegalArgumentException</code> is thrown we send it the <code>Restart</code> directive</p>
</li>
<li>
<p>Program it so that anything else is given the <code>Escalate</code> directive</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka_continued">Lab: Creating Fault Tolerance in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.faulttolerance</code> called <code>ChildActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>ChildActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Listen to a message of type <code>String</code> that says "IllegalArgumentException"</p>
</li>
<li>
<p>Then throw an <code>IllegalArgumentException</code> with the message "Oh No" and the <code>self.path.name</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Put in place the following lifecycle methods and <code>log.info</code>
the events as they happen and call the <code>super</code> methods when done.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>preStart</code></p>
</li>
<li>
<p><code>postStop</code></p>
</li>
<li>
<p><code>preRestart</code></p>
</li>
<li>
<p><code>postRestart</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka_continued_2">Lab: Creating Fault Tolerance in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.faulttolerance</code>
locate the <code>FaultToleranceSpec</code> and go to the specification in "Lab 1:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Lab 1:&#8230;&#8203;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create an <code>AllForOneParentActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>ChildActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create an <code>implicit</code> timeout using the following form:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">timeout</span><span class="tok-k">:</span> <span class="tok-kt">Timeout</span> <span class="tok-o">=</span> <span class="tok-nc">Timeout</span><span class="tok-o">(</span><span class="tok-mi">10L</span><span class="tok-o">,</span> <span class="tok-nc">TimeUnit</span><span class="tok-o">.</span><span class="tok-nc">SECONDS</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>Ask</em></strong> the all-for-one parent <code>ActorRef</code> with a <code>Prop</code> of <code>ChildActor</code></p>
</li>
<li>
<p>Retain the <code>Future</code> from the ask, and once returned send the child the message <code>"IllegalArgumentException"</code></p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Lab 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka_continued_3">Lab: Creating Fault Tolerance in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.faulttolerance</code> called <code>OneForOneParentActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>OneForOneParentActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Listen to a message of <code>Props</code>, using the given <code>Props</code> create 10 children within the parent</p>
</li>
<li>
<p>Send randomly one of children back to the <code>sender</code> using <code>scala.util.Random.nextInt</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Define a <code>supervisorStrategy</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make it a <code>OneForOneStrategy</code> with 3 retries, and a <code>Duration</code> of <code>1 second</code>.</p>
</li>
<li>
<p>Program it so that an <code>IllegalArgumentException</code> is thrown we send it the <code>Restart</code> directive</p>
</li>
<li>
<p>Program it so that anything else is given the <code>Escalate</code> directive</p>
</li>
<li>
<p>You can pretty much copy and paste from <code>AllForOneParentActor</code> and exchange the <code>SupervisorStrategy</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka_continued_4">Lab: Creating Fault Tolerance in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.faulttolerance</code>
locate the <code>FaultToleranceSpec</code> and go to the specification in "Lab 2: &#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Lab 2: &#8230;&#8203;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create a <code>OneForOneParentActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>ChildActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create an <code>implicit</code> timeout</p>
</li>
<li>
<p><strong><em>Ask</em></strong> the parent <code>ActorRef</code> and give it a <code>Prop</code> of <code>ChildActor</code></p>
</li>
<li>
<p>Retain the <code>Future</code> from the ask, and once returned send the child the message <code>"IllegalArgumentException"</code></p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Lab 2:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_fault_tolerance_in_akka_continued_5">Lab: Creating Fault Tolerance in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.faulttolerance</code>
locate the <code>FaultToleranceSpec</code> and go to the specification in "Lab 3: &#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Lab 3: &#8230;&#8203;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create a <code>OneForOneParentActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create <code>ChildActor</code> in <code>actorSystem</code></p>
</li>
<li>
<p>Create an <code>implicit</code> timeout</p>
</li>
<li>
<p><strong><em>Ask</em></strong> the parent <code>ActorRef</code> and give it a <code>Prop</code> of <code>ChildActor</code></p>
</li>
<li>
<p>Retain the <code>Future</code> from the ask, and once returned <strong><em>kill</em></strong> the <code>ChildActor</code></p>
</li>
<li>
<p>Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Lab 3:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_timers">Timers</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_making_events_happens">Making events happens</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can cause events to happen based on time:</p>
<div class="ulist">
<ul>
<li>
<p>Schedule Once</p>
</li>
<li>
<p>Periodic Events</p>
</li>
</ul>
</div>
</li>
<li>
<p>Events are messages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_cases">Use Cases</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Timeout</p>
</li>
<li>
<p>Keeping a pulse for an operation</p>
</li>
<li>
<p>Circuit Breaker Pattern</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For cron operations, use <a href="https://github.com/enragedginger/akka-quartz-scheduler">Akka&#8217;s quartz scheduler</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stopping_events">Stopping Events</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You will get a <code>Cancellable</code> back that you can call <code>cancel</code> to
cancel the execution of any scheduled operation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_schedule_once_example">Schedule Once Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">system.dispatcher</span>
<span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.duration.Duration._</span>

<span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">scheduler</span><span class="tok-o">.</span><span class="tok-n">scheduleOnce</span><span class="tok-o">(</span><span class="tok-mi">50</span> <span class="tok-n">milliseconds</span><span class="tok-o">,</span> <span class="tok-n">testActor</span><span class="tok-o">,</span> <span class="tok-s">&quot;foo&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_schedule_once_function">Schedule Once Function</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">system.dispatcher</span>
<span class="tok-k">import</span> <span class="tok-nn">scala.concurrent.duration.Duration._</span>

<span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">scheduler</span><span class="tok-o">.</span><span class="tok-n">scheduleOnce</span><span class="tok-o">(</span><span class="tok-mi">50</span> <span class="tok-n">milliseconds</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-n">testActor</span> <span class="tok-o">!</span> <span class="tok-nc">System</span><span class="tok-o">.</span><span class="tok-n">currentTimeMillis</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_perpetual_event">Perpetual Event</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>schedule</code> can be given an <code>initialDelay</code>, and <code>interval</code> to schedule a perpetual event</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">tickActor</span> <span class="tok-k">=</span> <span class="tok-o">...</span>
<span class="tok-k">val</span> <span class="tok-n">cancellable</span> <span class="tok-k">=</span>
  <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">scheduler</span><span class="tok-o">.</span><span class="tok-n">schedule</span><span class="tok-o">(</span>
    <span class="tok-mi">0</span> <span class="tok-n">milliseconds</span><span class="tok-o">,</span>
    <span class="tok-mi">50</span> <span class="tok-n">milliseconds</span><span class="tok-o">,</span>
    <span class="tok-n">tickActor</span><span class="tok-o">,</span>
    <span class="tok-n">tick</span><span class="tok-o">)</span>

<span class="tok-n">cancellable</span><span class="tok-o">.</span><span class="tok-n">cancel</span><span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_scheduler">Lab: Creating a Scheduler</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.schedulers</code>
locate the <code>SchedulersSpec</code> and go to the specification in "Lab 1:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of "Lab 1:&#8230;&#8203;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an <code>ActorSystem</code> called <code>actorSystem</code></p>
</li>
<li>
<p>Create a <code>SimpleActorScala</code> in <code>actorSystem</code>, the same <code>SimpleActorScala</code> you created at the beginning of class</p>
</li>
<li>
<p>Schedule a message of <code>"Ping"</code> every 5 seconds</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Sleep on the <code>main</code> thread for 30 seconds, and then cancel the scheduler</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Shut down the <code>actorSystem</code></p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.schedulers.SchedulersSpec -- -z &quot;Lab 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> Notice the behavior</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_dispatchers">Dispatchers</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_about_dispatchers">About Dispatchers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An Akka <code>MessageDispatcher</code> is what makes Akka Actors “tick”</p>
</li>
<li>
<p>It is the engine or thread pool of the <code>ActorSystem</code> so to speak</p>
</li>
<li>
<p>All <code>MessageDispatcher</code> implementations are also an <code>ExecutionContext</code></p>
<div class="ulist">
<ul>
<li>
<p>That means that they can be used to execute arbitrary code, for instance <code>Future</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_dispatcher">Default Dispatcher</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Every <code>ActorSystem</code> will have a default dispatcher if one is not configured</p>
</li>
<li>
<p>The <code>default-dispatcher</code> can be configured in the <em>application.conf</em></p>
</li>
<li>
<p>If an <code>ActorSystem</code> is created with an <code>ExecutionContext</code> then that will be the default dispatcher</p>
</li>
<li>
<p>If no dispatcher is configured or supplied, then the default is a Fork-Join pool specified in <code>akka.actor.default-dispatcher.default-executor.fallback</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fork_join_dispatcher">Fork-Join Dispatcher</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Employing work-stealing:</p>
<div class="ulist">
<ul>
<li>
<p>All threads in the pool attempt to find and execute tasks submitted to the pool and/or created by other active tasks</p>
</li>
<li>
<p>Eventually blocking waiting for work if none exist)</p>
</li>
<li>
<p>This enables efficient processing when most tasks spawn other subtasks</p>
</li>
</ul>
</div>
</li>
<li>
<p>More information about <a href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/ForkJoinPool.html">Java&#8217;s Fork Join Pool Executor</a></p>
</li>
<li>
<p><code>type</code> descibes that the configuration is a <code>Dispatcher</code></p>
</li>
<li>
<p><code>executor</code> is the type of executor</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>my-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to use
  executor = &quot;fork-join-executor&quot;
  # Configuration for the fork join pool
  fork-join-executor {
    # Min number of threads to cap factor-based parallelism number to
    parallelism-min = 2
    # Parallelism (threads) ... ceil(available processors * factor)
    parallelism-factor = 2.0
    # Max number of threads to cap factor-based parallelism number to
    parallelism-max = 10
  }
  # Throughput defines the maximum number of messages to be
  # processed per actor before the thread jumps to the next actor.
  # Set to 1 for as fair as possible.
  throughput = 100
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>parallelism-max</code> and <code>parallelism-min</code> are the number of <em>hot</em> threads to avoid latency
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thread_pool_executor">Thread Pool Executor</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An <code>ExecutorService</code> that executes each submitted task using one of possibly several pooled threads</p>
</li>
<li>
<p>Urged to use:</p>
<div class="ulist">
<ul>
<li>
<p><code>Executors.newCachedThreadPool()</code></p>
</li>
<li>
<p><code>Executors.newFixedThreadPool(int)</code></p>
</li>
<li>
<p><code>Executors.newSingleThreadExecutor()</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>blocking-io-dispatcher {
  type = Dispatcher
  executor = &quot;thread-pool-executor&quot;
  thread-pool-executor {
    fixed-pool-size = 32
  }
  throughput = 1
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_actor_with_a_certain_dispatcher">Creating an Actor with a certain dispatcher</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">From the <code>ActorSystem</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Props</span>
<span class="tok-k">val</span> <span class="tok-n">myActor</span> <span class="tok-k">=</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">MyActor</span><span class="tok-o">],</span> <span class="tok-s">&quot;myactor&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Inside <code>application.conf</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">actor</span><span class="tok-o">.</span><span class="tok-n">deployment</span> <span class="tok-o">{</span>
   <span class="tok-o">/</span><span class="tok-n">myactor</span> <span class="tok-o">{</span>
       <span class="tok-n">dispatcher</span> <span class="tok-k">=</span> <span class="tok-n">my</span><span class="tok-o">-</span><span class="tok-n">dispatcher</span>
   <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_alternate_to_create_code_actor_code_with_a_code_dispatcher_code">Alternate to create <code>Actor</code> with a <code>Dispatcher</code></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Creating an <code>Actor</code> with a certain <code>Dispatcher</code> from <em>application.conf</em></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Props</span>
<span class="tok-k">val</span> <span class="tok-n">props</span> <span class="tok-k">=</span> <span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">MyActor</span><span class="tok-o">].</span><span class="tok-n">withDispatcher</span><span class="tok-o">(</span><span class="tok-s">&quot;my-dispatcher&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">myActor</span> <span class="tok-k">=</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">,</span> <span class="tok-s">&quot;myactor1&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
That <code>my-dispatcher</code> is the path in <em>application.conf</em> and you can put full paths(e.g. <code>"foo.bar.my-dispatcher"</code>)
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standard_form_code_dispatcher_code">Standard Form <code>Dispatcher</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This is an event-based dispatcher that binds a set of Actors to a thread pool.</p>
</li>
<li>
<p>It is the default dispatcher used if one is not specified.</p>
</li>
<li>
<p>Sharability: Unlimited</p>
</li>
<li>
<p>Mailboxes: Any, creates one per Actor</p>
</li>
<li>
<p>Use cases: Default dispatcher, Bulkheading</p>
</li>
<li>
<p>Driven by: <code>java.util.concurrent.ExecutorService</code>.</p>
</li>
<li>
<p>For <code>executor</code></p>
<div class="ulist">
<ul>
<li>
<p><code>fork-join-executor</code></p>
</li>
<li>
<p><code>thread-pool-executor</code></p>
</li>
<li>
<p>FQCN of an <code>akka.dispatcher.ExecutorServiceConfigurator</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/current/dispatchers.html" class="bare">https://doc.akka.io/docs/akka/current/dispatchers.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_pinneddispatcher_code"><code>PinnedDispatcher</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This dispatcher dedicates a unique thread for each actor using it
i.e. each actor will have its own thread pool with only one thread in the pool.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sharability: None</p>
</li>
<li>
<p>Mailboxes: Any, creates one per Actor</p>
</li>
<li>
<p>Use cases: Bulkheading</p>
</li>
<li>
<p>Driven by: Any <code>akka.dispatch.ThreadPoolExecutorConfigurator</code>. By default a <code>thread-pool-executor</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/current/dispatchers.html" class="bare">https://doc.akka.io/docs/akka/current/dispatchers.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_callingthreaddispatcher_code"><code>CallingThreadDispatcher</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This dispatcher runs invocations on the current thread only.
 This dispatcher does not create any new threads, but it can be
  used from different threads concurrently for the same actor.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sharability: Unlimited</p>
</li>
<li>
<p>Mailboxes: Any, creates one per Actor per Thread (on demand)</p>
</li>
<li>
<p>Use cases: Testing</p>
</li>
<li>
<p>Driven by: The calling thread</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/current/dispatchers.html" class="bare">https://doc.akka.io/docs/akka/current/dispatchers.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_affinity_pool_dispatcher_code"><code>Affinity Pool Dispatcher</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Increase throughput in cases where there is relatively small number of actors that maintain some internal state.</p>
</li>
<li>
<p>Tries its best to ensure that an actor is always scheduled to run on the same thread.</p>
</li>
<li>
<p>Aims to decrease CPU cache misses which can result in significant throughput improvement.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>affinity-pool-dispatcher {
  # Dispatcher is the name of the event-based dispatcher
  type = Dispatcher
  # What kind of ExecutionService to use
  executor = &quot;affinity-pool-executor&quot;
  # Configuration for the thread pool
  affinity-pool-executor {
    # Min number of threads to cap factor-based parallelism number to
    parallelism-min = 8
    # Parallelism (threads) ... ceil(available processors * factor)
    parallelism-factor = 1
    # Max number of threads to cap factor-based parallelism number to
    parallelism-max = 16
  }
  # Throughput defines the maximum number of messages to be
  # processed per actor before the thread jumps to the next actor.
  # Set to 1 for as fair as possible.
  throughput = 100
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/current/dispatchers.html" class="bare">https://doc.akka.io/docs/akka/current/dispatchers.html</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://en.wikipedia.org/wiki/CPU_cache#Cache_miss">CPU Cache Miss</a> is a
 failed attempt to read or write a piece of data in the cache,
 which results in a main memory access with much longer latency.
 There are three kinds of cache misses: instruction read miss,
 data read miss, and data write miss.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_running_with_a_default_dispatcher">Lab: Running with a Default Dispatcher</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.dispatchers</code>
locate the <code>DispatcherSpec</code> and go to the specification in "Case 1:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> This test runs with a <code>BlockingActor</code> and a <code>PrintActor</code>. Review the code in <em>src/main/scala</em></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Case 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_running_with_a_default_dispatcher_and_a_future">Lab: Running with a Default Dispatcher and a Future</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.dispatchers</code>
locate the <code>DispatcherSpec</code> and go to the specification in "Case 2:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> This test runs with a <code>BlockingFutureActor</code> and a <code>PrintActor</code>. Review the code in <em>src/main/scala</em>.
 Notice the <code>executionContext</code> in <code>BlockingFutureActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Case 2:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_running_with_different_dispatchers">Lab: Running with different dispatchers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.dispatchers</code>
locate the <code>DispatcherSpec</code> and go to the specification in "Case 3:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> This test runs with a <code>SeparateDispatcherFutureActor</code> and a <code>PrintActor</code>. Review the code in <em>src/main/scala</em>.
 Notice the <code>executionContext</code> in <code>SeparateDispatcherFutureActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.FaultToleranceSpec -- -z &quot;Case 3:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_mailboxes">Mailboxes</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_mailboxes_2">Mailboxes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An Akka Mailbox holds the messages that are destined for an <code>Actor</code>.</p>
</li>
<li>
<p>Normally each Actor has its own mailbox</p>
</li>
<li>
<p>Can be customized using for example a <code>BalancingPool</code> where all routees will share a single mailbox instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_in_mailbox_types">Built In Mailbox Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Akka comes shipped with a number of mailbox implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>UnboundedMailbox</code> – The default mailbox</p>
<div class="ulist">
<ul>
<li>
<p>Backed by a java.util.concurrent.ConcurrentLinkedQueue</p>
</li>
<li>
<p>Blocking: No</p>
</li>
<li>
<p>Bounded: No</p>
</li>
<li>
<p>Configuration name: <code>unbounded</code> or <code>akka.dispatch.UnboundedMailbox</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>SingleConsumerOnlyUnboundedMailbox</code></p>
<div class="ulist">
<ul>
<li>
<p>Backed by a very efficient Multiple Producer Single Consumer queue, cannot be used with <code>BalancingDispatcher</code></p>
</li>
<li>
<p>Blocking: No</p>
</li>
<li>
<p>Bounded: No</p>
</li>
<li>
<p>Configuration name: <code>akka.dispatch.SingleConsumerOnlyUnboundedMailbox</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_in_mailbox_types_continued">Built In Mailbox Types (Continued)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>BoundedMailbox</code></p>
<div class="ulist">
<ul>
<li>
<p>Backed by a <code>java.util.concurrent.LinkedBlockingQueue</code></p>
</li>
<li>
<p>Blocking: Yes</p>
</li>
<li>
<p>Bounded: Yes</p>
</li>
<li>
<p>Configuration name: “bounded” or “akka.dispatch.BoundedMailbox”</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>UnboundedPriorityMailbox</code></p>
<div class="ulist">
<ul>
<li>
<p>Backed by a <code>java.util.concurrent.PriorityBlockingQueue</code></p>
</li>
<li>
<p>Blocking: Yes</p>
</li>
<li>
<p>Bounded: No</p>
</li>
<li>
<p>Configuration name: <code>akka.dispatch.UnboundedPriorityMailbox</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_in_mailbox_types_continued_2">Built In Mailbox Types (Continued)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>BoundedPriorityMailbox</code></p>
<div class="ulist">
<ul>
<li>
<p>Backed by a <code>java.util.PriorityBlockingQueue</code> wrapped in an <code>akka.util.BoundedBlockingQueue</code></p>
</li>
<li>
<p>Blocking: Yes</p>
</li>
<li>
<p>Bounded: Yes</p>
</li>
<li>
<p>Configuration name: <code>akka.dispatch.BoundedPriorityMailbox</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requiring_a_mailbox_per_dispatcher">Requiring a mailbox per dispatcher</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For whatever dispatcher is configured a mailbox can be set</p>
</li>
<li>
<p>This requires a <code>mailbox-requirement</code> per dispatcher</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">my</span><span class="tok-o">-</span><span class="tok-n">dispatcher</span> <span class="tok-o">{</span>
  <span class="tok-n">mailbox</span><span class="tok-o">-</span><span class="tok-n">requirement</span> <span class="tok-k">=</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-n">example</span><span class="tok-o">.</span><span class="tok-nc">MyInterface</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_a_default_mailbox_type">Specifying a default mailbox type</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To select a default mailbox, you can configure that at <code>akka.actor.default-mailbox</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">actor</span><span class="tok-o">.</span><span class="tok-n">default</span><span class="tok-o">-</span><span class="tok-n">mailbox</span> <span class="tok-o">{</span>
  <span class="tok-n">mailbox</span><span class="tok-o">-</span><span class="tok-k">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;akka.dispatch.SingleConsumerOnlyUnboundedMailbox&quot;</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_a_mailbox_per_actor">Specifying a mailbox per actor</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Inside the <em>application.conf</em></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>non-blocking-bounded {
   mailbox-type = &quot;akka.dispatch.NonBlockingBoundedMailbox&quot;
   mailbox-capacity = 10
}

akka.actor.deployment {
   /myActor {
      mailbox = non-blocking-bounded
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">When creating the actor</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Props</span>
<span class="tok-k">val</span> <span class="tok-n">myActor</span> <span class="tok-k">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">MyActor</span><span class="tok-o">],</span> <span class="tok-s">&quot;myActor&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_a_mailbox_per_actor_alternative">Specifying a mailbox per actor, alternative</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">Inside the <em>application.conf</em></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="hocon"><span></span>non-blocking-bounded {
   mailbox-type = &quot;akka.dispatch.NonBlockingBoundedMailbox&quot;
   mailbox-capacity = 10
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In the following we call <code>withMailbox</code> from the <code>Props</code> to specify mailbox</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">When creating the actor</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.actor.Props</span>
<span class="tok-k">val</span> <span class="tok-n">props</span> <span class="tok-k">=</span> <span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">MyActor</span><span class="tok-o">].</span><span class="tok-n">withMailbox</span><span class="tok-o">(</span><span class="tok-s">&quot;non-blocking-bounded&quot;</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">myActor</span> <span class="tok-k">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-n">props</span><span class="tok-o">,</span> <span class="tok-s">&quot;myActor&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_code_mailbox_code_semantics_per_actor">Specifying <code>mailbox</code> semantics per actor</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>First specify what kind of Message Queue an <code>Actor</code> will require</p>
</li>
<li>
<p>Basic configurations are located in <code>akka.dispatch</code> and <code>Mailbox</code></p>
</li>
<li>
<p>These are just marker <code>trait</code> that certain <code>Mailboxes</code> will specify</p>
</li>
<li>
<p>This is a way to demand that an <code>Actor</code> always has a certain mailbox</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><code>MyBoundedActor</code> demands <code>BoundedMessageQueueSemantics</code></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">akka.dispatch.RequiresMessageQueue</span>
<span class="tok-k">import</span> <span class="tok-nn">akka.dispatch.BoundedMessageQueueSemantics</span>

<span class="tok-k">class</span> <span class="tok-nc">MyBoundedActor</span> <span class="tok-k">extends</span> <span class="tok-nc">MyActor</span>
  <span class="tok-k">with</span> <span class="tok-nc">RequiresMessageQueue</span><span class="tok-o">[</span><span class="tok-kt">BoundedMessageQueueSemantics</span><span class="tok-o">]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_seeking_the_right_implementation">Seeking the right implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some implementations, consulting the Akka API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BoundedControlAwareMailbox.MessageQueue</code></p>
</li>
<li>
<p><code>BoundedDequeBasedMailbox.MessageQueue</code></p>
</li>
<li>
<p><code>BoundedMailbox.MessageQueue</code></p>
</li>
<li>
<p><code>BoundedNodeMessageQueue</code></p>
</li>
<li>
<p><code>BoundedPriorityMailbox.MessageQueue</code></p>
</li>
<li>
<p><code>BoundedStablePriorityMailbox.MessageQueue</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://doc.akka.io/japi/akka/current/akka/dispatch/BoundedMessageQueueSemantics.html" class="bare">https://doc.akka.io/japi/akka/current/akka/dispatch/BoundedMessageQueueSemantics.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping_the_mailbox_semantics_in_em_application_conf_em">Mapping the mailbox semantics in <em>application.conf</em></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">bounded</span><span class="tok-o">-</span><span class="tok-n">mailbox</span> <span class="tok-o">{</span>
  <span class="tok-n">mailbox</span><span class="tok-o">-</span><span class="tok-k">type</span> <span class="tok-o">=</span> <span class="tok-s">&quot;akka.dispatch.NonBlockingBoundedMailbox&quot;</span>
  <span class="tok-n">mailbox</span><span class="tok-o">-</span><span class="tok-n">capacity</span> <span class="tok-k">=</span> <span class="tok-mi">1000</span>
<span class="tok-o">}</span>

<span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">actor</span><span class="tok-o">.</span><span class="tok-n">mailbox</span><span class="tok-o">.</span><span class="tok-n">requirements</span> <span class="tok-o">{</span>
  <span class="tok-s">&quot;akka.dispatch.BoundedMessageQueueSemantics&quot;</span> <span class="tok-k">=</span> <span class="tok-n">bounded</span><span class="tok-o">-</span><span class="tok-n">mailbox</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_mailboxes_are_resolved">How Mailboxes are resolved</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Prioritization how mailboxes are resolved:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the actor’s deployment configuration section contains a <code>mailbox</code> key then
that names a <code>configuration</code> section describing the mailbox type to be used.</p>
</li>
<li>
<p>If the actor’s <code>Props</code> contains a mailbox selection—i.e. <code>withMailbox</code> was called on it
— then that names a configuration section describing the mailbox type
  to be used (note that this needs to be an absolute <code>config</code> path,
  for example <code>myapp.special-mailbox</code>,
     and is not nested inside the <code>akka</code> namespace).</p>
</li>
<li>
<p>If the dispatcher’s configuration section contains a <code>mailbox-type</code> key the same section
will be used to configure the mailbox type.</p>
</li>
<li>
<p>If the actor requires a <code>mailbox</code> type as described using semantic mapping
for that requirement will be used to determine the mailbox type
    to be used; if that fails then the dispatcher’s requirement—if any—will be tried instead.</p>
</li>
<li>
<p>If the dispatcher requires a mailbox type as described  then the mapping for that requirement will be
used to determine the mailbox type to be used.</p>
</li>
<li>
<p>The default mailbox <code>akka.actor.default-mailbox</code> will be used.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/2.5/mailboxes.html" class="bare">https://doc.akka.io/docs/akka/2.5/mailboxes.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_view_the_default_behavior_of_a_mailbox">Lab: View the default behavior of a mailbox</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>
locate the <code>MailboxSpec</code> and go to the specification in "Case 1:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> "Case 1:" Runs an <code>Actor</code> using the default mailbox</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.MailboxesSpec -- -z &quot;Case 1:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_run_a_custom_mailbox_using_em_application_conf_em">Lab: Run a custom mailbox using <em>application.conf</em></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>
locate the <code>MailboxSpec</code> and go to the specification in "Case 2:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> "Case 2:" Runs an <code>Actor</code> using a mapping in the <em>application.conf</em>.  Look for the
configuration <code>custom-mailbox-akka</code> and see how it is mapped to <code>mailboxActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.MailboxesSpec -- -z &quot;Case 2:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_run_a_custom_mailbox_using_directly_using_em_application_conf_em">Lab: Run a custom mailbox using directly using <em>application.conf</em></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>
locate the <code>MailboxSpec</code> and go to the specification in "Case 3:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> "Case 3:" Runs an <code>Actor</code> using a mapping in the <em>application.conf</em>.  Look for the
configuration <code>custom-mailbox-akka</code>. Only this time notice how we are not mapping directly to the actor name
in <em>application.conf</em> but when we create the <code>Actor</code>.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.MailboxesSpec -- -z &quot;Case 3:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_run_an_code_actor_code_with_a_semantic_constraint">Lab: Run an <code>Actor</code> with a semantic constraint</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>
locate the <code>MailboxSpec</code> and go to the specification in "Case 4:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> "Case 4:" Runs an <code>Actor</code> that has a semantic constraint. It uses a mapping in the <em>application.conf</em>.  Look for the
configuration <code>custom-priority-mailbox-akka</code> in the <em>application.conf</em>. Noticed that we are defining an implementation for
 the semantic requirement: <code>akka.dispatch.BoundedMessageQueueSemantics</code> which is tied to the declaration for <code>non-blocking bounded</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>, open <code>MailboxWithRequirementActor</code> and
noticed the requirements <code>trait</code> with RequiresMessageQueue[BoundedMessageQueueSemantics] and match it with the mapping in
the <em>application.conf</em> in Step 2.</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.MailboxesSpec -- -z &quot;Case 4:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Notice the behavior</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_run_a_custom_code_mailbox_code">Lab: Run a custom <code>Mailbox</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/test/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>
locate the <code>MailboxSpec</code> and go to the specification in "Case 5:&#8230;&#8203;"</p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> "Case 5:" Uses a custom mailbox, where it is configured in configuration <code>"custom-priority-mailbox-akka"</code>.
In this case the mailbox used is <code>"custom-priority-mailbox"</code> where it will give messages with the <code>Symbol</code> <code>'highpriority</code> first.</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.mailboxes</code>,
locate <code>MyPriorityMailbox</code> and see how it is implemented</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Run the test in either your IDE or in SBT using the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; testOnly com.akkatraining.scala.faulttolerance.MailboxesSpec -- -z &quot;Case 5:&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Notice the behavior</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_remoting">Remoting</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_about_remoting">About Remoting</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>When sending messages to actors you do not need to know whether it is on the local machine or remote</p>
</li>
<li>
<p>This is referred to as <em>location transparency</em></p>
</li>
<li>
<p>Remoting will:</p>
<div class="ulist">
<ul>
<li>
<p>Serialize and Deserialize messages</p>
</li>
<li>
<p>Send over the network</p>
</li>
</ul>
</div>
</li>
<li>
<p>Akka will take care of the mechanics for us</p>
</li>
<li>
<p>Discovery is only available to clustering</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serialization">Serialization</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Serialization is pluggable</p>
</li>
<li>
<p>Java Serialization is often times slow</p>
</li>
<li>
<p>May need to swapped out for better options</p>
<div class="ulist">
<ul>
<li>
<p>Protocol Buffers</p>
</li>
<li>
<p>Kryo</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_remoting_setup">Remoting Setup</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Remoting Setup is done by</p>
<div class="ulist">
<ul>
<li>
<p>Configuration</p>
</li>
<li>
<p>Programmatic</p>
</li>
</ul>
</div>
</li>
<li>
<p>We require the dependency in SBT (or your preferrable build tool)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>libraryDependencies += &quot;com.typesafe.akka&quot; % &quot;akka-remote_2.12&quot; % &quot;2.5.13&quot;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_location_transparency_2">Location Transparency</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Vertical and Horizontal Growth</p>
</li>
<li>
<p>Horizontal Growth driven by Remoting systems</p>
</li>
<li>
<p>Vertical Growth driven by routers</p>
</li>
<li>
<p>All configuration based</p>
</li>
<li>
<p>Be able to perform calculations without being concerned about the location</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_establishing_remoting">Establishing Remoting</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span> <span class="tok-o">{</span>
  <span class="tok-n">actor</span> <span class="tok-o">{</span>
    <span class="tok-n">provider</span> <span class="tok-k">=</span> <span class="tok-n">remote</span>
  <span class="tok-o">}</span>
  <span class="tok-n">remote</span> <span class="tok-o">{</span>
    <span class="tok-n">enabled</span><span class="tok-o">-</span><span class="tok-n">transports</span> <span class="tok-k">=</span> <span class="tok-o">[</span><span class="tok-err">&quot;</span><span class="tok-kt">akka.remote.netty.tcp</span><span class="tok-err">&quot;</span><span class="tok-o">]</span>
    <span class="tok-n">netty</span><span class="tok-o">.</span><span class="tok-n">tcp</span> <span class="tok-o">{</span>
      <span class="tok-n">hostname</span> <span class="tok-k">=</span> <span class="tok-s">&quot;127.0.0.1&quot;</span>
      <span class="tok-n">port</span> <span class="tok-k">=</span> <span class="tok-mi">2552</span>
    <span class="tok-o">}</span>
 <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Change <code>provider</code> from <code>local</code> to <code>remote</code></p>
</li>
<li>
<p>Add a <code>hostname</code>, it must be identifiable on the network</p>
</li>
<li>
<p>Add a port number</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_types_of_remoting_interaction">Types of remoting interaction</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Lookup</strong> - Lookup actors remotely with interaction <code>actorSelection(path)</code></p>
</li>
<li>
<p><strong>Creation</strong> - Create actors remotely with interaction <code>actorOf(Props(&#8230;&#8203;))</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_looking_up_remote_actors">Looking up Remote Actors</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">selection</span> <span class="tok-k">=</span>
  <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorSelection</span><span class="tok-o">(</span><span class="tok-s">&quot;akka.tcp://actorSystemName@10.0.0.1:2552/user/actorName&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Once obtained, you can send information to that <code>Actor</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">selection</span> <span class="tok-o">!</span> <span class="tok-s">&quot;Pretty awesome feature&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_an_actor_remotely">Create an actor remotely</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>An <code>Actor</code> can also be created on another machine as well</p>
</li>
<li>
<p>Amend your <em>application.conf</em> and add under <code>akka.actor.deployment</code> what
seems to be a local address but mapped to a remote location</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span> <span class="tok-o">{</span>
  <span class="tok-n">actor</span> <span class="tok-o">{</span>
    <span class="tok-n">deployment</span> <span class="tok-o">{</span>
      <span class="tok-o">/</span><span class="tok-n">sampleActor</span> <span class="tok-o">{</span>
        <span class="tok-n">remote</span> <span class="tok-k">=</span> <span class="tok-s">&quot;akka.tcp://sampleActorSystem@127.0.0.1:2553&quot;</span>
      <span class="tok-o">}</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">actor</span> <span class="tok-k">=</span> <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">SampleActor</span><span class="tok-o">],</span> <span class="tok-s">&quot;sampleActor&quot;</span><span class="tok-o">)</span>
<span class="tok-n">actor</span> <span class="tok-o">!</span> <span class="tok-s">&quot;Pretty slick&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_remote_deployment_whitelist">Remote Deployment Whitelist</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You can specify which actors can deployed on an akka system by specifying a white</p>
</li>
<li>
<p><em>Remote Deployment is not remote class loading</em></p>
</li>
<li>
<p>Classes would need to exist on the Akka instance</p>
</li>
<li>
<p>To enable, set <code>akka.remote.deployment.enable-whitelist</code> to <code>on</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">remote</span><span class="tok-o">.</span><span class="tok-n">deployment</span> <span class="tok-o">{</span>
  <span class="tok-n">enable</span><span class="tok-o">-</span><span class="tok-n">whitelist</span> <span class="tok-k">=</span> <span class="tok-n">on</span>

  <span class="tok-n">whitelist</span> <span class="tok-k">=</span> <span class="tok-o">[</span>
    <span class="tok-err">&quot;</span><span class="tok-kt">com.xyzcorp.MyActor</span><span class="tok-err">&quot;</span>
  <span class="tok-o">]</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_failure_detection_model">Failure Detection Model</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/association_lifecycle.png" alt="association lifecycle">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description_of_the_detection_model">Description of the Detection Model</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Idle</code> - Initial State</p>
</li>
<li>
<p><code>Active</code></p>
<div class="ulist">
<ul>
<li>
<p>The first time a message is attempted to be sent to the remote system</p>
</li>
<li>
<p>Or an inbound connection is accepted</p>
</li>
<li>
<p>No failures</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Gated</code></p>
<div class="ulist">
<ul>
<li>
<p>Communication failure happens and the connection is lost between the two systems</p>
</li>
<li>
<p>The amount of retries before switching back to <code>Idle</code> is done <code>akka.remote.retry-gate-closed-for</code></p>
</li>
<li>
<p>If successful, then it goes back to <code>Active</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Quarantined</code></p>
<div class="ulist">
<ul>
<li>
<p>Used for unrecoverable failures</p>
</li>
<li>
<p>Permanent until system is back</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_remoting_in_akka">Lab: Creating Remoting in Akka</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create two actors inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.remoting</code> called <code>ActorA</code> and <code>ActorB</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>ActorA</code> and <code>ActorB</code>, print <code>log.info</code> everything</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Inside of <em>application.conf</em>, create a configuration called <code>remote-a</code> that connects to port <code>2551</code></p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Inside of <em>application.conf</em>, create a configuration called <code>remote-b</code> that connects to port <code>2552</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_remoting_in_akka_continued">Lab: Creating Remoting in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create a Runnable <code>object</code>
of <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.remoting</code>
called <code>RemoteARunner</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In <code>RemoteARunner</code>, load the <code>remote-a</code> configuration with a fallback to <code>ConfigFactory.load()</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Create an <code>actorSystem</code> with the custom configuration</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Run the server in either your IDE or using SBT</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-n">run</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Do not create <code>ActorA</code> onto this system
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_remoting_in_akka_continued_2">Lab: Creating Remoting in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create a Runnable <code>object</code>
of <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.remoting</code>
called <code>RemoteBRunner</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In <code>RemoteBRunner</code>, load the <code>remote-b</code> configuration with a fallback to <code>ConfigFactory.load()</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Create an <code>actorSystem</code> with the custom configuration</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Run the server in either your IDE or using SBT</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-n">run</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Do not create <code>ActorB</code> onto this system
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_remoting_in_akka_continued_3">Lab: Creating Remoting in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, go to <em>application.conf</em> create a configuration
called <code>remote-client</code> that uses remoting and connects to port <code>2553</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In <em>application.conf</em>, and in the <code>remote-client</code> configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>map <code>akka.actor.deployment</code> for <code>/actorA</code> to <code>remote-a</code> ip-address and port associated</p>
</li>
<li>
<p>map <code>akka.actor.deployment</code> for <code>/actorB</code> to <code>remote-b</code> ip-address and port associated</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Create a Runnable <code>object</code> in <em>src/main/scala</em> and in the
package <code>com.akkatraining.scala.remoting</code> called <code>RemoteClientRunner</code></p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> In <code>RemoteClientRunner</code>, load the <code>remote-client</code> configuration with a fallback to <code>ConfigFactory.load()</code></p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Create an <code>actorSystem</code> with the custom configuration</p>
</div>
<div class="paragraph">
<p><strong>Step 6:</strong> Send messages to both <code>actorA</code> and <code>actorB</code> and notice the message on each of the terminals</p>
</div>
<div class="paragraph">
<p><strong>Step 7:</strong> Place code that shuts down the <code>ActorSystem</code> with <code>Press Enter to terminate</code> behavior</p>
</div>
<div class="paragraph">
<p><strong>Step 8:</strong> Run the server in either your IDE or using SBT</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-n">run</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_routers">Routers</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_about_routers">About Routers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Actor that reroutes message to other actors</p>
</li>
<li>
<p>Different Strategies available</p>
</li>
<li>
<p>Create your own programmatically</p>
</li>
<li>
<p>A Router to the sender is just an <code>ActorRef</code></p>
</li>
<li>
<p>A Router will just distribute to routees</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_out_of_the_box_routers">Out of the Box Routers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>RoundRobinRoutingLogic</code></p>
<div class="ulist">
<ul>
<li>
<p>Round Robin Distribution</p>
</li>
<li>
<p>Chooses either number of Routees <strong>or</strong> a list of Routees <strong>not both</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>RandomRoutingLogic</code></p>
<div class="ulist">
<ul>
<li>
<p>Chooses a routee randomly</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>SmallestMailboxRouter</code></p>
<div class="ulist">
<ul>
<li>
<p>Chooses non-suspended routee with the least messages in its mailbox</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>BroadcastRouter</code></p>
<div class="ulist">
<ul>
<li>
<p>Sends messages to all the routees!</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_out_of_the_box_routers_continued">Out of the Box Routers (Continued)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>ScatterGatherFirstCompletedRouter</code></p>
<div class="ulist">
<ul>
<li>
<p>Sends messages to all routees, gets a <code>Future</code>,</p>
</li>
<li>
<p>Whichever routee responds first, that reponse will be sent to the <code>sender()</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>ConsistentHashingRouter</code></p>
<div class="ulist">
<ul>
<li>
<p>Consistent Hashing</p>
</li>
<li>
<p>Special type of map where remapping of keys is limited</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_programmatic_router">Programmatic Router</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">Master</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span> <span class="tok-o">{</span>
  <span class="tok-k">var</span> <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">routees</span> <span class="tok-k">=</span> <span class="tok-nc">Vector</span><span class="tok-o">.</span><span class="tok-n">fill</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">val</span> <span class="tok-n">r</span> <span class="tok-k">=</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">Worker</span><span class="tok-o">])</span>
      <span class="tok-n">context</span> <span class="tok-n">watch</span> <span class="tok-n">r</span>
      <span class="tok-nc">ActorRefRoutee</span><span class="tok-o">(</span><span class="tok-n">r</span><span class="tok-o">)</span>
    <span class="tok-o">}</span>
    <span class="tok-nc">Router</span><span class="tok-o">(</span><span class="tok-nc">RoundRobinRoutingLogic</span><span class="tok-o">(),</span> <span class="tok-n">routees</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>

  <span class="tok-k">def</span> <span class="tok-n">receive</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-k">case</span> <span class="tok-n">w</span><span class="tok-k">:</span> <span class="tok-kt">Work</span> <span class="tok-o">⇒</span>
      <span class="tok-n">router</span><span class="tok-o">.</span><span class="tok-n">route</span><span class="tok-o">(</span><span class="tok-n">w</span><span class="tok-o">,</span> <span class="tok-n">sender</span><span class="tok-o">())</span>
    <span class="tok-k">case</span> <span class="tok-nc">Terminated</span><span class="tok-o">(</span><span class="tok-n">a</span><span class="tok-o">)</span> <span class="tok-k">⇒</span>
      <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">router</span><span class="tok-o">.</span><span class="tok-n">removeRoutee</span><span class="tok-o">(</span><span class="tok-n">a</span><span class="tok-o">)</span>
      <span class="tok-k">val</span> <span class="tok-n">r</span> <span class="tok-k">=</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">Worker</span><span class="tok-o">])</span>
      <span class="tok-n">context</span> <span class="tok-n">watch</span> <span class="tok-n">r</span>
      <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">router</span><span class="tok-o">.</span><span class="tok-n">addRoutee</span><span class="tok-o">(</span><span class="tok-n">r</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/current/routing.html#a-simple-router" class="bare">https://doc.akka.io/docs/akka/current/routing.html#a-simple-router</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_different_router_strategies">Different Router Strategies</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Pool</p>
<div class="ulist">
<ul>
<li>
<p>The router creates <code>routees</code> as child actors</p>
</li>
<li>
<p>Removes them from the router if they terminate.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Group</p>
<div class="ulist">
<ul>
<li>
<p>The routee actors are created externally to the router</p>
</li>
<li>
<p>Router sends messages to the specified path using actor selection</p>
</li>
<li>
<p>Does not watch for termination.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_external_configuration_from_em_application_conf_em">Using external configuration from <em>application.conf</em></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The settings for a router actor can be defined in configuration or programmatically.</p>
</li>
<li>
<p>To make use of an externally configurable router the <code>FromConfig</code> props wrapper must be used</p>
</li>
<li>
<p>If the props of an actor is <strong><em>not</em></strong> wrapped in <code>FromConfig</code> it will ignore the router section of the deployment configuration.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pool_configuration">Pool Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The following creates a round-robin router</p>
</li>
<li>
<p>Sent to 5 workers</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Setting up the router</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">actor</span><span class="tok-o">.</span><span class="tok-n">deployment</span> <span class="tok-o">{</span>
  <span class="tok-o">/</span><span class="tok-n">parent</span><span class="tok-o">/</span><span class="tok-n">router1</span> <span class="tok-o">{</span>
    <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">round</span><span class="tok-o">-</span><span class="tok-n">robin</span><span class="tok-o">-</span><span class="tok-n">pool</span>
    <span class="tok-n">nr</span><span class="tok-o">-</span><span class="tok-n">of</span><span class="tok-o">-</span><span class="tok-n">instances</span> <span class="tok-k">=</span> <span class="tok-mi">5</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Using the router</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">router1</span><span class="tok-k">:</span> <span class="tok-kt">ActorRef</span> <span class="tok-o">=</span>
  <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">FromConfig</span><span class="tok-o">.</span><span class="tok-n">props</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">Worker</span><span class="tok-o">]),</span> <span class="tok-s">&quot;router1&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Using a router programmatically</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">router2</span><span class="tok-k">:</span> <span class="tok-kt">ActorRef</span> <span class="tok-o">=</span>
  <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">RoundRobinPool</span><span class="tok-o">(</span><span class="tok-mi">5</span><span class="tok-o">).</span><span class="tok-n">props</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">Worker</span><span class="tok-o">]),</span> <span class="tok-s">&quot;router2&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_problem_with_code_sender_code">The problem with <code>sender</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>When a routee sends a message, it will implicitly <em>set itself</em> as the <code>sender</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">sender</span><span class="tok-o">()</span> <span class="tok-o">!</span> <span class="tok-n">x</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Since the <code>parent</code> is the parent of all routees, send the <code>parent</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">sender</span><span class="tok-o">().</span><span class="tok-n">tell</span><span class="tok-o">(</span><span class="tok-s">&quot;reply&quot;</span><span class="tok-o">,</span> <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">parent</span><span class="tok-o">)</span>
<span class="tok-n">sender</span><span class="tok-o">().!(</span><span class="tok-s">&quot;reply&quot;</span><span class="tok-o">)(</span><span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">parent</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supervision_of_a_router">Supervision of a router</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Routees that are created by a <em>pool router</em> will be created as the router’s children</p>
</li>
<li>
<p>The router is therefore also the children’s supervisor</p>
</li>
<li>
<p>The supervision strategy of the router actor can be configured with the <code>supervisorStrategy</code> property of the Pool</p>
</li>
<li>
<p>If no configuration is provided, routers default to a strategy of <strong><em>always escalate</em></strong></p>
</li>
<li>
<p>This means that errors are passed up to the router’s supervisor for handling</p>
</li>
<li>
<p>The router’s supervisor will decide what to do about any errors</p>
</li>
<li>
<p>This means that without a supervisor strategy, both router and routee have the same fate</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_a_supervisor_strategy_for_a_routee">Setting a Supervisor Strategy for a routee</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span>
<span class="tok-k">val</span> <span class="tok-n">escalator</span> <span class="tok-k">=</span> <span class="tok-nc">OneForOneStrategy</span><span class="tok-o">(...)</span> <span class="tok-o">{</span>
  <span class="tok-k">case</span> <span class="tok-n">e</span><span class="tok-k">:</span><span class="tok-kt">IllegalArgumentException</span>
           <span class="tok-k">⇒</span> <span class="tok-nc">SupervisorStrategy</span><span class="tok-o">.</span><span class="tok-nc">Escalate</span>
<span class="tok-o">}</span>
<span class="tok-k">val</span> <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span>
      <span class="tok-nc">RoundRobinPool</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-n">supervisorStrategy</span> <span class="tok-k">=</span> <span class="tok-n">escalator</span><span class="tok-o">)</span>
        <span class="tok-o">.</span><span class="tok-n">props</span><span class="tok-o">(</span><span class="tok-n">routeeProps</span> <span class="tok-k">=</span> <span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">MyActor</span><span class="tok-o">]))</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_group_routees_via_configuration">Group Routees Via Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You create the routees and you feed them to the <code>Router</code></p>
</li>
<li>
<p>Messages will be sent to <code>actorSelection</code></p>
</li>
<li>
<p>For example, the following routees have been pre-created</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Establishing the Routees</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">akka</span><span class="tok-o">.</span><span class="tok-n">actor</span><span class="tok-o">.</span><span class="tok-n">deployment</span> <span class="tok-o">{</span>
  <span class="tok-o">/</span><span class="tok-n">parent</span><span class="tok-o">/</span><span class="tok-n">router3</span> <span class="tok-o">{</span>
    <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">round</span><span class="tok-o">-</span><span class="tok-n">robin</span><span class="tok-o">-</span><span class="tok-n">group</span>
    <span class="tok-n">routees</span><span class="tok-o">.</span><span class="tok-n">paths</span> <span class="tok-k">=</span> <span class="tok-o">[</span><span class="tok-err">&quot;</span><span class="tok-kt">/user/workers/w1</span><span class="tok-err">&quot;</span>,
                     <span class="tok-err">&quot;</span><span class="tok-kt">/user/workers/w2</span><span class="tok-err">&quot;</span>,
                     <span class="tok-err">&quot;</span><span class="tok-kt">/user/workers/w3</span><span class="tok-err">&quot;</span><span class="tok-o">]</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Calling the routees</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">router3</span><span class="tok-k">:</span> <span class="tok-kt">ActorRef</span> <span class="tok-o">=</span>
  <span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">FromConfig</span><span class="tok-o">.</span><span class="tok-n">props</span><span class="tok-o">(),</span> <span class="tok-s">&quot;router3&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_group_routees_via_programmatic_configuration">Group Routees Via Programmatic Configuration</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span>
    <span class="tok-nc">RoundRobinGroup</span><span class="tok-o">(</span><span class="tok-nc">List</span><span class="tok-o">(</span><span class="tok-s">&quot;/user/routee1&quot;</span><span class="tok-o">,</span>
                         <span class="tok-s">&quot; user/routee2&quot;</span><span class="tok-o">)).</span><span class="tok-n">props</span><span class="tok-o">(),</span>
                    <span class="tok-s">&quot;router4&quot;</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_router_in_akka">Lab: Creating a router in Akka</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.router</code> called <code>WorkerActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In <code>WorkerActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the message received is the <code>String</code> <code>"terminate"</code>, stop the actor</p>
</li>
<li>
<p>If the message received is any other <code>String</code> <code>"terminate"</code>, stop the actor</p>
</li>
<li>
<p>If the message is not a <code>String</code>, send it to method <code>unhandled</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_router_in_akka_continued">Lab: Creating a router in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.router</code> called <code>BossActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> In <code>BossActor</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a programmatic <code>RoundRobinPoolLogic</code> router</p>
</li>
<li>
<p>If the message received is a <code>String</code>, then route to any of the programmatic routees</p>
</li>
<li>
<p>If the message received is a <code>Terminated</code> object, remove the <code>routee</code> and add a replacement</p>
</li>
<li>
<p>Decide on logging which will help you</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_router_in_akka_continued_2">Lab: Creating a router in Akka (Continued)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create a runnable <code>object</code> inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.router</code> called <code>RouterRunner</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Create an <code>actorSystem</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Import the <code>actorSystem</code> dispatcher</p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Create the <code>BossActor</code> inside of <code>ActorSystem</code> and obtain an <code>ActorRef</code> to it</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Create a <code>scheduler</code> that sends a message every 50 milliseconds. Be sure to obtain the
<code>Cancellable</code> instance so you can cancel after you hit <strong><em>ENTER</em></strong>.  Send the current date and time
using <code>java.time.LocalDateTime.now()</code></p>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Place code that will listen to the user&#8217;s <code>Press Enter to terminate</code> behavior, this time
cancel the <code>Cancellable</code> from the <code>scheduler</code> and then shut down the <code>actorSystem</code></p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Run the server in either your IDE or using SBT</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-o">&gt;</span> <span class="tok-n">run</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_clustering">Clustering</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_automatic_management_of_membership">Automatic Management of Membership</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Relatively new component to Akka</p>
</li>
<li>
<p>Akka Clustering adds a means to setup remoting over a number of remote systems</p>
</li>
<li>
<p>Offers:</p>
<div class="ulist">
<ul>
<li>
<p>Location independence and transparency, even more so!</p>
</li>
<li>
<p>Actors communicate with one another, across the cluster</p>
</li>
<li>
<p>Addressing where actors believe that they are on the same cohesive system</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_clustering">Before Clustering</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Akka Actors needed some remote addressing to send information</p>
</li>
<li>
<p>At times not truly as transparent as conceived</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_clustering_communication">Akka Clustering Communication</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To message to a cluster, one node only needs access to <em>seed nodes</em></p>
</li>
<li>
<p>Seed nodes are specially designed node that can be used to
connect to a cluster by new nodes</p>
</li>
<li>
<p>Recommended you have more than one seed node</p>
</li>
<li>
<p>As long as one of the seed nodes is available you can join</p>
</li>
<li>
<p>No special code is required, configuration informs the location of the seed nodes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_new_node_lifecycle">New Node Lifecycle</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>New node then goes through a series of lifecycle steps before becoming a member</p>
</li>
<li>
<p>A node can either</p>
<div class="ulist">
<ul>
<li>
<p>Start new actors in its own <code>ActorSystem</code></p>
</li>
<li>
<p>Start new actors in another node in the cluster</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><em>The Cluster</em></strong> becomes a single virtual actor system.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gossiping_and_convergence">Gossiping and Convergence</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <em>gossip</em> protocol</p>
<div class="ulist">
<ul>
<li>
<p>Is used to send messages to one another</p>
</li>
<li>
<p>Random peers communicate what information they have about cluster membership</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Convergence</em></p>
<div class="ulist">
<ul>
<li>
<p>Once the gossiping is done</p>
</li>
<li>
<p>When every node knows the membership structure of the cluster</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vector_clocks">Vector Clocks</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A data structure and algorithm</p>
</li>
<li>
<p>Used to detect causality violations</p>
</li>
<li>
<p>Updates using (node, counter) tuples</p>
</li>
<li>
<p>Each update has an accompanying update to the vector clock</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clustering_dependency">Clustering Dependency</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>"com.typesafe.akka" %% "akka-cluster" % "2.5.5"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terms">Terms</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>node</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A logical member of a cluster. There could be multiple nodes on a physical machine. Defined by a hostname:port:uid tuple.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cluster</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A set of nodes joined together through the membership service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>leader</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A single node in the cluster that acts as the leader. A leader manages cluster
  convergence and membership state transitions.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_node_identifiers">Node identifiers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Nodes are addressed by <code>hostname:port:uid</code> tuple</p>
</li>
<li>
<p>Any node doesn&#8217;t necessary have to house any actors</p>
</li>
<li>
<p>Joining a clustered is done by issuing a <code>Join</code> command</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rejoining_a_cluster">Rejoining a Cluster</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Once an <code>ActorSystem</code> has left a cluster it cannot rejoin without restart</p>
</li>
<li>
<p>Restart provides a new UID</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_setting_up_an_actor_to_use_in_a_cluster">Lab: Setting up an Actor to use in a cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.cluster</code> called <code>SimpleActor</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Inside of <code>SimpleActor</code>, simply log the whatever information comes to it</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Go to the <em>application.conf</em> and review the configuration in the <code>clustering_akka</code> section.
Notice the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>seed-nodes</code> established</p>
</li>
<li>
<p>The deployment of a router in our cluster</p>
</li>
<li>
<p><code>akka.actor.provider</code> is set to <code>cluster</code></p>
</li>
<li>
<p>We are using remoting much in the same way we did in the remoting section</p>
</li>
<li>
<p>We are also enhancing our clusters with the <code>MetricsExtension</code> and the <code>ClusterClientReceptionist</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_code_clusterlistener_code">Lab: Creating a <code>ClusterListener</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create an actor inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.cluster</code> called <code>SimpleClusterListener</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">class</span> <span class="tok-nc">SimpleClusterListener</span> <span class="tok-k">extends</span> <span class="tok-nc">Actor</span> <span class="tok-k">with</span> <span class="tok-nc">ActorLogging</span> <span class="tok-o">{</span>

    <span class="tok-k">val</span> <span class="tok-n">cluster</span> <span class="tok-k">=</span> <span class="tok-nc">Cluster</span><span class="tok-o">(</span><span class="tok-n">context</span><span class="tok-o">.</span><span class="tok-n">system</span><span class="tok-o">)</span>

    <span class="tok-c1">// subscribe to cluster changes, re-subscribe when restart</span>
    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">preStart</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
        <span class="tok-n">cluster</span><span class="tok-o">.</span><span class="tok-n">subscribe</span><span class="tok-o">(</span><span class="tok-n">self</span><span class="tok-o">,</span> <span class="tok-n">initialStateMode</span> <span class="tok-k">=</span> <span class="tok-nc">InitialStateAsEvents</span><span class="tok-o">,</span>
            <span class="tok-n">classOf</span><span class="tok-o">[</span><span class="tok-kt">MemberEvent</span><span class="tok-o">],</span> <span class="tok-n">classOf</span><span class="tok-o">[</span><span class="tok-kt">UnreachableMember</span><span class="tok-o">])</span>
    <span class="tok-o">}</span>
    <span class="tok-k">override</span> <span class="tok-k">def</span> <span class="tok-n">postStop</span><span class="tok-o">()</span><span class="tok-k">:</span> <span class="tok-kt">Unit</span> <span class="tok-o">=</span> <span class="tok-n">cluster</span><span class="tok-o">.</span><span class="tok-n">unsubscribe</span><span class="tok-o">(</span><span class="tok-n">self</span><span class="tok-o">)</span>

    <span class="tok-k">def</span> <span class="tok-n">receive</span><span class="tok-k">:</span> <span class="tok-kt">Receive</span> <span class="tok-o">=</span> <span class="tok-o">{</span>
        <span class="tok-k">case</span> <span class="tok-nc">MemberUp</span><span class="tok-o">(</span><span class="tok-n">member</span><span class="tok-o">)</span> <span class="tok-k">⇒</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Member is Up: {}&quot;</span><span class="tok-o">,</span> <span class="tok-n">member</span><span class="tok-o">.</span><span class="tok-n">address</span><span class="tok-o">)</span>
        <span class="tok-k">case</span> <span class="tok-nc">UnreachableMember</span><span class="tok-o">(</span><span class="tok-n">member</span><span class="tok-o">)</span> <span class="tok-k">⇒</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span><span class="tok-s">&quot;Member detected as unreachable: {}&quot;</span><span class="tok-o">,</span> <span class="tok-n">member</span><span class="tok-o">)</span>
        <span class="tok-k">case</span> <span class="tok-nc">MemberRemoved</span><span class="tok-o">(</span><span class="tok-n">member</span><span class="tok-o">,</span> <span class="tok-n">previousStatus</span><span class="tok-o">)</span> <span class="tok-k">⇒</span>
            <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-o">(</span>
                <span class="tok-s">&quot;Member is Removed: {} after {}&quot;</span><span class="tok-o">,</span>
                <span class="tok-n">member</span><span class="tok-o">.</span><span class="tok-n">address</span><span class="tok-o">,</span> <span class="tok-n">previousStatus</span><span class="tok-o">)</span>
        <span class="tok-k">case</span> <span class="tok-k">_:</span> <span class="tok-kt">MemberEvent</span> <span class="tok-o">⇒</span> <span class="tok-c1">// ignore</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss what this will do&#8230;&#8203;also notice <code>ActorLogging</code> as a way to establish logging</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_starting_our_cluster">Lab: Starting our cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create a Runnable object inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.cluster</code> called <code>SimpleClusterRunner</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">SimpleClusterRunner</span> <span class="tok-k">extends</span> <span class="tok-nc">App</span> <span class="tok-o">{</span>

    <span class="tok-k">val</span> <span class="tok-n">rootConfig</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-o">()</span>
    <span class="tok-k">val</span> <span class="tok-n">seqPorts</span> <span class="tok-k">=</span> <span class="tok-nc">Seq</span><span class="tok-o">(</span><span class="tok-s">&quot;2551&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;2552&quot;</span><span class="tok-o">,</span> <span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">0</span><span class="tok-o">)</span>

    <span class="tok-n">seqPorts</span> <span class="tok-n">foreach</span> <span class="tok-o">{</span> <span class="tok-n">p</span> <span class="tok-k">=&gt;</span>
        <span class="tok-k">val</span> <span class="tok-n">config</span> <span class="tok-k">=</span> <span class="tok-nc">ConfigFactory</span>
            <span class="tok-o">.</span><span class="tok-n">parseString</span><span class="tok-o">(</span><span class="tok-s">s&quot;akka.remote.netty.tcp.port=</span><span class="tok-si">$p</span><span class="tok-s">&quot;</span><span class="tok-o">)</span>
            <span class="tok-o">.</span><span class="tok-n">withFallback</span><span class="tok-o">(</span><span class="tok-n">rootConfig</span><span class="tok-o">....)</span>
        <span class="tok-k">val</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;My-Cluster&quot;</span><span class="tok-o">,</span> <span class="tok-n">config</span><span class="tok-o">)</span>
        <span class="tok-k">val</span> <span class="tok-n">actorRef</span> <span class="tok-k">=</span> <span class="tok-n">actorSystem</span>
            <span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">SimpleClusterListener</span><span class="tok-o">],</span> <span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;clusterListener&quot;</span><span class="tok-o">)</span>
        <span class="tok-k">val</span> <span class="tok-n">router</span> <span class="tok-k">=</span> <span class="tok-n">actorSystem</span>
            <span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span><span class="tok-nc">FromConfig</span><span class="tok-o">.</span><span class="tok-n">props</span><span class="tok-o">(</span><span class="tok-nc">Props</span><span class="tok-o">[</span><span class="tok-kt">SimpleActor</span><span class="tok-o">]),</span> <span class="tok-n">name</span><span class="tok-o">=</span><span class="tok-s">&quot;simpleRouter&quot;</span><span class="tok-o">)</span>
        <span class="tok-nc">ClusterClientReceptionist</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">).</span><span class="tok-n">registerService</span><span class="tok-o">(</span><span class="tok-n">router</span><span class="tok-o">)</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss what we are creating with the following points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All <code>ActorSystem</code> must have the same name</p>
</li>
<li>
<p>We are creating a distributed router with <code>SimpleActor</code></p>
</li>
<li>
<p>We also are establishing a <code>ClusterClientReceptionist</code> and registering the router</p>
</li>
<li>
<p>We are actually running 4 total systems with a different port</p>
</li>
<li>
<p>The first two are mandatory since they are the seeds</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_creating_a_client_to_access_from_the_outside">Lab: Creating a client to access from the outside</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong>  In the project, akka-training, Create a Runnable object inside
of <em>src/main/scala</em> and in
the package <code>com.akkatraining.scala.cluster</code> called <code>ClusterClientRunner</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">ClusterClientRunner</span> <span class="tok-k">extends</span> <span class="tok-nc">App</span> <span class="tok-o">{</span>

    <span class="tok-k">val</span> <span class="tok-n">actorSystem</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;Non-Member-Actor-System&quot;</span><span class="tok-o">)</span>
    <span class="tok-k">val</span> <span class="tok-n">initialContacts</span> <span class="tok-k">=</span> <span class="tok-nc">Set</span><span class="tok-o">(</span>
        <span class="tok-nc">ActorPath</span><span class="tok-o">.</span><span class="tok-n">fromString</span><span class="tok-o">(</span><span class="tok-s">&quot;akka.tcp://My-Cluster@127.0.0.1:2552/system/receptionist&quot;</span><span class="tok-o">),</span>
        <span class="tok-nc">ActorPath</span><span class="tok-o">.</span><span class="tok-n">fromString</span><span class="tok-o">(</span><span class="tok-s">&quot;akka.tcp://My-Cluster@127.0.0.1:2551/system/receptionist&quot;</span><span class="tok-o">))</span>

    <span class="tok-k">val</span> <span class="tok-n">c</span><span class="tok-k">:</span> <span class="tok-kt">ActorRef</span> <span class="tok-o">=</span> <span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">actorOf</span><span class="tok-o">(</span>
        <span class="tok-nc">ClusterClient</span><span class="tok-o">.</span><span class="tok-n">props</span><span class="tok-o">(</span><span class="tok-nc">ClusterClientSettings</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">)</span>
            <span class="tok-o">.</span><span class="tok-n">withInitialContacts</span><span class="tok-o">(</span><span class="tok-n">initialContacts</span><span class="tok-o">)))</span>
    <span class="tok-n">c</span> <span class="tok-o">!</span> <span class="tok-nc">ClusterClient</span><span class="tok-o">.</span><span class="tok-nc">Send</span><span class="tok-o">(</span><span class="tok-s">&quot;/user/simpleRouter&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Hello!&quot;</span><span class="tok-o">,</span> <span class="tok-kc">false</span><span class="tok-o">)</span>

    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Press ENTER to continue&quot;</span><span class="tok-o">)</span>
    <span class="tok-nc">StdIn</span><span class="tok-o">.</span><span class="tok-n">readLine</span><span class="tok-o">()</span>

    <span class="tok-nc">Await</span><span class="tok-o">.</span><span class="tok-n">ready</span><span class="tok-o">(</span><span class="tok-n">actorSystem</span><span class="tok-o">.</span><span class="tok-n">terminate</span><span class="tok-o">(),</span> <span class="tok-mi">10</span> <span class="tok-n">seconds</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss what we are creating with the following points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All <code>ActorSystem</code> has a different name</p>
</li>
<li>
<p>We are sending to the <code>Receptionist</code> that will take the message and find a routee</p>
</li>
<li>
<p><code>c</code> is just an <code>ActorRef</code>, the fine grained mechanics are hidden</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_akka_streams">Akka Streams</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_akka_streams_overview">Akka Streams Overview</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Builds on the idea of flows and flow graphs that define how a stream is processed</p>
</li>
<li>
<p>Streams are built with reusable pieces either:</p>
<div class="ulist">
<ul>
<li>
<p>Prepackaged components</p>
</li>
<li>
<p>Custom made composites</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_between_akka_streams_and_the_reactive_streams_api">Relationship between Akka Streams and the Reactive Streams API</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The scope of Reactive Streams is defining a mechanism to move data across an asynchronous boundary</p>
</li>
<li>
<p>Akka Streams Implementation Uses Reactive Streams Internally</p>
</li>
<li>
<p>Akka Streams API is meant not to expose the Reactive Streams API</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_streams_river_analogy">Akka Streams River Analogy</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/akka_streams_river.png" alt="akka streams river">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_streams_pipe_analogy">Akka Streams Pipe Analogy</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/akka_streams_pipe_analogy.png" alt="akka streams pipe analogy">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_streams_lightening_analogy">Akka Streams Lightening Analogy</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/akka_streams_lightening_analogy.png" alt="akka streams lightening analogy">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_streams_rube_goldberg_analogy">Akka Streams Rube Goldberg Analogy</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/akka_streams_rube_goldberg_analogy.png" alt="akka streams rube goldberg analogy">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_code_source_code">Defining <code>Source</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A Source that accepts a single item</p>
</li>
<li>
<p>In the following example the first element <code>[Int]</code> is the type of element that
this source emits</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/source.png" alt="source">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The second one is some auxiliary value that certain components may add.</p>
</li>
<li>
<p>When no auxiliary value is produced <code>akka.NotUsed</code> is used in its place.</p>
</li>
<li>
<p>The following is an example of a <code>Source</code> that emits one element</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">single</span><span class="tok-k">:</span> <span class="tok-kt">Source</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">Source</span><span class="tok-o">.</span><span class="tok-n">single</span><span class="tok-o">(</span><span class="tok-mi">3</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_code_source_code">Other <code>Source</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>With each update of Akka Streams another manifestation of <code>Source</code> is developed</p>
</li>
<li>
<p>You can create many of these <code>Source</code></p>
<div class="ulist">
<ul>
<li>
<p><code>cycle</code></p>
</li>
<li>
<p><code>fromFuture</code></p>
</li>
<li>
<p><code>fromPublisher</code> (from the Reactive Streams Library)</p>
</li>
<li>
<p><code>lazily</code></p>
</li>
<li>
<p>more&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_code_flow_code">Defining <code>Flow</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Flow</code> are the interlinking pieces that are the intermediate computations</p>
</li>
<li>
<p>A processing stage which has exactly one input and output</p>
</li>
<li>
<p>Connects its upstream and downstream components by transforming the data elements flowing through it</p>
</li>
<li>
<p>Are immutable, thread-safe, and freely shareable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/flow.png" alt="flow">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_code_flow_code">Why <code>Flow</code>?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>Source</code> can be manipulated by anyone of the methods, for example it contains <code>map</code>, but it is still a <code>Source</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">result</span><span class="tok-k">:</span><span class="tok-kt">Source</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">100</span><span class="tok-o">).</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Flow</code> gives us the opportunity to create a separate component that represent the action like <code>map</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span><span class="tok-k">:</span><span class="tok-kt">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Flow</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]().</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The above can be refactored simply to:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span> <span class="tok-k">=</span> <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connecting_the_code_flow_code">Connecting the <code>Flow</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Once a <code>Flow</code> is created, it can then be connected to a <code>Source</code> with <code>via</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span> <span class="tok-k">=</span> <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">newSource</span> <span class="tok-k">=</span> <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">).</span><span class="tok-n">via</span><span class="tok-o">(</span><span class="tok-n">mapIntFlow</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_code_sink_code">Defining <code>Sink</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Sink</code> is the where all data is finally accumulated</p>
</li>
<li>
<p>A processing stage with exactly one input</p>
</li>
<li>
<p>Requesting and accepting data elements possibly slowing down the upstream producer of elements</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/sink.png" alt="sink">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_code_sink_code">Why <code>Sink</code>?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>Sink</code> gives us the opportunity to create a separate component that represents the final stage for stream processing</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala">val foldSink = Sink.fold[Int, Int](0)(_ + _)
val printlnSink = Sink.foreach[Int](println)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The sink can then be applied to as a final stage using <code>to</code></p>
</li>
<li>
<p>This will create what is called a <code>RunnableGraph</code>, which can now be <code>run</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span><span class="tok-k">:</span> <span class="tok-kt">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">10</span> <span class="tok-o">+</span> <span class="tok-n">x</span><span class="tok-o">)</span>

<span class="tok-k">val</span> <span class="tok-n">printlnSink</span> <span class="tok-k">=</span> <span class="tok-nc">Sink</span><span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">](</span><span class="tok-n">println</span><span class="tok-o">)</span>

<span class="tok-k">val</span> <span class="tok-n">graph</span><span class="tok-k">:</span> <span class="tok-kt">RunnableGraph</span><span class="tok-o">[</span><span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">).</span><span class="tok-n">via</span><span class="tok-o">(</span><span class="tok-n">mapIntFlow</span><span class="tok-o">).</span><span class="tok-n">to</span><span class="tok-o">(</span><span class="tok-n">printlnSink</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_code_runnablegraph_code">Defining <code>RunnableGraph</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Once <code>Source</code>, all <code>Flow</code> and <code>Sink</code> are connected it is a <code>RunnableGraph</code></p>
</li>
<li>
<p>Defined as a Flow that has both ends "attached" to a <code>Source</code> and <code>Sink</code> respectively</p>
</li>
<li>
<p>Is ready to be <code>run()</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">graph</span><span class="tok-k">:</span> <span class="tok-kt">RunnableGraph</span><span class="tok-o">[</span><span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">via</span><span class="tok-o">(</span><span class="tok-n">mapIntFlow</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">to</span><span class="tok-o">(</span><span class="tok-n">printlnSink</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_code_runnablegraph_code">Running the <code>RunnableGraph</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Once contained as a <code>RunnableGraph</code>, you need the following to run</p>
<div class="ulist">
<ul>
<li>
<p>An <code>ActorSystem</code></p>
</li>
<li>
<p>An <code>ExecutionContext</code></p>
</li>
<li>
<p>A <code>Materializer</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>A <code>Materializer</code> is a an engine, backed by <code>Actor</code>, that will process the stream</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_code_runnablegraph_code_by_example">A <code>RunnableGraph</code> by example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">system</span><span class="tok-k">:</span> <span class="tok-kt">ActorSystem</span> <span class="tok-o">=</span>
   <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;MyActorSystem&quot;</span><span class="tok-o">)</span>
<span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">materializer</span><span class="tok-k">:</span> <span class="tok-kt">ActorMaterializer</span> <span class="tok-o">=</span>
   <span class="tok-nc">ActorMaterializer</span><span class="tok-o">()</span>
<span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">executionContext</span><span class="tok-k">:</span> <span class="tok-kt">ExecutionContextExecutor</span> <span class="tok-o">=</span>
   <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">dispatcher</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>system.dispatcher</code> merely obtains the thread pool from the <code>ActorSystem</code>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span><span class="tok-k">:</span> <span class="tok-kt">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">10</span> <span class="tok-o">+</span> <span class="tok-n">x</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">printlnSink</span> <span class="tok-k">=</span>
   <span class="tok-nc">Sink</span><span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">](</span><span class="tok-n">println</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">graph</span><span class="tok-k">:</span> <span class="tok-kt">RunnableGraph</span><span class="tok-o">[</span><span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">via</span><span class="tok-o">(</span><span class="tok-n">mapIntFlow</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">to</span><span class="tok-o">(</span><span class="tok-n">printlnSink</span><span class="tok-o">)</span>
<span class="tok-n">graph</span><span class="tok-o">.</span><span class="tok-n">run</span><span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_composite_code_source_code">Composite <code>Source</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>Source</code> can be composited with any of its methods, and still be a <code>Source</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">compositeSource</span><span class="tok-k">:</span><span class="tok-kt">Source</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
     <span class="tok-o">.</span><span class="tok-n">filter</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Source</code> can be composited also with <code>via</code>, which applies a <code>Flow</code>, and still be a <code>Source</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">compositeSource</span><span class="tok-k">:</span> <span class="tok-kt">Source</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-o">{</span>
    <span class="tok-k">val</span> <span class="tok-n">flow</span> <span class="tok-k">=</span> <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">filter</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-o">)</span>
    <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">).</span><span class="tok-n">via</span><span class="tok-o">(</span><span class="tok-n">flow</span><span class="tok-o">)</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_composite_code_sink_code">Composite <code>Sink</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>Sink</code> can be composited with any of its methods, and still be a <code>Sink</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">compositeSink</span> <span class="tok-k">=</span>
    <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span>
      <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">toMat</span><span class="tok-o">(</span><span class="tok-nc">Sink</span><span class="tok-o">.</span><span class="tok-n">fold</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">)(</span><span class="tok-k">_</span> <span class="tok-o">+</span> <span class="tok-k">_</span><span class="tok-o">))(</span><span class="tok-nc">Keep</span><span class="tok-o">.</span><span class="tok-n">right</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Sink</code> can be composited also with <code>to</code>, which applies a <code>Flow</code>, and can still be a <code>Sink</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">mapIntFlow</span><span class="tok-k">:</span><span class="tok-kt">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">]</span>
      <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-mi">10</span> <span class="tok-o">+</span> <span class="tok-n">x</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">compositeSink</span><span class="tok-k">:</span><span class="tok-kt">Sink</span><span class="tok-o">[</span><span class="tok-kt">Int</span>, <span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span>
   <span class="tok-n">mapIntFlow</span>
      <span class="tok-o">.</span><span class="tok-n">to</span><span class="tok-o">(</span><span class="tok-nc">Sink</span><span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">(</span><span class="tok-n">println</span><span class="tok-o">))</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recalling_the_auxiliary_value">Recalling the auxiliary value</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In streams there is an auxialliary value per stream</p>
</li>
<li>
<p>This can be used to:</p>
<div class="ulist">
<ul>
<li>
<p>to manipulate the stream</p>
</li>
<li>
<p>to provide added information</p>
</li>
</ul>
</div>
</li>
<li>
<p>It is your choice which you want to use by either pull:</p>
<div class="ulist">
<ul>
<li>
<p>The left with <code>Keep.left</code></p>
</li>
<li>
<p>The right with <code>Keep.right</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_one_code_viamat_code_or_code_tomat_code">Which one? <code>viaMat</code> or <code>toMat</code>?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>As a mental note:</p>
<div class="ulist">
<ul>
<li>
<p><code>via</code> is used for <code>Flow</code></p>
</li>
<li>
<p><code>to</code> is used for <code>Sink</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Therefore:</p>
<div class="ulist">
<ul>
<li>
<p><code>viaMat</code>, select element as a <code>Flow</code></p>
</li>
<li>
<p><code>toMat</code>, select element as a <code>Sink</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_code_async_code">Using <code>async</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>async</code> is a "combinator" that places a thread before the next component in the Stream</p>
</li>
<li>
<p>Included in the boundary is a process that runs within the different <code>Thread</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/async.png" alt="async">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_async_code_by_example"><code>async</code> by Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">import</span> <span class="tok-nn">scala.language.postfixOps</span>
<span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">10</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-o">+)</span>
  <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Top: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">currentThreadName</span><span class="tok-o">)</span>
    <span class="tok-n">x</span>
  <span class="tok-o">})</span>
  <span class="tok-o">.</span><span class="tok-n">async</span> <span class="tok-c1">//We are setting an async boundary</span>
  <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-o">{</span>
    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Bottom &quot;</span> <span class="tok-o">+</span> <span class="tok-n">currentThreadName</span><span class="tok-o">)</span>
    <span class="tok-n">x</span>
  <span class="tok-o">})</span>
  <span class="tok-o">.</span><span class="tok-n">filter</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-mi">2</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-n">runForeach</span><span class="tok-o">(</span><span class="tok-n">println</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dealing_with_failure">Dealing with Failure</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Many times dealing with a failure can be very disruptive</p>
</li>
<li>
<p>You can deal with failures as</p>
<div class="ulist">
<ul>
<li>
<p><code>recover</code> to emit a final element then complete the stream normally on upstream failure</p>
</li>
<li>
<p><code>recoverWithRetries</code> to create a new upstream and start consuming from that on failure</p>
</li>
<li>
<p>Restarting sections of the stream after a backoff</p>
</li>
<li>
<p>Using a supervision strategy for stages that support it</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_recover_code_2"><code>recover</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Recover will intercept a call, and stop with one element marking the end</p>
</li>
<li>
<p>This will provide a non-disruptive exit from the stream</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span> <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">10</span> <span class="tok-n">to</span> <span class="tok-mi">0</span> <span class="tok-n">by</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">async</span>
      <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">Some</span><span class="tok-o">(</span><span class="tok-mi">100</span> <span class="tok-o">/</span> <span class="tok-n">x</span><span class="tok-o">))</span>
      <span class="tok-o">.</span><span class="tok-n">recover</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">t</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">None</span> <span class="tok-o">}</span>
      <span class="tok-o">.</span><span class="tok-n">runForeach</span><span class="tok-o">(</span><span class="tok-n">println</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_recoverwithretries_code"><code>recoverWithRetries</code></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>This will provide a non-disruptive exit from the stream</p>
</li>
<li>
<p><code>recoverWithRetries</code> will:</p>
<div class="ulist">
<ul>
<li>
<p>Intercept a call</p>
</li>
<li>
<p>Retry the specified times</p>
</li>
<li>
<p>Stop with multiple elements marking the end</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span> <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">10</span> <span class="tok-n">to</span> <span class="tok-mi">0</span> <span class="tok-n">by</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-n">async</span>
      <span class="tok-o">.</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">Some</span><span class="tok-o">(</span><span class="tok-mi">100</span> <span class="tok-o">/</span> <span class="tok-n">x</span><span class="tok-o">))</span>
      <span class="tok-o">.</span><span class="tok-n">recover</span> <span class="tok-o">{</span> <span class="tok-k">case</span> <span class="tok-n">t</span><span class="tok-k">:</span> <span class="tok-kt">Throwable</span> <span class="tok-o">=&gt;</span> <span class="tok-nc">None</span> <span class="tok-o">}</span>
      <span class="tok-o">.</span><span class="tok-n">runForeach</span><span class="tok-o">(</span><span class="tok-n">println</span><span class="tok-o">)</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_designing_graphs">Designing Graphs</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>DSL designed graphs</p>
</li>
<li>
<p>Reusable</p>
</li>
<li>
<p>Used for complicated fan-in (merge) or fan-out (broadcast scenarios)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fan_out">Fan Out</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Broadcast[T]</code> - (1 input, N outputs) given an input element emits to each output</p>
</li>
<li>
<p><code>Balance[T]</code> - (1 input, N outputs) given an input element emits to one of its output ports</p>
</li>
<li>
<p><code>UnzipWith[In,A,B,&#8230;&#8203;]</code> - (1 input, N outputs) takes a function of 1 input that given a value for each input emits N output elements (where N &#8656; 20)</p>
</li>
<li>
<p><code>UnZip[A,B]</code> - (1 input, 2 outputs) splits a stream of <code>(A,B)</code> tuples into two streams, one of type A and one of type B</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/fanout.png" alt="fanout">
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/2.5.4/scala/stream/stream-graphs.html" class="bare">https://doc.akka.io/docs/akka/2.5.4/scala/stream/stream-graphs.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fan_in">Fan In</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>Merge[In]</code> - (N inputs , 1 output) picks randomly from inputs pushing them one by one to its output</p>
</li>
<li>
<p><code>MergePreferred[In]</code> - like Merge but if elements are available on preferred port, it picks from it, otherwise randomly from others</p>
</li>
<li>
<p><code>MergePrioritized[In]</code> - like Merge but if elements are available on all input ports, it picks from them randomly based on their priority</p>
</li>
<li>
<p><code>ZipWith[A,B,&#8230;&#8203;,Out]</code> - (N inputs, 1 output) which takes a function of <code>N</code> inputs that given a value for each input emits 1 output element</p>
</li>
<li>
<p><code>Zip[A,B]</code> - (2 inputs, 1 output) is a ZipWith specialised to zipping input streams of <code>A</code> and <code>B</code> into a <code>(A,B)</code> tuple stream</p>
</li>
<li>
<p><code>Concat[A]</code> - (2 inputs, 1 output) concatenates two streams (first consume one, then the second one)</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/fanin.png" alt="fanin">
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka/2.5.4/scala/stream/stream-graphs.html" class="bare">https://doc.akka.io/docs/akka/2.5.4/scala/stream/stream-graphs.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_closed_shape">Closed Shape</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Graph has all on ports accounted</p>
</li>
<li>
<p>Nothing else can be connected</p>
</li>
<li>
<p>Potential to be <code>RunnableGraph</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/closed_shape.png" alt="closed shape">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_source_shape">Source Shape</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Contains one open output port</p>
</li>
<li>
<p>Requires other components to be closed and runnable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/source_shape.png" alt="source shape">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sink_shape">Sink Shape</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Contains one input shape, outputs are closed</p>
</li>
<li>
<p>Requires other components to be closed and runnable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/sink_shape.png" alt="sink shape" width="60%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flow_shape">Flow Shape</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Contains one input, one output</p>
</li>
<li>
<p>Composed of other components</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/flow_shape.png" alt="flow shape">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_shapes">Advanced Shapes</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>All shapes can be complicated with more components</p>
</li>
<li>
<p>You can determine how advanced or simple the graph can be</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/flow_advanced_shape.png" alt="flow advanced shape">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constructing_a_simple_graph">Constructing a Simple Graph</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The following graph has components constructed on the outside</p>
<div class="ulist">
<ul>
<li>
<p><code>Source</code></p>
</li>
<li>
<p><code>Sink</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>RunnableGraph.fromGraph</code> prepares the graph</p>
</li>
<li>
<p><code>builder</code> will allow us to plugin components to be used within the DSL</p>
</li>
<li>
<p><code>import GraphDSL.Implicits._</code> will allow DSL connectors like <code>~&gt;</code></p>
</li>
<li>
<p><code>ClosedShape</code> indicates the return shape, in this simple instance it is closed</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">source</span> <span class="tok-k">=</span> <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">100</span><span class="tok-o">)</span>
<span class="tok-k">val</span> <span class="tok-n">sink</span> <span class="tok-k">=</span> <span class="tok-nc">Sink</span><span class="tok-o">.</span><span class="tok-n">foreach</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">](</span><span class="tok-n">println</span><span class="tok-o">)</span>

<span class="tok-k">var</span> <span class="tok-n">runnableGraph</span><span class="tok-k">:</span> <span class="tok-kt">RunnableGraph</span><span class="tok-o">[</span><span class="tok-kt">NotUsed</span><span class="tok-o">]</span> <span class="tok-k">=</span> <span class="tok-nc">RunnableGraph</span><span class="tok-o">.</span><span class="tok-n">fromGraph</span><span class="tok-o">(</span><span class="tok-nc">GraphDSL</span><span class="tok-o">.</span><span class="tok-n">create</span><span class="tok-o">()</span> <span class="tok-o">{</span>
     <span class="tok-k">implicit</span> <span class="tok-n">builder</span> <span class="tok-k">=&gt;</span>
        <span class="tok-k">import</span> <span class="tok-nn">GraphDSL.Implicits._</span>
        <span class="tok-n">source</span> <span class="tok-o">~&gt;</span> <span class="tok-n">sink</span>
        <span class="tok-nc">ClosedShape</span>
    <span class="tok-o">})</span>

<span class="tok-n">runnableGraph</span><span class="tok-o">.</span><span class="tok-n">run</span><span class="tok-o">()</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_denser_graph">Creating a Denser Graph</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>In the following Graph:</p>
<div class="ulist">
<ul>
<li>
<p><code>outputToTwoFiles</code> is a composed <code>Graph</code> of a <code>Broadcast</code></p>
</li>
<li>
<p><code>Broadcat[Int](2)</code> states that there is one input and two output scheme</p>
</li>
<li>
<p><code>int2ByteString</code> and <code>int2ByteString2</code> are flows that convert to <code>ByteString</code></p>
</li>
<li>
<p><code>ByteString</code> is wrapper to send <code>String</code> over the wire</p>
</li>
<li>
<p>This returns a <code>SinkShape</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">userHome</span><span class="tok-k">:</span> <span class="tok-kt">String</span> <span class="tok-o">=</span>
    <span class="tok-nc">System</span><span class="tok-o">.</span><span class="tok-n">getProperty</span><span class="tok-o">(</span><span class="tok-s">&quot;user.home&quot;</span><span class="tok-o">)</span>

<span class="tok-k">val</span> <span class="tok-n">source</span> <span class="tok-k">=</span> <span class="tok-nc">Source</span><span class="tok-o">(</span><span class="tok-mi">1</span> <span class="tok-n">to</span> <span class="tok-mi">100</span><span class="tok-o">)</span>

<span class="tok-k">val</span> <span class="tok-n">outputToTwoFiles</span> <span class="tok-k">=</span>
  <span class="tok-nc">GraphDSL</span><span class="tok-o">.</span><span class="tok-n">create</span><span class="tok-o">()</span> <span class="tok-o">{</span> <span class="tok-k">implicit</span> <span class="tok-n">b</span> <span class="tok-k">=&gt;</span>
     <span class="tok-k">import</span> <span class="tok-nn">GraphDSL.Implicits._</span>

     <span class="tok-k">val</span> <span class="tok-n">fileSink1</span> <span class="tok-k">=</span> <span class="tok-n">b</span><span class="tok-o">.</span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-nc">FileIO</span><span class="tok-o">.</span><span class="tok-n">toPath</span><span class="tok-o">(</span>
         <span class="tok-nc">Paths</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-o">(</span><span class="tok-s">s&quot;</span><span class="tok-si">$userHome</span><span class="tok-s">/complete1.txt&quot;</span><span class="tok-o">)))</span>
     <span class="tok-k">val</span> <span class="tok-n">fileSink2</span> <span class="tok-k">=</span> <span class="tok-n">b</span><span class="tok-o">.</span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-nc">FileIO</span><span class="tok-o">.</span><span class="tok-n">toPath</span><span class="tok-o">(</span>
         <span class="tok-nc">Paths</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-o">(</span><span class="tok-s">s&quot;</span><span class="tok-si">$userHome</span><span class="tok-s">/complete2.txt&quot;</span><span class="tok-o">)))</span>
     <span class="tok-k">val</span> <span class="tok-n">int2ByteString1</span><span class="tok-o">,</span> <span class="tok-n">int2ByteString2</span> <span class="tok-k">=</span>
         <span class="tok-n">b</span><span class="tok-o">.</span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-nc">Flow</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">].</span><span class="tok-n">map</span><span class="tok-o">(</span><span class="tok-n">x</span> <span class="tok-k">=&gt;</span> <span class="tok-nc">ByteString</span><span class="tok-o">(</span><span class="tok-n">x</span><span class="tok-o">)))</span>

     <span class="tok-k">val</span> <span class="tok-n">splitter</span> <span class="tok-k">=</span> <span class="tok-n">b</span><span class="tok-o">.</span><span class="tok-n">add</span><span class="tok-o">(</span><span class="tok-nc">Broadcast</span><span class="tok-o">[</span><span class="tok-kt">Int</span><span class="tok-o">](</span><span class="tok-mi">2</span><span class="tok-o">))</span>

     <span class="tok-n">splitter</span> <span class="tok-o">~&gt;</span> <span class="tok-n">int2ByteString1</span> <span class="tok-o">~&gt;</span> <span class="tok-n">fileSink1</span><span class="tok-o">.</span><span class="tok-n">in</span>
     <span class="tok-n">splitter</span> <span class="tok-o">~&gt;</span> <span class="tok-n">int2ByteString2</span> <span class="tok-o">~&gt;</span> <span class="tok-n">fileSink2</span><span class="tok-o">.</span><span class="tok-n">in</span>

     <span class="tok-nc">SinkShape</span><span class="tok-o">.</span><span class="tok-n">apply</span><span class="tok-o">(</span><span class="tok-n">splitter</span><span class="tok-o">.</span><span class="tok-n">in</span><span class="tok-o">)</span>
  <span class="tok-o">}</span>

<span class="tok-n">source</span><span class="tok-o">.</span><span class="tok-n">runWith</span><span class="tok-o">(</span><span class="tok-n">outputToTwoFiles</span><span class="tok-o">)</span></code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1 slide_section">
<h2 id="_akka_http">Akka Http</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_akka_http_basics">Akka Http Basics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>RESTFul content server</p>
</li>
<li>
<p>Microservice face to rest of enterprise</p>
</li>
<li>
<p>Processes using:</p>
<div class="ulist">
<ul>
<li>
<p>Akka Actors</p>
</li>
<li>
<p>Akka Streams</p>
</li>
</ul>
</div>
</li>
<li>
<p>Used with Play Framework</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_http_further_features">Akka Http Further Features</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>High-level functionality including:</p>
<div class="ulist">
<ul>
<li>
<p>(De)Compression</p>
</li>
<li>
<p>(Un)Marshalling</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_apis">Akka APIs</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Server APIs</p>
</li>
<li>
<p>Client APIs</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_http_server_apis">Akka Http Server APIs</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Akka Http Core</strong></p>
<div class="ulist">
<ul>
<li>
<p>Mostly low-level server and client-side implementation of HTTP</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Akka Http DSL</strong></p>
<div class="ulist">
<ul>
<li>
<p>DSL (Domain Specific Language) for defining HTTP-based APIs on the server-side</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_client_api">Akka Client API</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Consuming HTTP-based services offered by other endpoints</p>
</li>
<li>
<p>Currently provided by the <code>akka-http-core</code> module.</p>
</li>
<li>
<p>Used to interact in parallel with RestFUL endpoints</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_http_mashallers">Akka Http Mashallers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Akka-Http-Spray-XML - (De)Marshallers for XML</p>
</li>
<li>
<p>Akka-Http-Spray-JSON - (De)Marshallers for JSON</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_http_dependency">Akka-Http Dependency</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>"com.typesafe.akka" %% "akka-http" % "10.1.3"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_required_components_for_a_webserver">Required Components for a WebServer</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">WebServer</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-kt">Array</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">])</span> <span class="tok-o">{</span>
    <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">system</span> <span class="tok-k">=</span> <span class="tok-nc">ActorSystem</span><span class="tok-o">(</span><span class="tok-s">&quot;my-system&quot;</span><span class="tok-o">)</span>
    <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">materializer</span> <span class="tok-k">=</span> <span class="tok-nc">ActorMaterializer</span><span class="tok-o">()</span>
    <span class="tok-k">implicit</span> <span class="tok-k">val</span> <span class="tok-n">executionContext</span> <span class="tok-k">=</span> <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">dispatcher</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>An <code>ActorSystem</code> is required since this is an Akka instance</p>
</li>
<li>
<p>A <code>Materializer</code> is required as an engine to process streaming data</p>
</li>
<li>
<p>An <code>executionContext</code> is required for <code>Future</code> processing and shut down</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_akka_http_routing_dsl">Akka-Http Routing DSL</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">WebServer</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-kt">Array</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">])</span> <span class="tok-o">{</span>
    <span class="tok-c1">//implicits elided</span>

    <span class="tok-k">val</span> <span class="tok-n">route</span> <span class="tok-k">=</span>
      <span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;hello&quot;</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">get</span> <span class="tok-o">{</span>
          <span class="tok-n">complete</span><span class="tok-o">(</span><span class="tok-nc">HttpEntity</span><span class="tok-o">(</span><span class="tok-nc">ContentTypes</span><span class="tok-o">.&lt;</span><span class="tok-n">code</span><span class="tok-o">&gt;</span><span class="tok-n">text</span><span class="tok-o">/</span><span class="tok-n">html</span><span class="tok-o">(</span><span class="tok-nc">UTF</span><span class="tok-o">-</span><span class="tok-mi">8</span><span class="tok-o">)&lt;/</span><span class="tok-n">code</span><span class="tok-o">&gt;,</span>
                   <span class="tok-s">&quot;&lt;h1&gt;Say hello to akka-http&lt;/h1&gt;&quot;</span><span class="tok-o">))</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>path</code> will map the <code>/hello</code> on the web server</p>
</li>
<li>
<p><code>get</code> is the HTTP method</p>
</li>
<li>
<p><code>complete</code> signifies a complete payload with the content-type and HTML</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_start_server_and_provide_a_shut_down_the_server">Start Server and provide a shut down the server</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">object</span> <span class="tok-nc">WebServer</span> <span class="tok-o">{</span>
  <span class="tok-k">def</span> <span class="tok-n">main</span><span class="tok-o">(</span><span class="tok-n">args</span><span class="tok-k">:</span> <span class="tok-kt">Array</span><span class="tok-o">[</span><span class="tok-kt">String</span><span class="tok-o">])</span> <span class="tok-o">{</span>
    <span class="tok-c1">//implicits elided</span>
    <span class="tok-c1">//route elided</span>

    <span class="tok-k">val</span> <span class="tok-n">bindingFuture</span> <span class="tok-k">=</span> <span class="tok-nc">Http</span><span class="tok-o">().</span><span class="tok-n">bindAndHandle</span><span class="tok-o">(</span><span class="tok-n">route</span><span class="tok-o">,</span> <span class="tok-s">&quot;localhost&quot;</span><span class="tok-o">,</span> <span class="tok-mi">8080</span><span class="tok-o">)</span>

    <span class="tok-n">println</span><span class="tok-o">(</span><span class="tok-s">s&quot;Server online at http://localhost:8080/\nPress RETURN to stop...&quot;</span><span class="tok-o">)</span>
    <span class="tok-nc">StdIn</span><span class="tok-o">.</span><span class="tok-n">readLine</span><span class="tok-o">()</span>
    <span class="tok-n">bindingFuture</span>
      <span class="tok-o">.</span><span class="tok-n">flatMap</span><span class="tok-o">(&lt;</span><span class="tok-n">em</span><span class="tok-o">&gt;.</span><span class="tok-n">unbind</span><span class="tok-o">())</span>
      <span class="tok-o">.</span><span class="tok-n">onComplete</span><span class="tok-o">(&lt;/</span><span class="tok-n">em</span><span class="tok-o">&gt;</span> <span class="tok-k">=&gt;</span> <span class="tok-n">system</span><span class="tok-o">.</span><span class="tok-n">terminate</span><span class="tok-o">())</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bindingFuture</code> has a <code>Future</code> handle on the server given a <code>route</code></p>
</li>
<li>
<p><code>unbind</code> will unbind from the port</p>
</li>
<li>
<p>When all done we <code>terminate</code> our Actor System</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping_an_actual_route_a_real_world_example">Mapping an actual route, a real world example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">route</span><span class="tok-k">:</span> <span class="tok-kt">Route</span> <span class="tok-o">=</span><span class="tok-err"> </span><span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;order&quot;</span> <span class="tok-o">/</span> <span class="tok-nc">IntNumber</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">id</span> <span class="tok-o">=&gt;</span><span class="tok-err"> </span>
    <span class="tok-n">get</span> <span class="tok-o">{</span>
       <span class="tok-n">complete</span> <span class="tok-o">{</span>
          <span class="tok-s">&quot;Received GET request for order &quot;</span> <span class="tok-o">+</span> <span class="tok-n">id</span>
       <span class="tok-o">}</span>
    <span class="tok-o">}</span> <span class="tok-o">~</span><span class="tok-err"> </span><span class="tok-n">put</span> <span class="tok-o">{</span>
       <span class="tok-n">complete</span> <span class="tok-o">{</span>
          <span class="tok-s">&quot;Received PUT request for order &quot;</span> <span class="tok-o">+</span> <span class="tok-n">id</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mapping_an_actual_route_a_more_complex_example">Mapping an actual route, a more complex example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">route</span> <span class="tok-o">=</span><span class="tok-err"> </span><span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;order&quot;</span> <span class="tok-o">/</span> <span class="tok-nc">IntNumber</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">id</span> <span class="tok-o">=&gt;</span><span class="tok-err"> </span>
   <span class="tok-o">(</span><span class="tok-n">get</span> <span class="tok-o">|</span> <span class="tok-n">put</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">ctx</span> <span class="tok-k">=&gt;</span>
       <span class="tok-n">ctx</span><span class="tok-o">.</span><span class="tok-n">complete</span><span class="tok-o">(</span>
           <span class="tok-s">s&quot;&quot;&quot;Received </span><span class="tok-si">${</span><span class="tok-n">ctx</span><span class="tok-o">.</span><span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-n">method</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-si">}</span><span class="tok-s"></span>
<span class="tok-s">             request for order </span><span class="tok-si">$id</span><span class="tok-s">&quot;&quot;&quot;</span><span class="tok-o">)</span><span class="tok-err"> </span>
       <span class="tok-o">}</span><span class="tok-err"> </span>
   <span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_an_code_extractor_code_in_a_dsl">Using an <code>Extractor</code> in a DSL</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">route</span> <span class="tok-o">=</span><span class="tok-err"> </span><span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;order&quot;</span> <span class="tok-o">/</span> <span class="tok-nc">IntNumber</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">id</span> <span class="tok-k">=&gt;</span>
<span class="tok-err"> </span> <span class="tok-o">(</span><span class="tok-n">get</span> <span class="tok-o">|</span> <span class="tok-n">put</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">extractMethod</span> <span class="tok-o">{</span> <span class="tok-n">m</span> <span class="tok-k">=&gt;</span>
         <span class="tok-n">complete</span><span class="tok-o">(</span><span class="tok-s">s&quot;&quot;&quot;Received </span><span class="tok-si">${</span><span class="tok-n">m</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-si">}</span><span class="tok-s"></span>
<span class="tok-s">                    request for order </span><span class="tok-si">$id</span><span class="tok-s">&quot;&quot;&quot;</span><span class="tok-o">)</span>
         <span class="tok-o">}</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_composability_using_an_code_extractor_code_in_a_dsl">Composability using an <code>Extractor</code> in a DSL</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">getOrPut</span> <span class="tok-k">=</span> <span class="tok-n">get</span> <span class="tok-o">|</span> <span class="tok-n">put</span>
<span class="tok-k">val</span> <span class="tok-n">route</span> <span class="tok-k">=</span> <span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;order&quot;</span> <span class="tok-o">/</span> <span class="tok-nc">IntNumber</span><span class="tok-o">)</span> <span class="tok-o">{</span> <span class="tok-n">id</span> <span class="tok-k">=&gt;</span>
<span class="tok-err"> </span>    <span class="tok-n">getOrPut</span> <span class="tok-o">{</span>
        <span class="tok-n">extractMethod</span> <span class="tok-o">{</span> <span class="tok-n">m</span> <span class="tok-o">=&gt;</span><span class="tok-err"> </span>
             <span class="tok-n">complete</span><span class="tok-o">(</span><span class="tok-s">s&quot;&quot;&quot;Received </span><span class="tok-si">${</span><span class="tok-n">m</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-si">}</span><span class="tok-s"></span>
<span class="tok-s">                         request for order </span><span class="tok-si">$id</span><span class="tok-s">&quot;) </span>
<span class="tok-s">        } </span>
<span class="tok-s">    }</span>
<span class="tok-s">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_combining_it_all_together">Combining it all together</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="scala"><span></span><span class="tok-k">val</span> <span class="tok-n">getOrPut</span> <span class="tok-k">=</span> <span class="tok-n">get</span> <span class="tok-o">|</span> <span class="tok-n">put</span><span class="tok-err"> </span>
<span class="tok-k">val</span> <span class="tok-n">route</span> <span class="tok-k">=</span>
  <span class="tok-o">(</span><span class="tok-n">path</span><span class="tok-o">(</span><span class="tok-s">&quot;order&quot;</span> <span class="tok-o">/</span> <span class="tok-nc">IntNumber</span><span class="tok-o">)</span>
    <span class="tok-o">&amp;</span> <span class="tok-n">getOrPut</span> <span class="tok-o">&amp;</span> <span class="tok-n">extractMethod</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-err"> </span><span class="tok-o">(</span><span class="tok-n">id</span><span class="tok-o">,</span> <span class="tok-n">m</span><span class="tok-o">)</span> <span class="tok-o">=&gt;</span><span class="tok-err"> </span>
         <span class="tok-n">complete</span><span class="tok-o">(</span><span class="tok-s">s&quot;&quot;&quot;Received </span><span class="tok-si">${</span><span class="tok-n">m</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-si">}</span><span class="tok-s"></span>
<span class="tok-s">                      request for order </span><span class="tok-si">$id</span><span class="tok-s">&quot;&quot;&quot;</span><span class="tok-o">)</span><span class="tok-err"> </span>
      <span class="tok-o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_various_directives_extractors">Various Directives/Extractors</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>There are various extractors and directives</p>
<div class="ulist">
<ul>
<li>
<p>Security</p>
</li>
<li>
<p>Handling Requests</p>
</li>
<li>
<p>Logging</p>
</li>
<li>
<p>Cookies</p>
</li>
<li>
<p>More&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_marshallers_unmarshallers">Marshallers/Unmarshallers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Marshalling converts a custom object into raw wire data</p>
</li>
<li>
<p>Unmarshalling converts raw wire data into a custom object</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_marshaller_code_deep_dive"><code>Marshaller</code> deep dive</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A <code>Marshaller</code> is actually: <code>A &#8658; Future[List[Marshalling[B]]]</code></p>
<div class="ulist">
<ul>
<li>
<p><code>Future</code>: <code>Marshallers</code> are not required to synchronously produce a result, so instead they return a <code>Future</code></p>
</li>
<li>
<p><code>List</code>: <code>Marshallers</code> can offer several ones. Which one will be rendered onto the wire in the end is decided
by content negotiation. For example, the Marshaller[OrderConfirmation, MessageEntity]
might offer a JSON as well as an XML representation.
The client can decide through the addition of an Accept request header which one is preferred.
If the client doesn’t express a preference the first representation is picked.</p>
</li>
<li>
<p><code>Marshalling[B]</code>: Rather than returning an instance of <code>B</code> directly
marshallers first produce a Marshalling[B]. This allows for querying the
<code>MediaType</code> and potentially the <code>HttpCharset</code> that the marshaller
will produce before the actual marshalling is triggered.
Apart from enabling content negotiation this design allows for delaying
the actual construction of the marshalling target instance to the very last moment when it is really needed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Source: <a href="https://doc.akka.io/docs/akka-http/current/common/marshalling.html" class="bare">https://doc.akka.io/docs/akka-http/current/common/marshalling.html</a></p>
</div>
<div class="paragraph">
<p><a href="http://doc.akka.io/docs/akka-http/current/scala/http/routing-dsl/directives/alphabetically.html" class="bare">http://doc.akka.io/docs/akka-http/current/scala/http/routing-dsl/directives/alphabetically.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http">Lab: Trying out Akka-HTTP</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>BasicIntroServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>BasicIntroServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>BasicIntroServer</code> in either your IDE or in SBT using the following, and select <code>BasicIntroServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> In your web browser go to, <a href="http://localhost:8080/hello" class="bare">http://localhost:8080/hello</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http_get_with_an_code_actor_code">Lab: Trying out Akka-HTTP get with an <code>Actor</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>BasicGetServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>BasicGetServer</code> and how it uses the <code>EmployeeActor</code> and <code>Employee</code> entity</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>BasicGetServer</code> in either your IDE or in SBT using the following, and select <code>BasicGetServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> In your web browser go to, <a href="http://localhost:8080/employee/1" class="bare">http://localhost:8080/employee/1</a> (up to 4)</p>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> You can also use <code>curl</code> on MacOSX and Linux</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>curl -X GET http://localhost:8080/employee/1</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http_get_and_post_with_an_code_actor_code">Lab: Trying out Akka-HTTP get and post with an <code>Actor</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>BasicGetPostServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>BasicGetPostServer</code>
and how it uses the <code>EmployeeActor</code> and <code>Employee</code> entity. Also discuss this
time the Marshaller and how that works</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>BasicGetPostServer</code> in either your IDE or in SBT using the following, and select <code>BasicGetPostServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Since we are now dealing with <code>POST</code>, use <code>curl</code> on MacOSX or Linux, or find an alternate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>curl -X POST -d <span class="tok-s2">&quot;firstName=Beyonce&amp;lastName=Knowles&quot;</span> http://localhost:8080/employee</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> In your web browser go to, <a href="http://localhost:8080/employee/5" class="bare">http://localhost:8080/employee/5</a> (or whatever the latest one would be)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http_get_post_and_put_with_an_code_actor_code">Lab: Trying out Akka-HTTP get, post, and put with an <code>Actor</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>BasicGetPostPutServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>BasicGetPostPutServer</code> particularly the DSL and how it is organized</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>BasicGetPostPutServer</code> in either your IDE or in SBT using the following, and select <code>BasicGetPostPutServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Since we are dealing with <code>PUT</code>, use <code>curl</code> on MacOSX or Linux, or find an alternate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>curl -X PUT -d <span class="tok-s2">&quot;firstName=Nancy&amp;lastName=Sinatra&quot;</span> http://localhost:8080/employee/1</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> In your web browser go to, <a href="http://localhost:8080/employee/1" class="bare">http://localhost:8080/employee/1</a> and verify that <code>Frank</code> is now <code>Nancy</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http_get_post_and_put_with_an_code_actor_code_as_json">Lab: Trying out Akka-HTTP get, post, and put with an <code>Actor</code> as JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>JSONGetPostPutServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>JSONGetPostPutServer</code> particularly the <code>implicit</code> that affects that behavior</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>JSONGetPostPutServer</code> in either your IDE or in SBT using the following, and select <code>JSONGetPostPutServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> Go through all the HTTP methods, be sure to use JSON for the payload since,
that&#8217;s what we have setup, for example here is a post</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sh"><span></span>curl -X POST -d <span class="tok-s1">&#39;{&quot;firstName&quot;:&quot;Beyonce&quot;,&quot;lastName&quot;:&quot;Knowles&quot;}&#39;</span>
     -H <span class="tok-s2">&quot;Content-Type: application/json&quot;</span>
      http://localhost:8082/employee</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lab_trying_out_akka_http_get_post_and_put_with_an_code_actor_code_as_json_securely">Lab: Trying out Akka-HTTP get, post, and put with an <code>Actor</code> as JSON, Securely</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Step 1:</strong> In <em>src/main/scala</em> and in the package <code>com.akkatraining.scala.http</code>
locate the <code>SecureJSONGetPostPutServer</code></p>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> Discuss the organization of <code>SecureJSONGetPostPutServer</code> particularly the security
 aspect of the server</p>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Run <code>SecureJSONGetPostPutServer</code> in either your IDE or
 in SBT using the following, and select <code>SecureJSONGetPostPutServer</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="sbt"><span></span>&gt; run</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> In your web browser go to, <a href="http://localhost:8080/employee/1" class="bare">http://localhost:8080/employee/1</a> (up to 4),
and enter whatever username but with the password: <code>AkkaTime</code></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-06-25 08:49:04 PDT
</div>
</div>
</body>
</html>